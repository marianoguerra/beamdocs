<!doctype html>
<html><head><meta charset="utf-8"><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.0/css/bootstrap.min.css"></head><body style="margin: 4em 10%"><h1>How to Build OTP like documentation</h1><h2>Utilities to prepare XML files</h2><h2>Create XML files from code</h2><p>
If there are EDoc comments in a module, the escript <strong>xml_from_edoc.escript</strong>
can be used to generate an XML file according to the <strong>erlref</strong> DTD 
for this module.
</p><p>
Example:
</p><pre><code class="">

	1&gt; escript $(ERL_TOP)/lib/erl_docgen/priv/bin/xml_from_edoc.escript ex1.erl
      </code></pre><h2>Include code in XML</h2><p>If there are OTP DTD <em>codeinclude</em> tags in the source XML file, the escript
<strong>codeline_preprocessing.escript</strong> can be used to include the code and produce
an XML file according to the OTP DTDs. 
</p><p>
Example:
</p><pre><code class="">

	1&gt; escript $(ERL_TOP)/lib/erl_docgen/priv/bin/codeline_preprocessing.escript \
	   ex1.xmlsrc ex1.xml
      </code></pre><h2>Use xsltproc to generate different output formats</h2><h2>Parameters used in all the the XSL transformations</h2><p>
These parameters to <strong>xsltproc</strong> are used for all the supported output formats.
</p><dl><dt><strong>docgen</strong></dt><dd> Path to erl_docgen's top directory. </dd><dt><strong>gendate</strong></dt><dd> The date string that will be used in the documentation. </dd><dt><strong>appname</strong></dt><dd> The name of the application.&gt; </dd><dt><strong>appver</strong></dt><dd> The version of the application. </dd></dl><h2>Generate HTML output</h2><p>
When generating HTML one also needs these three pramaters to <strong>xsltproc</strong>.
</p><dl><dt><strong>outdir</strong></dt><dd> Output directory for the produced html files. </dd><dt><strong>topdocdir</strong></dt><dd> If one builds a standalone documentation for an application this should be set to ".". </dd><dt><strong>pdfdir</strong></dt><dd> Relative path from the html directory to where the pdf file are placed. </dd></dl><p>
Example:
</p><pre><code class="">
	
	1&gt; xsltproc --noout --stringparam outdir /tmp/myhtmldoc \
	      --stringparam docgen $(ERL_TOP)/lib/erl_docgen \
              --stringparam topdocdir . \
              --stringparam pdfdir "$(PDFDIR)" \
              --xinclude \
	      --stringparam gendate "December 5 2011" \
              --stringparam appname MyApp \
              --stringparam appver 0.1 \
              -path $ERL_TOP/lib/erl_docgen/priv/dtd \
              -path $ERL_TOP/lib/erl_docgen/priv/dtd_html_entities \
	      $ERL_TOP/lib/erl_docgen/priv/xsl/db_html.xsl mybook.xml
      </code></pre><h2>Generate PDF</h2><p>
The generation of the PDF file is done in two steps. First is <strong>xsltproc</strong> used to generate a <strong>.fo</strong> file 
which is used as input to the <strong>fop</strong> command to produce th PDF file.
</p><p>
Example:
</p><pre><code class="">

	1&gt; xsltproc --output MyApp.fo \
             --stringparam docgen $ERL_TOP/lib/erl_docgen \
	     --stringparam gendate  "December 5 2011" \
             --stringparam appname MyApp \
             --stringparam appver 0.1 \
             --xinclude \
             -path $ERL_TOP/lib/erl_docgen/priv/dtd \
             -path $ERL_TOP/lib/erl_docgen/priv/dtd_html_entities \
	     $ERL_TOP/lib/erl_docgen/priv/xsl/db_pdf.xsl mybook.xml


        2&gt; fop -fo MyApp.fo -pdf MyApp.pdf
      </code></pre><h2>Generate man pages</h2><p>
Unix man pages can be generated with <strong>xsltproc</strong> from XML files written according to 
the different OTP ref type DTDs. 
</p><p>
Example:
</p><pre><code class="">

	1&gt; xsltproc --output  my_module.3\
	      --stringparam docgen $ERL_TOP/lib/erl_docgen \
	      --stringparam gendate  "December 5 2011" \
	      --stringparam appname MyApp \
	      --stringparam appver 0.1 \
	      --xinclude -path $ERL_TOP/lib/erl_docgen/priv/dtd  \
              -path $ERL_TOP/lib/erl_docgen/priv/dtd_man_entities \
              $ERL_TOP/lib/erl_docgen/priv/xsl/db_man.xsl my_refpage.xml
      </code></pre><h2>Upcoming changes</h2><p>
The output from the <strong>erl_docgen</strong> documentation build process is now just the OTP style. 
But in a near future we will for example add the possibility to change logo, color in the PDF and 
style sheet for the HTML.
</p></body></html>