<!doctype html>
<html><head><meta charset="utf-8"><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.0/css/bootstrap.min.css"></head><body style="margin: 4em 10%"><h1>HiPE Release Notes</h1><p>This document describes the changes made to HiPE.</p><h2>Hipe 3.18.3</h2><h2>Fixed Bugs and Malfunctions</h2><ul><li> <p> Fix a bug in the handling of the <strong>Key</strong> argument
of <strong>lists:{keysearch, keyfind, keymember}</strong>. </p> <p>
Own Id: OTP-15570</p> </li></ul><h2>Hipe 3.18.2</h2><h2>Improvements and New Features</h2><ul><li> <p>The code was updated to avoid causing a dialyzer
warning because of a tightened spec for
<strong>beam_lib:info/1</strong>.</p> <p>
Own Id: OTP-15482</p> </li></ul><h2>Hipe 3.18.1</h2><h2>Fixed Bugs and Malfunctions</h2><ul><li> <p>
Improved documentation.</p> <p>
Own Id: OTP-15190</p> </li></ul><h2>Hipe 3.18</h2><h2>Improvements and New Features</h2><ul><li> <p>
Optimize <strong>receive</strong> statements that are only waiting
for messages containing a reference created before the
receive. All messages that existed in the queue when the
reference was created will be bypassed, as they cannot
possibly contain the reference. This optimization has
existed for vanilla BEAM since OTP R14.</p> <p>
Own Id: OTP-14785 Aux Id: PR-1632 </p> </li><li> <p>
Add validation pass to hipe compiler to detect internal
errors causing primop calls that may trigger an unsafe GC
at run-time. The pass can be disabled with option
<strong>no_verify_gcsafe</strong>.</p> <p>
Own Id: OTP-14900 Aux Id: PR-1685, PR-1621 </p> </li><li> <p>
Make hipe compiled code work on x86_64 (amd64) with OS
security feature PIE, where executable code can be loaded
into a random location. Old behavior, if hipe was
enabled, was to disable PIE build options for the VM.</p> <p>
Own Id: OTP-14903</p> </li><li> <p>
Inline more type test BIFs; <strong>is_number</strong>,
<strong>is_bitstring</strong>, <strong>is_map</strong>.</p> <p>
Own Id: OTP-14941 Aux Id: PR-1718 </p> </li></ul><h2>Hipe 3.17.1</h2><h2>Fixed Bugs and Malfunctions</h2><ul><li> <p>
Fix HiPE bug for binary constructs like
<strong>&lt;&lt;X/utf8&gt;&gt;</strong> which could in rare cases
cause faulty results or VM crash.</p> <p>
This fix affects both the <strong>hipe</strong> compiler and
<strong>erts</strong> runtime in an <em>incompatible</em> way. Old
hipe compiled files need to be recompiled to load and run
properly as native.</p> <p>
*** POTENTIAL INCOMPATIBILITY ***</p> <p>
Own Id: OTP-14850 Aux Id: PR-1664 </p> </li><li> <p>The BEAM compiler chooses not to perform tailcall
optimisations for some calls in tail position, for
example to some built-in functions. However, when the
ErLLVM HiPE backend is used, LLVM may choose to perform
tailcall optimisation on these calls, breaking the
expected semantics.</p> <p>To preserve the precise semantics exhibited by BEAM,
the 'notail' marker, present in LLVM since version 3.8,
is added to call instructions that BEAM has not turned
into tail calls, which inhibits LLVM from performing
tail-call optimisation in turn.</p> <p>
Own Id: OTP-14886</p> </li></ul><h2>Hipe 3.17</h2><h2>Fixed Bugs and Malfunctions</h2><ul><li> <p>
Fix bug for hipe compiled code using
<strong>&lt;&lt;X/utf32&gt;&gt;</strong> binary construction that
could cause faulty result or even VM crash.</p> <p>
On architectures other than x86_64, code need to be
recompiled to benefit from this fix.</p> <p>
Own Id: OTP-14740</p> </li></ul><h2>Improvements and New Features</h2><ul><li> <p>
Added documentation about limitations of hipe compared to
beam compiled code.</p> <p>
Own Id: OTP-14767</p> </li></ul><h2>Hipe 3.16.1</h2><h2>Fixed Bugs and Malfunctions</h2><ul><li> <p> Fix a bug regarding map types that caused Dialyzer to
go into an infinite loop. A consequence of the fix is
that compound map keys such as maps and tuples sometimes
are handled with less precision than before. </p> <p>
Own Id: OTP-14572 Aux Id: seq13319 </p> </li></ul><h2>Improvements and New Features</h2><ul><li> <p>
General Unicode improvements.</p> <p>
Own Id: OTP-14462</p> </li></ul><h2>Hipe 3.16</h2><h2>Fixed Bugs and Malfunctions</h2><ul><li> <p>
Fix hipe compiler flags <strong>o0</strong> and <strong>o1</strong> that have
previously been ignored by mistake.</p> <p>
Own Id: OTP-13862 Aux Id: PR-1154 </p> </li><li> <p>
Fix LLVM backend to not convert all remote calls to own
module, like <strong>?MODULE:foo()</strong>, into local calls.</p> <p>
Own Id: OTP-13983</p> </li><li> <p>
Hipe optional LLVM backend does require LLVM version 3.9
or later as older versions forced strong dependencies on
erts internals structures.</p> <p>
Own Id: OTP-14238</p> </li><li> <p>
Fix a bug that has been seen causing failed loading of
hipe compiled modules on NetBSD due to unaligned data
pointers.</p> <p>
Own Id: OTP-14302 Aux Id: ERL-376, PR-1386 </p> </li><li> <p>
Fix miscompilation bug in hipe that could cause wrong
function clause to be called from non-tail calls, where
the return value is unused, if the right function clause
is only reachable from those non-tail calls.</p> <p>
Own Id: OTP-14306 Aux Id: ERL-278, PR-1392 </p> </li></ul><h2>Improvements and New Features</h2><ul><li> <p>
Improve hipe compilation time for large functions.</p> <p>
Own Id: OTP-13810 Aux Id: PR-1124 </p> </li><li> <p>Replaced usage of deprecated symbolic <a href="../erts/erlang#type-time_unit">erts/erlang#type-time_unit</a> representations.</p> <p>
Own Id: OTP-13831 Aux Id: OTP-13735 </p> </li><li> <p>
Speed up hipe compile time register allocation for larger
function.</p> <p>
Own Id: OTP-13879</p> </li><li> <p>
Various code generation improvements.</p> <p>
Own Id: OTP-14261 Aux Id: PR-1360 </p> </li><li> <p>
Improve hipe compiler to generate code with better CPU
register utilization at runtime by the use of 'Live Range
Splitting' techniques.</p> <p>
Own Id: OTP-14293 Aux Id: PR-1380 </p> </li><li> <p>
Allow HiPE to run on VM built with
<strong>--enable-m32-build</strong>.</p> <p>
Own Id: OTP-14330 Aux Id: PR-1397 </p> </li></ul><h2>Hipe 3.15.4</h2><h2>Fixed Bugs and Malfunctions</h2><ul><li> <p> Fix a bug concerning parameterized opaque types. </p> <p>
Own Id: OTP-14130</p> </li><li> <p>
Fixed xml issues in old release notes</p> <p>
Own Id: OTP-14269</p> </li></ul><h2>Hipe 3.15.3</h2><h2>Fixed Bugs and Malfunctions</h2><ul><li> <p>
Fix flow control bug in hipe compiler that may cause
compile time crash.</p> <p>
Own Id: OTP-13965 Aux Id: PR-1253 </p> </li><li> <p>
Fix bug in native compilation of bitstring pattern
matching causing erroneous runtime matching result. The
bug only affects code containing constant-valued segments
whose size is expressed in bits; it is triggered when the
pattern matching against these segments fails (i.e., when
the next clause needs to be tried).</p> <p>
Own Id: OTP-14005</p> </li><li> <p>
Workaround in HiPE LLVM backend for a bug in LLVM 3.9.
The bug could cause LLVM-compiled modules to be rejected
during loading with a badarg exception in
hipe_bifs:enter_sdecs/1, but also cause corruption or
segmentation faults i runtime.</p> <p>
Own Id: OTP-14027 Aux Id: ERL-292, PR-1237 </p> </li><li> <p>
Fix a bug in HiPE LLVM backend involving incorrect type
tests of atoms sometimes causing incorrect behaviour or
even segfaults.</p> <p>
Own Id: OTP-14028 Aux Id: PR-1237 </p> </li></ul><h2>Hipe 3.15.2</h2><h2>Fixed Bugs and Malfunctions</h2><ul><li> <p>
Fixed various hipe compiler backend bugs affecting mostly
ARM and SPARC.</p> <p>
Own Id: OTP-13846 Aux Id: PR-1146 </p> </li><li> <p>
Fixed some Dialyzer warnings and code cleanup for the
Sparc compiler backend.</p> <p>
Own Id: OTP-13861 Aux Id: PR-1148 </p> </li><li> <p> Fix erl_bif_types opaque bug. </p> <p>
Own Id: OTP-13878 Aux Id: PR-1161, ERL-249 </p> </li></ul><h2>Improvements and New Features</h2><ul><li> <p>
Fix erl_types opaque match order</p> <p>
Own Id: OTP-13876</p> </li></ul><h2>Hipe 3.15.1</h2><h2>Fixed Bugs and Malfunctions</h2><ul><li> <p>
HiPE compiler crashed, during compilation, in some cases
that involved inlining of float operations on complicated
control flow graphs.</p> <p>
Own Id: OTP-13407 Aux Id: PR-984 </p> </li><li> <p>
Various fixes and improvements to the HiPE LLVM backend.</p> <ul><li>Add support for LLVM 3.7 and 3.8 in the HiPE/LLVM x86_64 backend</li><li>Reinstate support for the LLVM backend on x86 (works OK for LLVM 3.5 to 3.7 -- LLVM 3.8 has a bug that prevents it from generating correct native code on x86)</li></ul> <p>
Own Id: OTP-13626</p> </li></ul><h2>Improvements and New Features</h2><ul><li> <p>
Elimination of <strong>maps:is_key/2</strong> calls to HiPE</p> <p>
Own Id: OTP-13625 Aux Id: PR-1069 </p> </li></ul><h2>Hipe 3.15</h2><h2>Fixed Bugs and Malfunctions</h2><ul><li> <p>
Fix pretty printing of Core Maps</p> <p>
Literal maps could cause Dialyzer to crash when pretty
printing the results.</p> <p>
Own Id: OTP-13238</p> </li><li> <p>
Dialyzer warnings removed.</p> <p>
Own Id: OTP-13379</p> </li></ul><h2>Improvements and New Features</h2><ul><li> <p>
Fix HiPE ErLLVM code generation for pattern matching with
UTF binaries.</p> <p>
Own Id: OTP-13269</p> </li><li> <p>
Fix various binary construction inconsistencies for hipe
compiled code.</p> <ul><li>Passing bad field sizes to binary constructions would throw <strong>badarith</strong> rather than <strong>badarg</strong>. Worse, in guards, when the unit size of the field was 1, the exception would leak rather than failing the function clause match.</li><li>Passing bignums as field sizes to binary constructions would always fail (and always with <strong>badarg</strong>).</li><li>A bug in bs_init_bits that cased binary constructions to fail with system_limit if they were at least 1/8th of the actual limit.</li><li>Compiler crashes when matches against an integer literal whose size fits an unsigned word, but not a signed word or matches against an integer literal that whose size is larger than the largest allowed bignum.</li><li>Very large binary constructions that should fail with system_limit could instead fail with <strong>badarg</strong> or even succeed with a faulty result.</li><li>Add missing check for unit size match when inserting a binary. For example, a faulty expression like <strong>&lt;&lt;&lt;&lt;1:7&gt;&gt;/binary&gt;&gt;</strong> would succeed.</li></ul> <p>
Own Id: OTP-13272</p> </li></ul><h2>Hipe 3.14</h2><h2>Fixed Bugs and Malfunctions</h2><ul><li> <p>
Fix hipe bug causing segfaults when native code
constructs binaries starting with a zero-length integer
field.</p> <p>
Own Id: OTP-13048</p> </li><li> <p>
Reintroduce the <strong>erlang:make_fun/3</strong> BIF in
erl_bif_types.</p> <p>
Own Id: OTP-13068</p> </li><li> <p>
In certain cases of matching with very big binaries, the
HiPE compiler generated code that would fail the match,
even in cases that the matching was successful. The
problem was more quite noticeable on 32-bit platforms.</p> <p>
Own Id: OTP-13092</p> </li></ul><h2>Improvements and New Features</h2><ul><li> <p>
mikpe/hipe_x86_signal-musl-support</p> <p>
Own Id: OTP-13159</p> </li></ul><h2>Hipe 3.13</h2><h2>Fixed Bugs and Malfunctions</h2><ul><li> <p> Fix bugs concerning <strong>erlang:abs/1</strong>. </p> <p>
Own Id: OTP-12948</p> </li><li> <p> Fix a bug concerning <strong>lists:keydelete/3</strong> with
union and opaque types. </p> <p>
Own Id: OTP-12949</p> </li><li> <p>
A beam file compiled by hipe for an incompatible runtime
system was sometimes not rejected by the loader, which
could lead to vm crash. This fix will also allow the same
hipe compiler to be used by both normal and debug-built
vm.</p> <p>
Own Id: OTP-12962</p> </li></ul><h2>Improvements and New Features</h2><ul><li> <p>
New function <strong>hipe:erts_checksum/0</strong> which returns a
value identifying the target runtime system for the
compiler. Used by dialyzer for its beam cache directory.</p> <p>
Own Id: OTP-12963 Aux Id: OTP-12962, OTP-12964 </p> </li></ul><h2>Hipe 3.12</h2><h2>Fixed Bugs and Malfunctions</h2><ul><li> <p> Fix a minor bug in the handling of opaque types. </p> <p>
Own Id: OTP-12666</p> </li><li> <p>
Fix hipe bug when matching a "writable" binary. The bug
has been seen to sometimes cause a failed binary matching
of a correct utf8 character, but other symptoms are also
possible.</p> <p>
Own Id: OTP-12667</p> </li><li> <p>
Optimizations and code cleanup in hipe code loader.</p> <p>
Own Id: OTP-12816</p> </li></ul><h2>Improvements and New Features</h2><ul><li> <p>
Improved error handling when memory allocation for HiPE
code fails.</p> <p>
Own Id: OTP-12448</p> </li><li> <p>
Allow use of complete interface of cerl_pmatch module</p> <p>
Own Id: OTP-12794</p> </li></ul><h2>Hipe 3.11.3</h2><h2>Fixed Bugs and Malfunctions</h2><ul><li> <p>
Fix HiPE for ARM when Erlang VM is compiled for Thumb
execution mode. This was a problem on e.g. Ubuntu which
configures its system GCC to generate Thumb by default.</p> <p>
Own Id: OTP-12405</p> </li><li> <p>
Reduced lock contention of dynamic function lookups (like
apply) from hipe compiled code.</p> <p>
Own Id: OTP-12557</p> </li></ul><h2>Improvements and New Features</h2><ul><li> <p>
Fix two bugs in HiPE compiler regarding floating-points,
both leading to crash during compilation. The
target-specific code generators failed to handle integer
to floating-point conversion instructions with constant
operands. The middle-end could use an incorrect
representation for copies between floating-point
registers.</p> <p>
Own Id: OTP-12413</p> </li><li> <p>
Improved error handling when memory allocation for HiPE
code fails.</p> <p>
Own Id: OTP-12448</p> </li></ul><h2>Hipe 3.11.2</h2><h2>Fixed Bugs and Malfunctions</h2><ul><li> <p>
Fixed internal elf_format hrl file to contain valid
erlang</p> <p>
Own Id: OTP-12322</p> </li></ul><h2>Hipe 3.11.1</h2><h2>Fixed Bugs and Malfunctions</h2><ul><li> <p> The pretty-printing of bitstrings has been corrected.
</p> <p>
Own Id: OTP-12015</p> </li><li> <p> A bug concerning <strong>is_record/2,3</strong> has been fixed,
as well as some cases where Dialyzer could crash due to
reaching system limits. </p> <p>
Own Id: OTP-12018</p> </li></ul><h2>Hipe 3.11</h2><h2>Fixed Bugs and Malfunctions</h2><ul><li> <p>
A Dialyzer crash involving analysis of Map types has now
been fixed.</p> <p>
Own Id: OTP-11947</p> </li></ul><h2>Improvements and New Features</h2><ul><li> <p>
Handle Maps instructions get_map_elements, put_map_assoc,
put_map_exact in HiPE compiler.</p> <p>
Own Id: OTP-11900</p> </li></ul><h2>Hipe 3.10.3</h2><h2>Fixed Bugs and Malfunctions</h2><ul><li> <p>
Fix compilation with 'no_remove_comments' (Thanks to
Johannes WeiÃl)</p> <p>
Own Id: OTP-11564</p> </li><li> <p>
Application upgrade (appup) files are corrected for the
following applications: </p> <p>
<strong>asn1, common_test, compiler, crypto, debugger, dialyzer, edoc, eldap, erl_docgen, et, eunit, gs, hipe, inets, observer, odbc, os_mon, otp_mibs, parsetools, percept, public_key, reltool, runtime_tools, ssh, syntax_tools, test_server, tools, typer, webtool, wx, xmerl</strong></p> <p>
A new test utility for testing appup files is added to
test_server. This is now used by most applications in
OTP.</p> <p>
(Thanks to Tobias Schlager)</p> <p>
Own Id: OTP-11744</p> </li><li> <p>
There is now a test suite for the Hipe application</p> <p>
Own Id: OTP-11748</p> </li><li> <p>
Support for a LLVM backend has been added in HiPE</p> <p>
Own Id: OTP-11801</p> </li></ul><h2>Improvements and New Features</h2><ul><li> <p> The pre-defined types <strong>array/0</strong>, <strong>dict/0</strong>,
<strong>digraph/0</strong>, <strong>gb_set/0</strong>, <strong>gb_tree/0</strong>,
<strong>queue/0</strong>, <strong>set/0</strong>, and <strong>tid/0</strong> have been
deprecated. They will be removed in Erlang/OTP 18.0. </p> <p> Instead the types <strong>array:array/0</strong>,
<strong>dict:dict/0</strong>, <strong>digraph:graph/0</strong>,
<strong>gb_set:set/0</strong>, <strong>gb_tree:tree/0</strong>,
<strong>queue:queue/0</strong>, <strong>sets:set/0</strong>, and
<strong>ets:tid/0</strong> can be used. (Note: it has always been
necessary to use <strong>ets:tid/0</strong>.) </p> <p> It is
allowed in Erlang/OTP 17.0 to locally re-define the types
<strong>array/0</strong>, <strong>dict/0</strong>, and so on. </p> <p> New
types <strong>array:array/1</strong>, <strong>dict:dict/2</strong>,
<strong>gb_sets:set/1</strong>, <strong>gb_trees:tree/2</strong>,
<strong>queue:queue/1</strong>, and <strong>sets:set/1</strong> have been
added. </p> <p> A compiler option,
<strong>nowarn_deprecated_type</strong>, has been introduced. By
including the attribute </p> <strong> -compile(nowarn_deprecated_type).</strong> <p> in an Erlang
source file, warnings about deprecated types can be
avoided in Erlang/OTP 17.0. </p> <p> The option can also
be given as a compiler flag: </p> <strong> erlc +nowarn_deprecated_type file.erl</strong> <p>
Own Id: OTP-10342</p> </li><li> <p>
EEP43: New data type - Maps</p> <p>
With Maps you may for instance:</p> <dl><dt></dt><dd><strong>M0 = #{ a =&gt; 1, b =&gt; 2}, % create associations</strong></dd><dt></dt><dd><strong>M1 = M0#{ a := 10 }, % update values</strong></dd><dt></dt><dd><strong>M2 = M1#{ "hi" =&gt; "hello"}, % add new associations</strong></dd><dt></dt><dd><strong>#{ "hi" := V1, a := V2, b := V3} = M2. % match keys with values</strong></dd></dl> <p>
For information on how to use Maps please see Map Expressions in the
<a href="../doc/reference_manual/expressions#map_expressions"> Reference Manual</a>.</p> <p>
The current implementation is without the following
features:</p> <dl><dt></dt><dd>No variable keys</dd><dt></dt><dd>No single value access</dd><dt></dt><dd>No map comprehensions</dd></dl> <p>
Note that Maps is <em>experimental</em> during OTP 17.0.</p> <p>
Own Id: OTP-11616</p> </li><li> <p> Parameterized opaque types have been introduced. </p> <p>
Own Id: OTP-11625</p> </li><li> <p>
Add support for the compilation of the is_map/1 and
map_size/1 guards to native code.</p> <p>
Own Id: OTP-11831</p> </li></ul><h2>Hipe 3.10.2.2</h2><h2>Fixed Bugs and Malfunctions</h2><ul><li> <p>
Fixed a dialyzer crash when using remote types in the
tail position of a maybe_improper_list/2 type. Thanks to
Kostis Sagonas</p> <p>
Own Id: OTP-11374</p> </li></ul><h2>Hipe 3.10.2.1</h2><h2>Improvements and New Features</h2><ul><li> <p>
The encoding of the <strong>notes.xml</strong> file has been
changed from latin1 to utf-8 to avoid future merge
problems.</p> <p>
Own Id: OTP-11310</p> </li></ul><h2>Hipe 3.10.2</h2><h2>Improvements and New Features</h2><ul><li> <p>
Fix the title of hipe_app documentation page. Thanks to
LoÃ¯c Hoguin.</p> <p>
Own Id: OTP-10904</p> </li><li> <p>
Fix native code compiler crash involving bs_match_string.
Thanks to Kostis Sagonas.</p> <p>
Own Id: OTP-10985</p> </li><li> <p>
Loosen the assumptions of code that handles escaping
functions. Thanks to Kostis Sagonas</p> <p>
Own Id: OTP-11031</p> </li></ul><h2>Hipe 3.10.1</h2><h2>Fixed Bugs and Malfunctions</h2><ul><li> <p>
Bug fixed in hipe to where it did not allow unicode code
points 16#FFFE and 16#FFFF in bit syntax in natively
compiled modules.</p> <p>
Own Id: OTP-10867</p> </li><li> <p>
Fix bug in hipe compiled code related to the handling of
<strong>is_number/1</strong>. (Thanks to Sebastian Egner and
Johannes WeiÃl for minimal test code and Kostis for quick
patch)</p> <p>
Own Id: OTP-10897</p> </li></ul><h2>Hipe 3.10</h2><h2>Fixed Bugs and Malfunctions</h2><ul><li> <p> The type <strong>ascii_string()</strong> in the <strong>base64</strong>
module has been corrected. The type
<strong>file:file_info()</strong> has been cleaned up. The type
<strong>file:fd()</strong> has been made opaque in the
documentation. </p> <p>
Own Id: OTP-10624 Aux Id: kunagi-352 [263] </p> </li></ul><h2>Improvements and New Features</h2><ul><li> <p> Support for Unicode has been implemented. </p> <p>
Own Id: OTP-10302</p> </li><li> <p>Where necessary a comment stating encoding has been
added to Erlang files. The comment is meant to be removed
in Erlang/OTP R17B when UTF-8 becomes the default
encoding. </p> <p>
Own Id: OTP-10630</p> </li><li> <p>
Update .gitignore (lib/hipe/boot_ebin). Thanks to Tuncer
Ayaz.</p> <p>
Own Id: OTP-10705</p> </li></ul><h2>Hipe 3.9.3</h2><h2>Fixed Bugs and Malfunctions</h2><ul><li> <p>
A faulty spec for process_info/2 could cause false
dialyzer warnings. The spec is corrected.</p> <p>
Own Id: OTP-10584</p> </li></ul><h2>Hipe 3.9.2</h2><h2>Fixed Bugs and Malfunctions</h2><ul><li> <p> Correct handling of type names in contracts. Fix
crash related to contract checking. Do not rewrite
unchanged PLT. </p> <p>
Own Id: OTP-10083</p> </li><li> <p>
Changes in comments and minor code cleanups</p> <p>
Thanks to Kostis Sagonas.</p> <p>
Own Id: OTP-10230</p> </li></ul><h2>Improvements and New Features</h2><ul><li> <p>
Remove all code, documentation, options and diagnostic
functions which were related to the experimental hybrid
heap implementation.</p> <p>
Own Id: OTP-10105</p> </li><li> <p> Bugs in <strong>erl_types:t_inf()</strong> (HiPE) and in
<strong>dialyzer_dataflow</strong> (Dialyzer) have been fixed. </p> <p>
Own Id: OTP-10191</p> </li></ul><h2>Hipe 3.9.1</h2><h2>Fixed Bugs and Malfunctions</h2><ul><li> <p>
References to <strong>is_constant/1</strong> (which was removed in
the R12 release) has been removed from documentation and
code.</p> <p>
Own Id: OTP-6454 Aux Id: seq10407 </p> </li><li> <p>
Fixed a discrepancy in compile_info</p> <p>
The BEAM disassembler used the atom 'none' to signify the
absence of a compile_info chunk in a .beam file. This
clashed with the type declaration of the compile_info
field of a #beam_file{} record as containing a list. Now
[] signifies the absence of this chunk. This simplifies
the code and avoids a dialyzer warning.</p> <p>
Own Id: OTP-9917</p> </li><li> <p>
Make dialyzer recognize the process_flag option sensitive
add missing specs to documentation (Thanks to Tobias
Schlager)</p> <p>
Own Id: OTP-9923</p> </li><li> <p>
Remove hipe_ceach from hipe.app.src to fix
reltool-generated release startup. (Thanks to Tim
Stewart)</p> <p>
Own Id: OTP-9939</p> </li></ul><h2>Hipe 3.9</h2><h2>Fixed Bugs and Malfunctions</h2><ul><li> <ul><li><p>No warnings for underspecs with remote
types</p></li><li><p> Fix crash in Typer</p></li><li><p>Fix Dialyzer's warning for its own
code</p></li><li><p>Fix Dialyzer's warnings in
HiPE</p></li><li><p>Add file/line info in a
particular Dialyzer crash</p></li><li><p>Update
inets test results</p></li></ul> <p>
Own Id: OTP-9758</p> </li><li> <ul><li><p>Correct callback spec in application
module</p></li><li><p>Refine warning about callback
specs with extra ranges</p></li><li><p>Cleanup
autoimport compiler directives</p></li><li><p>Fix
Dialyzer's warnings in typer</p></li><li><p>Fix
Dialyzer's warning for its own code</p></li><li><p>Fix bug in Dialyzer's behaviours
analysis</p></li><li><p>Fix crash in
Dialyzer</p></li><li><p>Variable substitution was
not generalizing any unknown variables.</p></li></ul> <p>
Own Id: OTP-9776</p> </li></ul><h2>Improvements and New Features</h2><ul><li> <p>
Possible to run HiPE without floating point exceptions
(FPE). Useful on platforms that lack reliable FPE. Slower
float operations compared to HiPE with FPE.</p> <p>
Own Id: OTP-9724</p> </li><li> <p>
HiPE compiler: The possibility to compile and load
selected functions from a module has been removed.</p> <p>
*** POTENTIAL INCOMPATIBILITY ***</p> <p>
Own Id: OTP-9751</p> </li><li> <p>
<strong>filename:find_src/1,2</strong> will now work on stripped
BEAM files (reported by Per Hedeland). The HiPE compiler
will also work on stripped BEAM files. The BEAM compiler
will no longer include compilation options given in the
source code itself in <strong>M:module_info(compile)</strong>
(because those options will be applied anyway if the
module is re-compiled).</p> <p>
Own Id: OTP-9752</p> </li><li> <p> Optimize <strong>erl_types:t_unify()</strong>. </p> <p>
Own Id: OTP-9768</p> </li></ul><h2>Hipe 3.8.1</h2><h2>Fixed Bugs and Malfunctions</h2><ul><li> <p>
Clean up hipe.hrl.src (Thanks to Tuncer Ayaz)</p> <p>
Own Id: OTP-9511</p> </li><li> <p>
Fix bug with binary pattern matching of floats of
variable size</p> <p>
Pattern matching of floats with variable size
(&lt;&lt;F:S/float&gt;&gt;) did always fail. Judging from
similar code for ints, this bug is simply a typo.(Thanks
to Paul Guyot)</p> <p>
Own Id: OTP-9556</p> </li><li> <p>
Quote atoms if necessary in types</p> <p>
Atoms in some occurrences were not correctly quoted when
formatted to strings, for instance by the typer program
(Thanks to Tomas Abrahamsson)</p> <p>
Update Dialyzer's reference results</p> <p>
Own Id: OTP-9560</p> </li><li> <p>
Fix typer's crash for nonexisting files Remove unused
macro Fix bug in dataflow Decrease tuple arity limit This
fixes a memory related crash.</p> <p>
Own Id: OTP-9597</p> </li></ul><h2>Improvements and New Features</h2><ul><li> <p>
Types for several BIFs have been extended/corrected. Also
the types for types for <strong>lists:keyfind/3</strong>,
<strong>lists:keysearch/3</strong>, and <strong>lists:keyemember/3</strong>
have been corrected. The incorrect/incomplete types could
cause false dialyzer warnings.</p> <p>
Own Id: OTP-9496</p> </li></ul><h2>Hipe 3.8</h2><h2>Fixed Bugs and Malfunctions</h2><ul><li> <p>
Fix hipe bug causing minor heap corruption related to
binary matching. The bug has not been confirmed as the
cause of any actual fault symptom.</p> <p>
Own Id: OTP-9182</p> </li><li> <p>
Enable HiPE by default when compiling for PPC64</p> <p>
Own Id: OTP-9198</p> </li><li> <p>
Fix handling of &lt;&lt;_:N,_:_*M&gt;&gt; type
expressions Fix the argument of
erlang:list_to_bitstring/1 Remove unneeded function
'sequence/2' Same functionality provided by
string:join/2.</p> <p>
Own Id: OTP-9277</p> </li></ul><h2>Hipe 3.7.9</h2><h2>Fixed Bugs and Malfunctions</h2><ul><li> <p>
Fix erroneous fail info of a hipe_bs_primop</p> <p>
Own Id: OTP-9036</p> </li><li> <p>
The change fixes a bug in the translation of 'bs_add'
BEAM instruction to HiPE's Icode representation. When
these instructions appeared in a guard context the
previous translation was obviously buggy.</p> <p>
Own Id: OTP-9044</p> </li><li> <p>
Sanitize the specs of the code module</p> <p>
After the addition of unicode_binary() to the
file:filename() type, dialyzer started complaining about
erroneous or incomplete specs in some functions of the
'code' module. The culprit was hard-coded information in
erl_bif_types for functions of this module, which were
not updated. Since these functions have proper specs
these days and code duplication (pun intended) is never a
good idea, their type information was removed from
erl_bif_types.</p> <p>
While doing this, some erroneous comments were fixed in
the code module and also made sure that the code now runs
without dialyzer warnings even when the
-Wunmatched_returns option is used.</p> <p>
Some cleanups were applied to erl_bif_types too.</p> <p>
Own Id: OTP-9100</p> </li><li> <p>
Fix bug in the simplification of inexact comparisons</p> <p>
On 31/1/2011 Paul Guyot reported a bug in the native code
compilation of inexact equality/inequality tests between
floats and integers. The relevant test was:</p> <p>
f(X) -&gt; Y = X / 2, Y == 0.</p> <p>
and hipe erroneously evaluated the calls f(0) and f(0.0)
to 'false'.</p> <p>
The culprit was in the simplification code of the Icode
range analysis which used an erroneous test (lists:any/1
instead of lists:all/1).</p> <p>
Own Id: OTP-9101</p> </li><li> <p>
Document exiting and garbage_collecting process statuses</p> <p>
Own Id: OTP-9102</p> </li><li> <p>
Remove hipe constants pool</p> <p>
Hipe constants used to be allocated within a single,
fixed-size pool for interaction with the garbage
collector. However, the garbage collector no longer
depends on constants being allocated within a single
pool, and the fixed size of the pool both meant
unnecessary allocations on most deployments and crashes
on deployments requiring more constants.</p> <p>
The code was simplified to directly invoke erts_alloc.
Debugging and undocumented function
hipe_bifs:show_literals/0 was removed (it returned true
and output text to the console), and debugging and
undocumented function hipe_bifs:constants_size/0 was
rewritten with a global to count the size of allocated
constants.</p> <p>
Own Id: OTP-9128</p> </li></ul><h2>Hipe 3.7.8.1</h2><h2>Fixed Bugs and Malfunctions</h2><ul><li> <p>
Several type specifications for standard libraries were
wrong in the R14B01 release. This is now corrected. The
corrections concern types in re,io,filename and the
module erlang itself.</p> <p>
Own Id: OTP-9008</p> </li></ul><h2>Hipe 3.7.8</h2><h2>Improvements and New Features</h2><ul><li> <p>
Compiler warnings were eliminated.</p> <p>
Own Id: OTP-8855</p> </li></ul><h2>Hipe 3.7.7</h2><h2>Fixed Bugs and Malfunctions</h2><ul><li> <p>The HiPE compiler could crash when compiling certain
modules (the bug has been latent, and been exposed by new
optimizations introduced in the BEAM compiler in R14A).
(Thanks to Mikael Pettersson.)</p> <p>
Own Id: OTP-8800</p> </li><li> <p>
hipe:load/1 was broken. (Thanks to Paul Guyot.)</p> <p>
Own Id: OTP-8802</p> </li></ul><h2>Hipe 3.7.6</h2><h2>Improvements and New Features</h2><ul><li> <p><strong>receive</strong> statements that can only read out a
newly created reference are now specially optimized so
that it will execute in constant time regardless of the
number of messages in the receive queue for the process.
That optimization will benefit calls to
<strong>gen_server:call()</strong>. (See <strong>gen:do_call/4</strong> for
an example of a receive statement that will be
optimized.)</p> <p>
Own Id: OTP-8623</p> </li><li> <p>
Various changes to dialyzer-related files for R14.</p> <p>
- Dialyzer properly supports the new attribute
-export_type and checks that remote types only refer to
exported types. A warning is produced if some
files/applications refer to types defined in modules
which are neither in the PLT nor in the analyzed
applications.</p> <p>
- Support for detecting data races involving whereis/1
and unregister/1.</p> <p>
- More precise identification of the reason(s) why a
record construction violates the types declared for its
fields.</p> <p>
- Fixed bug in the handling of the 'or' guard.</p> <p>
- Better handling of the erlang:element/2 BIF.</p> <p>
- Complete handling of Erlang BIFs.</p> <p>
Own Id: OTP-8699</p> </li><li> <p><strong>eprof</strong> has been reimplemented with support in
the Erlang virtual machine and is now both faster (i.e.
slows down the code being measured less) and scales much
better. In measurements we saw speed-ups compared to the
old eprof ranging from 6 times (for sequential code that
only uses one scheduler/core) up to 84 times (for
parallel code that uses 8 cores).</p> <p>Note: The API for the <strong>eprof</strong> has been cleaned up
and extended. See the documentation.</p> <p>
*** POTENTIAL INCOMPATIBILITY ***</p> <p>
Own Id: OTP-8706</p> </li></ul><h2>Hipe 3.7.5</h2><h2>Improvements and New Features</h2><ul><li> <p>The documentation is now possible to build in an open
source environment after a number of bugs are fixed and
some features are added in the documentation build
process. </p> <p>- The arity calculation is updated.</p> <p>- The module prefix used in the function names for
bif's are removed in the generated links so the links
will look like
"http://www.erlang.org/doc/man/erlang.html#append_element-2"
instead of
"http://www.erlang.org/doc/man/erlang.html#erlang:append_element-2".</p> <p>- Enhanced the menu positioning in the html
documentation when a new page is loaded.</p> <p>- A number of corrections in the generation of man
pages (thanks to Sergei Golovan)</p> <p>- The legal notice is taken from the xml book file so
OTP's build process can be used for non OTP
applications.</p> <p>
Own Id: OTP-8343</p> </li></ul><h2>Hipe 3.7.4</h2><h2>Improvements and New Features</h2><ul><li> <p>
The documentation is now built with open source tools
(xsltproc and fop) that exists on most platforms. One
visible change is that the frames are removed.</p> <p>
Own Id: OTP-8201</p> </li><li> <p>
Misc updates.</p> <p>
Own Id: OTP-8301</p> </li></ul><h2>Hipe 3.7.3</h2><h2>Improvements and New Features</h2><ul><li> <p>
Various small bugs (one involving the handling of large
binaries) were corrected and some additions to its
functionality and/or code cleanups were done.</p> <p>
Own Id: OTP-8189</p> </li></ul><h2>Hipe 3.7.2</h2><h2>Improvements and New Features</h2><ul><li> <p>
Miscellaneous updates.</p> <p>
Own Id: OTP-8038</p> </li></ul><h2>Hipe 3.7.1</h2><h2>Improvements and New Features</h2><ul><li> <p>
Minor updates and bug fixes.</p> <p>
Own Id: OTP-7958</p> </li></ul><h2>Hipe 3.7</h2><h2>Improvements and New Features</h2><ul><li> <p>
Miscellaneous updates.</p> <p>
Own Id: OTP-7877</p> </li></ul><h2>Hipe 3.6.9</h2><h2>Improvements and New Features</h2><ul><li> <p>The <strong>--disable-hipe</strong> option for the
<strong>configure</strong> will now completely disable the hipe
run-time in the emulator, as is the expected
behaviour.</p> <p>
Own Id: OTP-7631</p> </li></ul><h2>Hipe 3.6.8</h2><h2>Improvements and New Features</h2><ul><li> <p>
Minor updates.</p> <p>
Own Id: OTP-7522</p> </li></ul><h2>Hipe 3.6.7</h2><h2>Improvements and New Features</h2><ul><li> <p>
Minor changes.</p> <p>
Own Id: OTP-7388</p> </li></ul><h2>Hipe 3.6.6</h2><h2>Fixed Bugs and Malfunctions</h2><ul><li> <p>A fix for an #include problem which caused the FP
exception test to fail unnecessarily on
debian/glibc-2.7/x86 systems.</p> <p>Added SIGFPE loop detection to the FP exception test.
This prevents the test from looping indefinitely, which
could happen when the CPU is supported (so we can enable
FP exceptions on it) but the OS isn't (so we can't write
a proper SIGFPE handler). x86 on an unsupported OS is
known to have had this problem.</p> <p>
Own Id: OTP-7254</p> </li></ul><h2>Improvements and New Features</h2><ul><li> <p>
HiPE now also supports little-endian ARM processors.</p> <p>
Own Id: OTP-7255</p> </li></ul><h2>Hipe 3.6.5</h2><h2>Fixed Bugs and Malfunctions</h2><ul><li> <p>
HIPE: Corrected the choice of interface to the send/3 and
setnode/3 BIFs for native-compiled code. Using the
incorrect interface could, in unusual circumstances, lead
to random runtime errors.</p> <p>
Own Id: OTP-7067</p> </li></ul><h2>Improvements and New Features</h2><ul><li> <p>
The HiPE compiler's SPARC backend has been rewritten,
improving its correctness and long-term maintainability.</p> <p>
Own Id: OTP-7133</p> </li></ul><h2>Hipe 3.6.3</h2><h2>Improvements and New Features</h2><ul><li> <p>Minor Makefile changes.</p> <p>Own Id: OTP-6689</p> </li><li> <p>Miscellanous updates.</p> <p>Own Id: OTP-6738</p> </li></ul><h2>Hipe 3.6.2</h2><h2>Improvements and New Features</h2><ul><li> <p>Miscellanous improvements.</p> <p>Own Id: OTP-6577</p> </li></ul><h2>Hipe 3.6.1.1</h2><h2>Fixed Bugs and Malfunctions</h2><ul><li> <p>Dialyzer could fail to analyze certain beam files that
used try/catch.</p> <p>Own Id: OTP-6449 Aux Id: seq10563 </p> </li></ul><h2>Hipe 3.6.1</h2><h2>Improvements and New Features</h2><ul><li> <p>HiPE runtime system:</p> <p>* added notes about supported systems to README</p> <p>* support 32-bit x86 on FreeBSD</p> <p>* autoenable HiPE on FreeBSD (32-bit x86) and Solaris
(64-bit x86)</p> <p>* updated x86 runtime system to support glibc-2.5</p> <p>* work around probable gcc-4.1.1 bug affecting the x86
runtime system</p> <p>HiPE compiler:</p> <p>* improved performance of integer multiplications on
all platforms</p> <p>* corrected a code optimisation error in R11B-2 that
broke some bsl/bsr operations on all platforms</p> <p>* corrected a type error in the ARM backend which
could cause the compiler to crash</p> <p>* corrected an error in the SPARC backend's naive
register allocator which could throw the compiler into an
infinite loop</p> <p>Own Id: OTP-6423</p> </li></ul><h2>Hipe 3.6.0</h2><h2>Improvements and New Features</h2><ul><li> <p>Support for native code on Solaris 10/AMD64.</p> <p>Support for native code on FreeBSD/AMD64.</p> <p>Native code now handles external funs (<strong>fun M:F/A</strong>). Native code can now also apply so-called
tuple-funs (<strong>{M,F}</strong>). (Tuple funs are NOT
recommended for new code; they are deprecated and will be
removed in some future release.)</p> <p>Own Id: OTP-6305</p> </li></ul><h2>Hipe 3.5.6</h2><h2>Improvements and New Features</h2><ul><li> <p>Improved compilation of receives for the SMP runtime
system.</p> <p>Improved code quality in HiPE compiler on ARM.</p> <p>Fix bug in handling of re-raised exceptions in
try-catch.</p> <p>(HiPE loader) When native code is incompatible with
the current runtime system, fall back to loading the BEAM
code.</p> <p>Own Id: OTP-6127</p> </li></ul></body></html>