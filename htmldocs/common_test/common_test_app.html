<!doctype html>
<html><head><meta charset="utf-8"><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.0/css/bootstrap.min.css"></head><body style="margin: 4em 10%"><h1>Common Test</h1><h1>common_test</h1><p>A framework for automated testing of any target nodes.</p><p>The <strong>Common Test</strong> framework is an environment for
implementing and performing automatic and semi-automatic execution of
test cases.In brief, <strong>Common Test</strong> supports:<ul><li>Automated execution of test suites (sets of test cases)</li><li>Logging of events during execution</li><li>HTML presentation of test suite results</li><li>HTML presentation of test suite code</li><li>Support functions for test suite authors</li><li>Step-by-step execution of test cases</li></ul>The following section describes the mandatory and optional test suite
functions that <strong>Common Test</strong> calls during test execution.
For more details, see section
<a href="write_test_chapter">Writing Test Suites</a>
in the User's Guide.</p><h2>Test Case Callback Functions</h2><p>The following functions define the callback interface
for a test suite.</p><h1>Functions</h1><h2>Module:all() -&gt; Tests | {skip,Reason}</h2><p>Returns the list of all test case groups and test cases in the module.</p><ul><li><span class="v">Tests = [TestCase | {testcase,TestCase,TCRepeatProps} | {group,GroupName} | {group,GroupName,Properties} | {group,GroupName,Properties,SubGroups}]</span></li><li><span class="v">TestCase = atom()</span></li><li><span class="v">TCRepeatProps = [{repeat,N} | {repeat_until_ok,N} | {repeat_until_fail,N}]</span></li><li><span class="v">GroupName = atom()</span></li><li><span class="v">Properties = [parallel | sequence | Shuffle | {GroupRepeatType,N}] | default</span></li><li><span class="v">SubGroups = [{GroupName,Properties} | {GroupName,Properties,SubGroups}]</span></li><li><span class="v">Shuffle = shuffle | {shuffle,Seed}</span></li><li><span class="v">Seed = {integer(),integer(),integer()}</span></li><li><span class="v">GroupRepeatType = repeat | repeat_until_all_ok | repeat_until_all_fail | repeat_until_any_ok | repeat_until_any_fail</span></li><li><span class="v">N = integer() | forever</span></li><li><span class="v">Reason = term()</span></li></ul><p>MANDATORY</p><p>Returns the list of all test cases and test case groups in the
test suite module to be executed. This list also specifies the
order the cases and groups are executed by <strong>Common Test</strong>.
A test case is represented by an atom,
the name of the test case function, or a <strong>testcase</strong> tuple
indicating that the test case shall be repeated. A test case group is
represented by a <strong>group</strong> tuple, where <strong>GroupName</strong>,
an atom, is the name of the group (defined in
<a href="#Module:groups-0">Module:groups-0</a>).
Execution properties for groups can also be specified, both
for a top-level group and for any of its subgroups.
Group execution properties specified here override
properties in the group definition (see
<a href="#Module:groups-0">Module:groups-0</a>).
(With value <strong>default</strong>, the group definition properties
are used).</p><p>If <strong>{skip,Reason}</strong> is returned, all test cases
in the module are skipped and <strong>Reason</strong>
is printed on the HTML result page.</p><p>For details on groups, see section
<a href="./write_test_chapter#test_case_groups">Test Case Groups</a> in the User's Guide.</p><h2>Module:groups() -&gt; GroupDefs</h2><p>Returns a list of test case group definitions.</p><ul><li><span class="v">GroupDefs = [Group]</span></li><li><span class="v">Group = {GroupName,Properties,GroupsAndTestCases}</span></li><li><span class="v">GroupName = atom()</span></li><li><span class="v">Properties = [parallel | sequence | Shuffle | {GroupRepeatType,N}]</span></li><li><span class="v">GroupsAndTestCases = [Group | {group,GroupName} | TestCase | {testcase,TestCase,TCRepeatProps}]</span></li><li><span class="v">TestCase = atom()</span></li><li><span class="v">TCRepeatProps = [{repeat,N} | {repeat_until_ok,N} | {repeat_until_fail,N}]</span></li><li><span class="v">Shuffle = shuffle | {shuffle,Seed}</span></li><li><span class="v">Seed = {integer(),integer(),integer()}</span></li><li><span class="v">GroupRepeatType = repeat | repeat_until_all_ok | repeat_until_all_fail | repeat_until_any_ok | repeat_until_any_fail</span></li><li><span class="v">N = integer() | forever</span></li></ul><p>OPTIONAL</p><p>Defines test case groups. For details, see section
<a href="./write_test_chapter#test_case_groups">Test Case  Groups</a> in the User's Guide.</p><h2>Module:suite() -&gt; [Info]</h2><p>Test suite info function (providing default data for the suite).</p><ul><li><span class="v">Info = {timetrap,Time} | {require,Required} | {require,Name,Required} | {userdata,UserData} | {silent_connections,Conns} | {stylesheet,CSSFile} | {ct_hooks, CTHs}</span></li><li><span class="v">Time = TimeVal | TimeFunc</span></li><li><span class="v">TimeVal = MilliSec | {seconds,integer()} | {minutes,integer()} | {hours,integer()}</span></li><li><span class="v">TimeFunc = {Mod,Func,Args} | Fun</span></li><li><span class="v">MilliSec = integer()</span></li><li><span class="v">Mod = atom()</span></li><li><span class="v">Func = atom()</span></li><li><span class="v">Args = list()</span></li><li><span class="v">Fun = fun()</span></li><li><span class="v">Required = Key | {Key,SubKeys} | {Key,SubKey} | {Key,SubKey,SubKeys}</span></li><li><span class="v">Key = atom()</span></li><li><span class="v">SubKeys = SubKey | [SubKey]</span></li><li><span class="v">SubKey = atom()</span></li><li><span class="v">Name = atom()</span></li><li><span class="v">UserData = term()</span></li><li><span class="v">Conns = [atom()]</span></li><li><span class="v">CSSFile = string()</span></li><li><span class="v">CTHs = [CTHModule |</span></li><li><span class="v">Â Â Â Â Â Â Â Â {CTHModule, CTHInitArgs} |</span></li><li><span class="v">Â Â Â Â Â Â Â Â {CTHModule, CTHInitArgs, CTHPriority}]</span></li><li><span class="v">CTHModule = atom()</span></li><li><span class="v">CTHInitArgs = term()</span></li></ul><p>OPTIONAL</p><p>The test suite information function.	Returns a list of tagged
tuples specifying various properties related to the execution of
this test suite (common for all test cases in the suite).</p><p>Tag <strong>timetrap</strong> sets the maximum time that each
test case is allowed to execute (including
<a href="#Module:init_per_testcase-2">Module:init_per_testcase-2</a>
and
<a href="#Module:end_per_testcase-2">Module:end_per_testcase-2</a>).
If the timetrap time is exceeded, the test case fails with reason
<strong>timetrap_timeout</strong>. A <strong>TimeFunc</strong> function can be used to
set a new timetrap by returning a <strong>TimeVal</strong>. It can also be
used to trigger a timetrap time-out by, at some point, returning a
value other than a <strong>TimeVal</strong>. For details, see section
<a href="./write_test_chapter#timetraps">Timetrap Time-Outs</a>
in the User's Guide.</p><p>Tag <strong>require</strong> specifies configuration variables
required by test cases (or configuration functions)
in the suite. If the required configuration variables are not found
in any of the configuration files, all test cases are skipped.
For details about the <strong>require</strong> functionality, see funtion
<a href="./ct#require-1">ct#require-1</a>.</p><p>With <strong>userdata</strong>, the user can
specify any test suite-related information, which can be
read by calling
<a href="./ct#userdata-2">ct#userdata-2</a>.</p><p>Tag <strong>ct_hooks</strong> specifies the
<a href="ct_hooks_chapter">Common Test Hooks</a>
to be run with this suite.</p><p>Other tuples than the ones defined are ignored.</p><p>For details about the test suite information function, see section
<a href="./write_test_chapter#suite">Test Suite Information Function</a> in the User's Guide.</p><h2>Module:init_per_suite(Config) -&gt; NewConfig | {skip,Reason} |
	  {skip_and_save,Reason,SaveConfig}</h2><p>Test suite initializations.</p><ul><li><span class="v">Config = NewConfig = SaveConfig = [{Key,Value}]</span></li><li><span class="v">Key = atom()</span></li><li><span class="v">Value = term()</span></li><li><span class="v">Reason = term()</span></li></ul><p>OPTIONAL; if this function is defined, then <a href="#Module:end_per_suite-1">Module:end_per_suite-1</a>
must also be defined.</p><p>This configuration function is called as the first function in the
suite. It typically contains initializations that are common for
all test cases in the suite, and that must only be done
once. Parameter <strong>Config</strong> is the configuration data
that can be modified. Whatever is returned from this
function is specified as <strong>Config</strong> to all configuration functions
and test cases in the suite.</p><p>If <strong>{skip,Reason}</strong>
is returned, all test cases in the suite are skipped
and <strong>Reason</strong> is printed in the overview log for the suite.</p><p>For information on <strong>save_config</strong> and <strong>skip_and_save</strong>,
see section
<a href="./dependencies_chapter#save_config">Saving Configuration Data</a> in the User's Guide.</p><h2>Module:end_per_suite(Config) -&gt; term() | 
	{save_config,SaveConfig}</h2><p>Test suite finalization.</p><ul><li><span class="v">Config = SaveConfig = [{Key,Value}]</span></li><li><span class="v">Key = atom()</span></li><li><span class="v">Value = term()</span></li></ul><p>OPTIONAL; if this function is defined, then <a href="#Module:init_per_suite-1">Module:init_per_suite-1</a>
must also be defined.</p><p>This function is called as the last test case in the
suite. It is meant to be used for cleaning up after
<a href="#Module:init_per_suite-1">Module:init_per_suite-1</a>.</p><p>For information on <strong>save_config</strong>, see section
<a href="./dependencies_chapter#save_config">Saving Configuration Data</a> in the User's Guide.</p><h2>Module:group(GroupName) -&gt; [Info]</h2><p>Test case group information function (providing default data for a test case group, that is, its test cases and subgroups).</p><ul><li><span class="v">Info = {timetrap,Time} | {require,Required} | {require,Name,Required} | {userdata,UserData} | {silent_connections,Conns} | {stylesheet,CSSFile} | {ct_hooks, CTHs}</span></li><li><span class="v">Time = TimeVal | TimeFunc</span></li><li><span class="v">TimeVal = MilliSec | {seconds,integer()} | {minutes,integer()} | {hours,integer()}</span></li><li><span class="v">TimeFunc = {Mod,Func,Args} | Fun</span></li><li><span class="v">MilliSec = integer()</span></li><li><span class="v">Mod = atom()</span></li><li><span class="v">Func = atom()</span></li><li><span class="v">Args = list()</span></li><li><span class="v">Fun = fun()</span></li><li><span class="v">Required = Key | {Key,SubKeys} | {Key,Subkey} | {Key,Subkey,SubKeys}</span></li><li><span class="v">Key = atom()</span></li><li><span class="v">SubKeys = SubKey | [SubKey]</span></li><li><span class="v">SubKey = atom()</span></li><li><span class="v">Name = atom()</span></li><li><span class="v">UserData = term()</span></li><li><span class="v">Conns = [atom()]</span></li><li><span class="v">CSSFile = string()</span></li><li><span class="v">CTHs = [CTHModule |</span></li><li><span class="v">Â Â Â Â Â Â Â Â {CTHModule, CTHInitArgs} |</span></li><li><span class="v">Â Â Â Â Â Â Â Â {CTHModule, CTHInitArgs, CTHPriority}]</span></li><li><span class="v">CTHModule = atom()</span></li><li><span class="v">CTHInitArgs = term()</span></li></ul><p>OPTIONAL</p><p>The test case group information function. It is supposed to
return a list of tagged tuples that specify various properties
related to the execution of a test case group (that is, its test
cases and subgroups). Properties set by
<a href="#Module:group-1">Module:group-1</a> override
properties with the same key that have been set previously by
<a href="#Module:suite-0">Module:suite-0</a>.</p><p>Tag <strong>timetrap</strong> sets the maximum time that each
test case is allowed to execute (including
<a href="#Module:init_per_testcase-2">Module:init_per_testcase-2</a>
and
<a href="#Module:end_per_testcase-2">Module:end_per_testcase-2</a>).
If the timetrap time is
exceeded, the test case fails with reason
<strong>timetrap_timeout</strong>. A <strong>TimeFunc</strong> function can be used to
set a new timetrap by returning a <strong>TimeVal</strong>. It can also be
used to trigger a timetrap time-out by, at some point, returning a
value other than a <strong>TimeVal</strong>. For details, see section
<a href="./write_test_chapter#timetraps">Timetrap Time-Outs</a> in the User's Guide.</p><p>Tag <strong>require</strong> specifies configuration variables
required by test cases (or configuration functions)
in the suite. If the required configuration variables are not found
in any of the configuration files, all test cases in this group are
skipped. For details about the <strong>require</strong> functionality, see
function
<a href="./ct#require-1">ct#require-1</a>.</p><p>With <strong>userdata</strong>, the user can
specify any test case group related information that can be 
read by calling
<a href="./ct#userdata-2">ct#userdata-2</a>.</p><p>Tag <strong>ct_hooks</strong> specifies the
<a href="ct_hooks_chapter">Common Test Hooks</a>
to be run with this suite.</p><p>Other tuples than the ones defined are ignored.</p><p>For details about the test case group information function,
see section <a href="./write_test_chapter#group_info">Group Information Function</a> in the User's Guide.</p><h2>Module:init_per_group(GroupName, Config) -&gt; NewConfig |
	  {skip,Reason}</h2><p>Test case group initializations.</p><ul><li><span class="v">GroupName = atom()</span></li><li><span class="v">Config = NewConfig = [{Key,Value}]</span></li><li><span class="v">Key = atom()</span></li><li><span class="v">Value = term()</span></li><li><span class="v">Reason = term()</span></li></ul><p>OPTIONAL; if this function is defined, then <a href="#Module:end_per_group-2">Module:end_per_group-2</a>
must also be defined.</p><p>This configuration function is called before execution of a
test case group. It typically contains initializations that are 
common for all test cases and subgroups in the group, and that
must only be performed once. <strong>GroupName</strong> is the name of the
group, as specified in the group definition (see
<a href="#Module:groups-0">Module:groups-0</a>).
Parameter <strong>Config</strong> is the configuration data that can be
modified.
The return value of this function is given as <strong>Config</strong>
to all test cases and subgroups in the group.</p><p>If <strong>{skip,Reason}</strong>
is returned, all test cases in the group are skipped and
<strong>Reason</strong> is printed in the overview log for the group.</p><p>For information about test case groups, see section 
<a href="./write_test_chapter#test_case_groups">Test Case  Groups</a> in the User's Guide.</p><h2>Module:end_per_group(GroupName, Config) -&gt; term() |
	  {return_group_result,Status}</h2><p>Test case group finalization.</p><ul><li><span class="v">GroupName = atom()</span></li><li><span class="v">Config = [{Key,Value}]</span></li><li><span class="v">Key = atom()</span></li><li><span class="v">Value = term()</span></li><li><span class="v">Status = ok | skipped | failed</span></li></ul><p>OPTIONAL; if this function is defined, then <a href="#Module:init_per_group-2">Module:init_per_group-2</a>
must also be defined.</p><p>This function is called after the execution of a test case group
is finished. It is meant to be used for cleaning up after
<a href="#Module:init_per_group-2">Module:init_per_group-2</a>.
A status value for a nested subgroup can be returned with
<strong>{return_group_result,Status}</strong>. The status can be retrieved in
<a href="#Module:end_per_group-2">Module:end_per_group-2</a>
for the group on the level above. The status is also used by
<strong>Common Test</strong> for deciding if execution of a group is to
proceed if property <strong>sequence</strong> or <strong>repeat_until_*</strong>
is set.</p><p>For details about test case groups, see section 
<a href="./write_test_chapter#test_case_groups">Test Case Groups</a> in the User's Guide.</p><h2>Module:init_per_testcase(TestCase, Config) -&gt; NewConfig | {fail,Reason} | {skip,Reason}</h2><p>Test case initializations.</p><ul><li><span class="v"> TestCase = atom()</span></li><li><span class="v"> Config = NewConfig = [{Key,Value}]</span></li><li><span class="v"> Key = atom()</span></li><li><span class="v"> Value = term()</span></li><li><span class="v"> Reason = term()</span></li></ul><p>OPTIONAL; if this function is defined,
then <a href="#Module:end_per_testcase-2">Module:end_per_testcase-2</a> must also be
defined.</p><p>This function is called before each test case. Argument
<strong>TestCase</strong> is the test case name, and
<strong>Config</strong> (list of key-value tuples) is the configuration
data that can be modified. The <strong>NewConfig</strong> list returned
from this function is given as <strong>Config</strong> to the test case.
If <strong>{fail,Reason}</strong> is returned, the test case is
marked as failed without being executed.</p><p>If <strong>{skip,Reason}</strong> is returned, the test case is skipped
and <strong>Reason</strong> is printed in the overview log for the suite.</p><h2>Module:end_per_testcase(TestCase, Config) -&gt; term() | {fail,Reason} | {save_config,SaveConfig}</h2><p>Test case finalization.</p><ul><li><span class="v">TestCase = atom()</span></li><li><span class="v">Config = SaveConfig = [{Key,Value}]</span></li><li><span class="v">Key = atom()</span></li><li><span class="v">Value = term()</span></li><li><span class="v">Reason = term()</span></li></ul><p>OPTIONAL; if this function is defined,
then <a href="#Module:init_per_testcase-2">Module:init_per_testcase-2</a> must also be
defined.</p><p>This function is called after each test case, and can be used
to clean up after
<a href="#Module:init_per_testcase-2">Module:init_per_testcase-2</a>
and the test case. Any return value (besides <strong>{fail,Reason}</strong>
and <strong>{save_config,SaveConfig}</strong>) is ignored. By returning
<strong>{fail,Reason}</strong>, <strong>TestCase</strong> is marked as faulty (even
though it was successful in the sense that it returned
a value instead of terminating).</p><p>For information on <strong>save_config</strong>, see section
<a href="./dependencies_chapter#save_config">Saving Configuration Data</a> in the User's Guide.</p><h2>Module:Testcase() -&gt; [Info]</h2><p>Test case information function.</p><ul><li><span class="v">Info = {timetrap,Time} | {require,Required} | {require,Name,Required} | {userdata,UserData} | {silent_connections,Conns}</span></li><li><span class="v">Time = TimeVal | TimeFunc</span></li><li><span class="v">TimeVal = MilliSec | {seconds,integer()} | {minutes,integer()} | {hours,integer()}</span></li><li><span class="v">TimeFunc = {Mod,Func,Args} | Fun</span></li><li><span class="v">MilliSec = integer()</span></li><li><span class="v">Mod = atom()</span></li><li><span class="v">Func = atom()</span></li><li><span class="v">Args = list()</span></li><li><span class="v">Fun = fun()</span></li><li><span class="v">Required = Key | {Key,SubKeys} | {Key,Subkey} | {Key,Subkey,SubKeys}</span></li><li><span class="v">Key = atom()</span></li><li><span class="v">SubKeys = SubKey | [SubKey]</span></li><li><span class="v">SubKey = atom()</span></li><li><span class="v">Name = atom()</span></li><li><span class="v">UserData = term()</span></li><li><span class="v">Conns = [atom()]</span></li></ul><p>OPTIONAL</p><p>The test case information function. It is supposed to
return a list of tagged tuples that specify various properties
related to the execution of this particular test case.
Properties set by
<a href="#Module:Testcase-0">Module:Testcase-0</a>
override properties set previously for the test case by
<a href="#Module:group-1">Module:group-1</a> or
<a href="#Module:suite-0">Module:suite-0</a>.</p><p>Tag <strong>timetrap</strong> sets the maximum time that the
test case is allowed to execute. If the timetrap time is
exceeded, the test case fails with reason <strong>timetrap_timeout</strong>.
<a href="#Module:init_per_testcase-2">Module:init_per_testcase-2</a>
and
<a href="#Module:end_per_testcase-2">Module:end_per_testcase-2</a>
are included in the timetrap time.
A <strong>TimeFunc</strong> function can be used to
set a new timetrap by returning a <strong>TimeVal</strong>. It can also be
used to trigger a timetrap time-out by, at some point, returning a
value other than a <strong>TimeVal</strong>. For details, see section
<a href="./write_test_chapter#timetraps">Timetrap Time-Outs</a> in the User's Guide.</p><p>Tag <strong>require</strong> specifies configuration variables
that are required by the test case (or <strong>init_per_testcase/2</strong>
or <strong>end_per_testcase/2</strong>).
If the required configuration variables are not found in any of the
configuration files, the test case is skipped. For details about
the <strong>require</strong> functionality, see function
<a href="./ct#require-1">ct#require-1</a>.</p><p>If <strong>timetrap</strong> or <strong>require</strong> is not set, the
default values specified by
<a href="#Module:suite-0">Module:suite-0</a> (or
<a href="#Module:group-1">Module:group-1</a>) are used.</p><p>With <strong>userdata</strong>, the user can specify any test case-related
information that can be read by calling
<a href="./ct#userdata-3">ct#userdata-3</a>.</p><p>Other tuples than the ones defined are ignored.</p><p>For details about the test case information function, see section
<a href="./write_test_chapter#info_function">Test Case Information Function</a> in the User's Guide.</p><h2>Module:Testcase(Config) -&gt;  term() | {skip,Reason} | {comment,Comment} | {save_config,SaveConfig} | {skip_and_save,Reason,SaveConfig} | exit()</h2><p>A test case.</p><ul><li><span class="v">Config = SaveConfig = [{Key,Value}]</span></li><li><span class="v">Key = atom()</span></li><li><span class="v">Value = term()</span></li><li><span class="v">Reason = term()</span></li><li><span class="v">Comment = string()</span></li></ul><p>MANDATORY</p><p>The implementation of a test case. Call the functions to test and
check the result. If something fails, ensure the
function causes a runtime error or call
<a href="./ct#fail-1">ct#fail-1</a>
(which also causes the test case process to terminate).</p><p>Elements from the <strong>Config</strong> list can, for example, be read
with <strong>proplists:get_value/2</strong> in STDLIB
(or the macro <strong>?config</strong> defined in <strong>ct.hrl</strong>).</p><p>If you decide not to run the test case after all, return
<strong>{skip,Reason}</strong>. <strong>Reason</strong> is then
printed in field <strong>Comment</strong> on the HTML result page.</p><p>To print some information in field <strong>Comment</strong> on the HTML
result page, return <strong>{comment,Comment}</strong>.</p><p>If the function returns anything else, the test case is
considered successful. The return value always gets printed
in the test case log file.</p><p>For details about test case implementation, see section
<a href="./write_test_chapter#test_cases">Test Cases</a>
in the User's Guide.</p><p>For information on <strong>save_config</strong> and <strong>skip_and_save</strong>,
see section
<a href="./dependencies_chapter#save_config">Saving Configuration Data</a> in the User's Guide.</p></body></html>