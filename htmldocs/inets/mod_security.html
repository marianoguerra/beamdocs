<!doctype html>
<html><head><meta charset="utf-8"><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.0/css/bootstrap.min.css"></head><body style="margin: 4em 10%"><h1>mod_security</h1><h1>mod_security</h1><p>Security Audit and Trailing Functionality</p><p>Security Audit and Trailing Functionality</p><h1>Functions</h1><h2>block_user(User, Port, Dir, Seconds) -&gt; true | {error, Reason}</h2><h2>block_user(User, Address, Port, Dir, Seconds) -&gt; true | {error, Reason}</h2><p>Blocks a user from access to a directory for a certain amount of time.</p><ul><li><span class="v">User = string()</span></li><li><span class="v">Port = integer()</span></li><li><span class="v">Address = {A,B,C,D} | string() | undefined</span></li><li><span class="v">Dir = string()</span></li><li><span class="v">Seconds = integer() | infinity</span></li><li><span class="v">Reason = no_such_directory</span></li></ul><p><strong>block_user/4</strong> and <strong>block_user/5</strong> each blocks the user 
<strong>User</strong> from directory <strong>Dir</strong> for a specified 
amount of time.</p><h2>list_auth_users(Port) -&gt; Users | []</h2><h2>list_auth_users(Address, Port) -&gt; Users | []</h2><h2>list_auth_users(Port, Dir) -&gt; Users | []</h2><h2>list_auth_users(Address, Port, Dir) -&gt; Users | []</h2><p>Lists users that have authenticated within the <strong>SecurityAuthTimeout</strong>  time for a given address (if specified), port number, and directory  (if specified).</p><ul><li><span class="v">Port = integer()</span></li><li><span class="v">Address = {A,B,C,D} | string() | undefined</span></li><li><span class="v">Dir = string()</span></li><li><span class="v">Users = list() = [string()]</span></li></ul><p><strong>list_auth_users/1</strong>, <strong>list_auth_users/2</strong>, and 
<strong>list_auth_users/3</strong> each returns a list of users that are 
currently authenticated. Authentications are stored for
<strong>SecurityAuthTimeout</strong> seconds, and then discarded.</p><h2>list_blocked_users(Port) -&gt; Users | []</h2><h2>list_blocked_users(Address, Port) -&gt; Users | []</h2><h2>list_blocked_users(Port, Dir) -&gt; Users | []</h2><h2>list_blocked_users(Address, Port, Dir) -&gt; Users | []</h2><p>Lists users that are currently blocked from access to a  specified port number, for a given address (if specified).</p><ul><li><span class="v">Port = integer()</span></li><li><span class="v">Address = {A,B,C,D} | string() | undefined</span></li><li><span class="v">Dir = string()</span></li><li><span class="v">Users = list() = [string()]</span></li></ul><p><strong>list_blocked_users/1</strong>, <strong>list_blocked_users/2</strong>, and 
<strong>list_blocked_users/3</strong> each returns a list of users that are 
currently blocked from access.</p><h2>unblock_user(User, Port) -&gt; true | {error, Reason}</h2><h2>unblock_user(User, Address, Port) -&gt; true | {error, Reason}</h2><h2>unblock_user(User, Port, Dir) -&gt; true | {error, Reason}</h2><h2>unblock_user(User, Address, Port, Dir) -&gt; true | {error, Reason}</h2><p>Removes a blocked user from the block list.</p><ul><li><span class="v">User = string()</span></li><li><span class="v">Port = integer()</span></li><li><span class="v">Address = {A,B,C,D} | string() | undefined</span></li><li><span class="v">Dir = string()</span></li><li><span class="v">Reason = term()</span></li></ul><p><strong>unblock_user/2</strong>, <strong>unblock_user/3</strong>, and 
<strong>unblock_user/4</strong> each removes the user <strong>User</strong> from 
the list of blocked users for <strong>Port</strong> (and <strong>Dir</strong>).</p><a name="callback_module"></a><h2>SecurityCallbackModule</h2><p>The <strong>SecurityCallbackModule</strong> is a user-written module that can receive 
events from the <strong>mod_security</strong> Erlang web server API module. 
This module only exports the functions event/[4,5]
which are described here.
</p><h1>Functions</h1><h2>Module:event(What, Port, Dir, Data) -&gt; ignored</h2><h2>Module:event(What, Address, Port, Dir, Data) -&gt; ignored</h2><p>Called whenever an event occurs in <strong>mod_security</strong>.</p><ul><li><span class="v">What = atom()</span></li><li><span class="v">Port = integer()</span></li><li><span class="v">Address = {A,B,C,D} | string()</span></li><li><span class="v">Dir   = string()</span></li><li><span class="v">Data = [Info]</span></li><li><span class="v">Info = {Name, Value}</span></li></ul><a name="callback_module_event"></a><p><strong>event/4</strong> or <strong>event/5</strong> is called whenever an event 
occurs in the <strong>mod_security</strong> Erlang web server API module.
(<strong>event/4</strong> is called if <strong>Address</strong> is undefined, 
otherwise <strong>event/5</strong>. 
Argument <strong>What</strong> specifies the type of event that has 
occurred and is one of the following reasons:
</p><dl><dt><strong>auth_fail</strong></dt><dd><p>A failed user authentication.</p></dd><dt><strong>user_block</strong></dt><dd><p>A user is being blocked from access.</p></dd><dt><strong>user_unblock</strong></dt><dd><p>A user is being removed from the block list.</p></dd></dl><div class="alert alert-info"><h4 class="alert-heading">Note</h4><p>The event <strong>user_unblock</strong> is not triggered when 
a user is removed from the block list explicitly using the 
<strong>unblock_user</strong> function.</p></div></body></html>