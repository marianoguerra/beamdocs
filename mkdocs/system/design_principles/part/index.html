<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../../img/favicon.ico">
  <title>OTP Design Principles - Erlang OTP</title>
  <link rel="stylesheet" href="../../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "OTP Design Principles";
    var mkdocs_page_input_path = "system/design_principles/part.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../../.." class="icon icon-home"> Erlang OTP</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../../..">Erlang/OTP</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Asn1</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../asn1/asn1_getting_started/">Getting Started</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../asn1/asn1_introduction/">Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../asn1/asn1_overview/">ASN.1</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../asn1/asn1_spec/">Specialized Decodes</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../asn1/asn1ct/">asn1ct</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../asn1/notes/">asn1 Release Notes</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Common test</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../common_test/basics_chapter/">Common Test Basics</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../common_test/common_test_app/">Common Test</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../common_test/config_file_chapter/">External Configuration Data</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../common_test/cover_chapter/">Code Coverage Analysis</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../common_test/ct/">ct</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../common_test/ct_cover/">ct_cover</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../common_test/ct_ftp/">ct_ftp</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../common_test/ct_hooks/">Common Test Hooks</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../common_test/ct_hooks_chapter/">Common Test Hooks</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../common_test/ct_master/">ct_master</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../common_test/ct_master_chapter/">Using Common Test for Large-Scale Testing</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../common_test/ct_netconfc/">ct_netconfc</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../common_test/ct_property_test/">ct_property_test</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../common_test/ct_rpc/">ct_rpc</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../common_test/ct_run/">The ct_run program</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../common_test/ct_slave/">ct_slave</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../common_test/ct_snmp/">ct_snmp</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../common_test/ct_ssh/">ct_ssh</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../common_test/ct_telnet/">ct_telnet</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../common_test/ct_testspec/">ct_testspec</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../common_test/dependencies_chapter/">Dependencies between Test Cases and Suites</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../common_test/event_handler_chapter/">Event Handling</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../common_test/example_chapter/">Examples and Templates</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../common_test/getting_started_chapter/">Getting Started</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../common_test/install_chapter/">Installation</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../common_test/introduction/">Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../common_test/notes/">Common Test Release Notes</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../common_test/run_test_chapter/">Running Tests and Analyzing Results</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../common_test/test_structure_chapter/">Test Structure</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../common_test/unix_telnet/">unix_telnet</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../common_test/why_test_chapter/">Some Thoughts about Testing</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../common_test/write_test_chapter/">Writing Test Suites</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Compiler</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../compiler/cerl/">cerl</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../compiler/cerl_clauses/">cerl_clauses</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../compiler/cerl_trees/">cerl_trees</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../compiler/compile/">compile</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../compiler/internal/">Internal</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../compiler/notes/">Compiler Release Notes</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Crypto</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../crypto/algorithm_details/">Algorithm Details</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../crypto/crypto/">crypto</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../crypto/crypto_app/">crypto</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../crypto/engine_keys/">Engine Stored Keys</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../crypto/engine_load/">Engine Load</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../crypto/fips/">FIPS mode</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../crypto/licenses/">Licenses</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../crypto/new_api/">New and Old API</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../crypto/notes/">Crypto Release Notes</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../crypto/usersguide/">Crypto User's Guide</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Debugger</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../debugger/debugger/">debugger</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../debugger/debugger_chapter/">Debugger</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../debugger/i/">i</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../debugger/int/">int</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../debugger/introduction/">Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../debugger/notes/">Debugger Release Notes</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Dialyzer</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../dialyzer/dialyzer/">dialyzer</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../dialyzer/dialyzer_chapter/">Dialyzer</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../dialyzer/notes/">Dialyzer Release Notes</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../dialyzer/typer/">typer</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Diameter</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../diameter/diameter_examples/">Examples</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../diameter/diameter_using/">Usage</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../diameter/user_man/">Diameter Users Guide</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Edoc</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../edoc/edoc/">edoc</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../edoc/edoc_doclet/">edoc_doclet</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../edoc/edoc_extract/">edoc_extract</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../edoc/edoc_layout/">edoc_layout</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../edoc/edoc_lib/">edoc_lib</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../edoc/edoc_run/">edoc_run</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../edoc/notes/">EDoc Release Notes</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Eldap</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../eldap/eldap/">eldap</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../eldap/notes/">Eldap Release Notes</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../eldap/usersguide/">Eldap User's Guide</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Erl docgen</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../erl_docgen/block_tags/">Block Tags</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erl_docgen/character_entities/">Character Entities</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erl_docgen/doc-build/">How to Build OTP like documentation</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erl_docgen/erl_docgen_app/">erl_docgen</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erl_docgen/header_tags/">Header Tags</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erl_docgen/inline_tags/">Inline Tags</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erl_docgen/notes/">Erl_Docgen Release Notes</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erl_docgen/overview/">Overview OTP DTDs</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erl_docgen/refman_dtds/">Reference Manual DTDs</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erl_docgen/user_guide_dtds/">User's Guide DTDs</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Erl interface</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../erl_interface/ei/">ei</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erl_interface/ei_connect/">ei_connect</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erl_interface/ei_users_guide/">Erl_Interface User's Guide</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erl_interface/erl_call/">erl_call</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erl_interface/erl_connect/">erl_connect</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erl_interface/erl_error/">erl_error</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erl_interface/erl_eterm/">erl_eterm</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erl_interface/erl_format/">erl_format</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erl_interface/erl_global/">erl_global</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erl_interface/erl_malloc/">erl_malloc</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erl_interface/erl_marshal/">erl_marshal</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erl_interface/notes/">Erl_interface Release Notes</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erl_interface/registry/">registry</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Erts</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../erts/CarrierMigration/">Carrier Migration</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erts/CodeLoading/">Non-Blocking Code Loading</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erts/CountingInstructions/">Counting Instructions</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erts/DelayedDealloc/">Delayed Dealloc</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erts/GarbageCollection/">Erlang Garbage Collector</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erts/PTables/">Process and Port Tables</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erts/PortSignals/">Port Signals</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erts/ProcessManagementOptimizations/">Process Management Optimizations</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erts/SuperCarrier/">Super Carrier</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erts/ThreadProgress/">Thread Progress</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erts/Tracing/">Non-blocking trace setting</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erts/absform/">The Abstract Format</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erts/alt_disco/">How to Implement an Alternative Service Discovery for Erlang Distribution</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erts/alt_dist/">How to Implement an Alternative Carrier for the Erlang Distribution</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erts/atomics/">atomics</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erts/beam_makeops/">The beam_makeops script</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erts/communication/">Communication in Erlang</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erts/counters/">counters</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erts/crash_dump/">How to Interpret the Erlang Crash Dumps</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erts/driver/">How to Implement a Driver</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erts/driver_entry/">driver_entry</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erts/epmd/">epmd</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erts/erl/">erl</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erts/erl_dist_protocol/">Distribution Protocol</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erts/erl_driver/">erl_driver</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erts/erl_ext_dist/">External Term Format</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erts/erl_nif/">erl_nif</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erts/erl_prim_loader/">erl_prim_loader</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erts/erl_tracer/">erl_tracer</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erts/erlang/">erlang</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erts/erlc/">erlc</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erts/erlsrv/">erlsrv</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erts/erts_alloc/">erts_alloc</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erts/escript/">escript</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erts/inet_cfg/">Inet Configuration</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erts/init/">init</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erts/internal/">Internal</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erts/introduction/">Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erts/match_spec/">Match Specifications in Erlang</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erts/net/">net</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erts/notes/">ERTS Release Notes</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erts/persistent_term/">persistent_term</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erts/run_erl/">run_erl</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erts/socket/">socket</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erts/socket_usage/">Socket Usage</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erts/start/">start</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erts/start_erl/">start_erl</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erts/time_correction/">Time and Time Correction in Erlang</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erts/tty/">tty - A Command-Line Interface</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erts/werl/">werl</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../erts/zlib/">zlib</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Et</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../et/et/">et</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../et/et_collector/">et_collector</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../et/et_desc/">Description</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../et/et_examples/">Advanced examples</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../et/et_intro/">Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../et/et_selector/">et_selector</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../et/et_tutorial/">Tutorial</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../et/et_viewer/">et_viewer</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../et/notes/">Event Tracer (ET) Release Notes</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Eunit</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../eunit/eunit/">eunit</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../eunit/eunit_surefire/">eunit_surefire</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../eunit/notes/">EUnit Release Notes</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Ftp</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../ftp/ftp/">ftp</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../ftp/ftp_client/">FTP Client</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../ftp/introduction/">Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../ftp/notes/">FTP Release Notes</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Hipe</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../hipe/hipe_app/">HiPE</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../hipe/notes/">HiPE Release Notes</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Inets</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../inets/http_client/">HTTP Client</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../inets/http_server/">HTTP server</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../inets/http_uri/">http_uri</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../inets/httpc/">httpc</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../inets/httpd/">httpd</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../inets/httpd_custom_api/">httpd_custom_api</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../inets/httpd_socket/">httpd_socket</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../inets/httpd_util/">httpd_util</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../inets/inets/">inets</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../inets/inets_services/">Inets</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../inets/introduction/">Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../inets/mod_alias/">mod_alias</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../inets/mod_auth/">mod_auth</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../inets/mod_esi/">mod_esi</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../inets/mod_security/">mod_security</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../inets/notes/">Inets Release Notes</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Jinterface</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../jinterface/jinterface/">jinterface</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../jinterface/jinterface_users_guide/">The Jinterface Package</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../jinterface/notes/">Jinterface Release Notes</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Kernel</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../kernel/app/">app</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../kernel/application/">application</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../kernel/auth/">auth</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../kernel/code/">code</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../kernel/config/">config</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../kernel/disk_log/">disk_log</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../kernel/erl_boot_server/">erl_boot_server</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../kernel/erl_ddll/">erl_ddll</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../kernel/erl_epmd/">erl_epmd</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../kernel/erl_prim_loader_stub/">erl_prim_loader</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../kernel/erlang_stub/">erlang</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../kernel/error_handler/">error_handler</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../kernel/error_logger/">error_logger</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../kernel/file/">file</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../kernel/gen_sctp/">gen_sctp</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../kernel/gen_tcp/">gen_tcp</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../kernel/gen_udp/">gen_udp</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../kernel/global/">global</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../kernel/global_group/">global_group</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../kernel/heart/">heart</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../kernel/inet/">inet</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../kernel/inet_res/">inet_res</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../kernel/init_stub/">init</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../kernel/introduction_chapter/">Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../kernel/kernel_app/">kernel</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../kernel/logger/">logger</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../kernel/logger_chapter/">Logging</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../kernel/logger_disk_log_h/">logger_disk_log_h</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../kernel/logger_filters/">logger_filters</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../kernel/logger_formatter/">logger_formatter</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../kernel/logger_std_h/">logger_std_h</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../kernel/net_adm/">net_adm</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../kernel/net_kernel/">net_kernel</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../kernel/notes/">Kernel Release Notes</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../kernel/os/">os</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../kernel/pg2/">pg2</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../kernel/rpc/">rpc</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../kernel/seq_trace/">seq_trace</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../kernel/user/">user</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../kernel/wrap_log_reader/">wrap_log_reader</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../kernel/zlib_stub/">zlib</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Megaco</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../megaco/megaco/">megaco</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../megaco/megaco_architecture/">Architecture</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../megaco/megaco_codec_meas/">megaco_codec_meas</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../megaco/megaco_codec_mstone1/">megaco_codec_mstone1</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../megaco/megaco_codec_mstone2/">megaco_codec_mstone2</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../megaco/megaco_codec_transform/">megaco_codec_transform</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../megaco/megaco_debug/">Testing and tools</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../megaco/megaco_edist_compress/">megaco_encoder</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../megaco/megaco_encode/">Internal form and its encodings</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../megaco/megaco_encoder/">megaco_encoder</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../megaco/megaco_examples/">Implementation examples</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../megaco/megaco_flex_scanner/">megaco_flex_scanner</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../megaco/megaco_intro/">Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../megaco/megaco_mib/">Megaco mib</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../megaco/megaco_performance/">Performance comparison</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../megaco/megaco_run/">Running the stack</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../megaco/megaco_tcp/">megaco_tcp</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../megaco/megaco_transport/">megaco_transport</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../megaco/megaco_transport_mechanisms/">Transport mechanisms</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../megaco/megaco_udp/">megaco_udp</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../megaco/megaco_user/">megaco_user</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../megaco/notes/">Megaco Release Notes</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Mnesia</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../mnesia/Mnesia_App_A/">Appendix A: Backup Callback Interface</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../mnesia/Mnesia_App_B/">Appendix B: Activity Access Callback Interface</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../mnesia/Mnesia_App_C/">Appendix C: Fragmented Table Hashing Callback Interface</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../mnesia/Mnesia_chap1/">Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../mnesia/Mnesia_chap2/">Getting Started</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../mnesia/Mnesia_chap3/">Build a Mnesia Database</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../mnesia/Mnesia_chap4/">Transactions and Other Access Contexts</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../mnesia/Mnesia_chap5/">Miscellaneous Mnesia Features</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../mnesia/Mnesia_chap7/">Mnesia System Information</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../mnesia/Mnesia_chap8/">Combine Mnesia with SNMP</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../mnesia/Mnesia_overview/">Mnesia</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../mnesia/mnesia/">mnesia</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../mnesia/mnesia_frag_hash/">mnesia_frag_hash</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../mnesia/mnesia_registry/">mnesia_registry</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../mnesia/notes/">Mnesia Release Notes</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Observer</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../observer/cdv/">The cdv program</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../observer/crashdump/">crashdump_viewer</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../observer/crashdump_ug/">Crashdump Viewer</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../observer/etop/">etop</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../observer/etop_ug/">Erlang Top</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../observer/introduction_ug/">Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../observer/notes/">Observer Release Notes</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../observer/observer/">Observer</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../observer/observer_app/">Observer</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../observer/observer_ug/">Observer</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../observer/ttb/">ttb</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../observer/ttb_ug/">Trace Tool Builder</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Os mon</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../os_mon/cpu_sup/">cpu_sup</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../os_mon/disksup/">disksup</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../os_mon/memsup/">memsup</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../os_mon/notes/">OS_Mon Release Notes</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../os_mon/nteventlog/">nteventlog</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../os_mon/os_mon_app/">os_mon</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../os_mon/os_sup/">os_sup</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Parsetools</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../parsetools/leex/">leex</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../parsetools/notes/">Parsetools Release Notes</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../parsetools/yecc/">yecc</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Public key</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../public_key/introduction/">Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../public_key/notes/">public_key Release Notes</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../public_key/public_key/">public_key</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../public_key/public_key_app/">public_key</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../public_key/public_key_records/">Public-Key Records</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../public_key/using_public_key/">Getting Started</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Reltool</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../reltool/notes/">Reltool Release Notes</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../reltool/reltool/">reltool</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../reltool/reltool_examples/">Examples</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../reltool/reltool_intro/">Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../reltool/reltool_usage/">Usage</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Runtime tools</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../runtime_tools/DTRACE/">DTrace and Erlang/OTP</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../runtime_tools/LTTng/">LTTng and Erlang/OTP</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../runtime_tools/SYSTEMTAP/">SystemTap and Erlang/OTP</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../runtime_tools/dbg/">dbg</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../runtime_tools/dyntrace/">dyntrace</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../runtime_tools/erts_alloc_config/">erts_alloc_config</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../runtime_tools/msacc/">Microstate Accounting</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../runtime_tools/notes/">Runtime_Tools Release Notes</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../runtime_tools/runtime_tools_app/">runtime_tools</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../runtime_tools/scheduler/">Scheduler</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../runtime_tools/system_information/">System information</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Sasl</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../sasl/alarm_handler/">alarm_handler</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../sasl/appup/">appup</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../sasl/error_logging/">SASL Error Logging</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../sasl/notes/">SASL Release Notes</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../sasl/rb/">rb</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../sasl/rel/">rel</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../sasl/release_handler/">release_handler</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../sasl/relup/">relup</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../sasl/sasl_app/">sasl</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../sasl/sasl_intro/">Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../sasl/script/">script</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../sasl/systools/">systools</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Snmp</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../snmp/notes/">SNMP Release Notes</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmp/">snmp</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmp_advanced_agent/">Advanced Agent Topics</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmp_agent_config_files/">Definition of Agent Configuration Files</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmp_agent_funct_descr/">Agent Functional Description</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmp_agent_netif/">Definition of Agent Net if</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmp_app/">snmp</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmp_app_a/">SNMP Appendix A</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmp_app_b/">SNMP Appendix B</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmp_audit_trail_log/">Audit Trail Log</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmp_community_mib/">snmp_community_mib</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmp_config/">Running the application</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmp_def_instr_functions/">Definition of Instrumentation Functions</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmp_framework_mib/">snmp_framework_mib</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmp_generic/">snmp_generic</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmp_impl_example_agent/">Agent Implementation Example</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmp_impl_example_manager/">Manager Implementation Example</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmp_index/">snmp_index</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmp_instr_functions/">Instrumentation Functions</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmp_intro/">SNMP Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmp_manager_config_files/">Definition of Manager Configuration Files</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmp_manager_funct_descr/">Manager Functional Description</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmp_manager_netif/">Definition of Manager Net if</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmp_mib_compiler/">The MIB Compiler</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmp_notification_mib/">snmp_notification_mib</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmp_pdus/">snmp_pdus</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmp_standard_mib/">snmp_standard_mib</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmp_target_mib/">snmp_target_mib</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmp_user_based_sm_mib/">snmp_user_based_sm_mib</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmp_view_based_acm_mib/">snmp_view_based_acm_mib</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmpa/">snmpa</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmpa_conf/">snmpa_conf</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmpa_discovery_handler/">snmpa_discovery_handler</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmpa_error/">snmpa_error</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmpa_error_io/">snmpa_error_io</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmpa_error_logger/">snmpa_error_logger</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmpa_error_report/">snmpa_error_report</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmpa_local_db/">snmpa_local_db</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmpa_mib_data/">snmpa_mib_data</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmpa_mib_storage/">snmpa_mib_storage</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmpa_mpd/">snmpa_mpd</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmpa_network_interface/">snmpa_network_interface</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmpa_network_interface_filter/">snmpa_network_interface_filter</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmpa_notification_delivery_info_receiver/">snmpa_notification_delivery_info_receiver</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmpa_notification_filter/">snmpa_notification_filter</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmpa_supervisor/">snmpa_supervisor</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmpc/">snmpc</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmpc_cmd/">snmpc</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmpm/">snmpm</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmpm_conf/">snmpm_conf</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmpm_mpd/">snmpm_mpd</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmpm_network_interface/">snmpm_network_interface</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmpm_network_interface_filter/">snmpm_network_interface_filter</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../snmp/snmpm_user/">snmpm_user</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Ssh</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../ssh/configure_algos/">Configuring algorithms in SSH</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../ssh/introduction/">Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../ssh/notes/">SSH Release Notes</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../ssh/ssh/">ssh</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../ssh/ssh_app/">SSH</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../ssh/ssh_client_channel/">ssh_client_channel</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../ssh/ssh_client_key_api/">ssh_client_key_api</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../ssh/ssh_connection/">ssh_connection</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../ssh/ssh_file/">ssh_file</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../ssh/ssh_server_channel/">ssh_server_channel</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../ssh/ssh_server_key_api/">ssh_server_key_api</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../ssh/ssh_sftp/">ssh_sftp</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../ssh/ssh_sftpd/">ssh_sftpd</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../ssh/terminology/">Terminology</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../ssh/usersguide/">SSH User's Guide</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../ssh/using_ssh/">Getting Started</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Ssl</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../ssl/notes/">SSL Release Notes</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../ssl/refman/">SSL Reference Manual</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../ssl/ssl/">ssl</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../ssl/ssl_app/">ssl</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../ssl/ssl_crl_cache/">ssl_crl_cache</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../ssl/ssl_crl_cache_api/">ssl_crl_cache_api</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../ssl/ssl_distribution/">Using TLS for Erlang Distribution</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../ssl/ssl_introduction/">Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../ssl/ssl_protocol/">TLS/DTLS and TLS Predecessor, SSL</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../ssl/ssl_session_cache_api/">ssl</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../ssl/standards_compliance/">Standards Compliance</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../ssl/usersguide/">SSL User's Guide</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../ssl/using_ssl/">Using SSL application API</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Stdlib</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../stdlib/array/">array</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/assert_hrl/">assert.hrl</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/base64/">base64</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/beam_lib/">beam_lib</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/binary/">binary</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/c/">c</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/calendar/">calendar</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/dets/">dets</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/dict/">dict</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/digraph/">digraph</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/digraph_utils/">digraph_utils</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/epp/">epp</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/erl_anno/">erl_anno</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/erl_eval/">erl_eval</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/erl_expand_records/">erl_expand_records</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/erl_id_trans/">erl_id_trans</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/erl_internal/">erl_internal</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/erl_lint/">erl_lint</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/erl_parse/">erl_parse</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/erl_pp/">erl_pp</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/erl_scan/">erl_scan</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/erl_tar/">erl_tar</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/ets/">ets</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/file_sorter/">file_sorter</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/filelib/">filelib</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/filename/">filename</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/gb_sets/">gb_sets</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/gb_trees/">gb_trees</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/gen_event/">gen_event</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/gen_fsm/">gen_fsm</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/gen_server/">gen_server</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/gen_statem/">gen_statem</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/introduction/">Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/io/">io</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/io_lib/">io_lib</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/io_protocol/">The Erlang I/O Protocol</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/lists/">lists</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/log_mf_h/">log_mf_h</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/maps/">maps</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/math/">math</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/ms_transform/">ms_transform</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/notes/">STDLIB Release Notes</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/orddict/">orddict</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/ordsets/">ordsets</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/pool/">pool</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/proc_lib/">proc_lib</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/proplists/">proplists</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/qlc/">qlc</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/queue/">queue</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/rand/">rand</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/random/">random</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/re/">re</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/sets/">sets</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/shell/">shell</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/shell_default/">shell_default</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/slave/">slave</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/sofs/">sofs</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/stdlib_app/">STDLIB</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/string/">string</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/supervisor/">supervisor</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/supervisor_bridge/">supervisor_bridge</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/sys/">sys</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/timer/">timer</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/unicode/">unicode</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/unicode_usage/">Using Unicode in Erlang</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/uri_string/">uri_string</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/win32reg/">win32reg</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../stdlib/zip/">zip</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Syntax tools</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../syntax_tools/epp_dodger/">epp_dodger</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../syntax_tools/erl_comment_scan/">erl_comment_scan</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../syntax_tools/erl_prettypr/">erl_prettypr</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../syntax_tools/erl_recomment/">erl_recomment</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../syntax_tools/erl_syntax/">erl_syntax</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../syntax_tools/erl_syntax_lib/">erl_syntax_lib</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../syntax_tools/erl_tidy/">erl_tidy</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../syntax_tools/igor/">igor</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../syntax_tools/merl/">merl</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../syntax_tools/merl_transform/">merl_transform</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../syntax_tools/notes/">Syntax_Tools Release Notes</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../syntax_tools/prettypr/">prettypr</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">System</span>
    <ul class="subnav">
                <li class=" current">
                    
    <span class="caption-text">Design principles</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../applications/">Applications</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../appup_cookbook/">Appup Cookbook</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../book/">OTP Design Principles</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../des_princ/">Overview</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../distributed_applications/">Distributed Applications</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../events/">gen_event Behaviour</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../gen_server_concepts/">gen_server Behaviour</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../included_applications/">Included Applications</a>
                </li>
                <li class="toctree-l3 current">
                    
    <a class="current" href="./">OTP Design Principles</a>
    <ul class="subnav">
            
    <li class="toctree-l4"><a href="#otp-design-principles">OTP Design Principles</a></li>
    
        <ul>
        
            <li><a class="toctree-l5" href="#supervision-trees">Supervision Trees</a></li>
        
            <li><a class="toctree-l5" href="#behaviours">Behaviours</a></li>
        
            <li><a class="toctree-l5" href="#applications">Applications</a></li>
        
            <li><a class="toctree-l5" href="#releases">Releases</a></li>
        
            <li><a class="toctree-l5" href="#release-handling">Release Handling</a></li>
        
            <li><a class="toctree-l5" href="#client-server-principles">Client-Server Principles</a></li>
        
            <li><a class="toctree-l5" href="#example">Example</a></li>
        
            <li><a class="toctree-l5" href="#starting-a-gen_server">Starting a Gen_Server</a></li>
        
            <li><a class="toctree-l5" href="#synchronous-requests-call">Synchronous Requests - Call</a></li>
        
            <li><a class="toctree-l5" href="#asynchronous-requests-cast">Asynchronous Requests - Cast</a></li>
        
            <li><a class="toctree-l5" href="#stopping">Stopping</a></li>
        
            <li><a class="toctree-l5" href="#in-a-supervision-tree">In a Supervision Tree</a></li>
        
            <li><a class="toctree-l5" href="#standalone-gen_servers">Standalone Gen_Servers</a></li>
        
            <li><a class="toctree-l5" href="#handling-other-messages">Handling Other Messages</a></li>
        
            <li><a class="toctree-l5" href="#event-driven-state-machines">Event-Driven State Machines</a></li>
        
            <li><a class="toctree-l5" href="#when-to-use-gen_statem">When to use gen_statem</a></li>
        
            <li><a class="toctree-l5" href="#callback-module">Callback Module</a></li>
        
            <li><a class="toctree-l5" href="#callback-modes">Callback Modes</a></li>
        
            <li><a class="toctree-l5" href="#choosing-the-callback-mode">Choosing the Callback Mode</a></li>
        
            <li><a class="toctree-l5" href="#state-callback">State Callback</a></li>
        
            <li><a class="toctree-l5" href="#the-first-state">The First State</a></li>
        
            <li><a class="toctree-l5" href="#transition-actions">Transition Actions</a></li>
        
            <li><a class="toctree-l5" href="#event-types">Event Types</a></li>
        
            <li><a class="toctree-l5" href="#state-enter-calls">State Enter Calls</a></li>
        
            <li><a class="toctree-l5" href="#time-outs">Time-outs</a></li>
        
            <li><a class="toctree-l5" href="#cancelling-a-time-out">Cancelling a Time-Out</a></li>
        
            <li><a class="toctree-l5" href="#time-out-zero">Time-Out Zero</a></li>
        
            <li><a class="toctree-l5" href="#example_1">Example</a></li>
        
            <li><a class="toctree-l5" href="#starting-gen_statem">Starting gen_statem</a></li>
        
            <li><a class="toctree-l5" href="#handling-events">Handling Events</a></li>
        
            <li><a class="toctree-l5" href="#state-time-outs">State Time-Outs</a></li>
        
            <li><a class="toctree-l5" href="#all-state-events">All State Events</a></li>
        
            <li><a class="toctree-l5" href="#one-state-callback">One State Callback</a></li>
        
            <li><a class="toctree-l5" href="#stopping_1">Stopping</a></li>
        
            <li><a class="toctree-l5" href="#in-a-supervision-tree_1">In a Supervision Tree</a></li>
        
            <li><a class="toctree-l5" href="#standalone-gen_statem">Standalone gen_statem</a></li>
        
            <li><a class="toctree-l5" href="#event-time-outs">Event Time-Outs</a></li>
        
            <li><a class="toctree-l5" href="#generic-time-outs">Generic Time-Outs</a></li>
        
            <li><a class="toctree-l5" href="#erlang-timers">Erlang Timers</a></li>
        
            <li><a class="toctree-l5" href="#postponing-events">Postponing Events</a></li>
        
            <li><a class="toctree-l5" href="#fuzzy-state-diagrams">Fuzzy State Diagrams</a></li>
        
            <li><a class="toctree-l5" href="#selective-receive">Selective Receive</a></li>
        
            <li><a class="toctree-l5" href="#state-enter-actions">State Enter Actions</a></li>
        
            <li><a class="toctree-l5" href="#inserted-events">Inserted Events</a></li>
        
            <li><a class="toctree-l5" href="#example-revisited">Example Revisited</a></li>
        
            <li><a class="toctree-l5" href="#callback-mode-state_functions">Callback Mode: state_functions</a></li>
        
            <li><a class="toctree-l5" href="#callback-mode-handle_event_function">Callback Mode: handle_event_function</a></li>
        
            <li><a class="toctree-l5" href="#filter-the-state">Filter the State</a></li>
        
            <li><a class="toctree-l5" href="#complex-state">Complex State</a></li>
        
            <li><a class="toctree-l5" href="#hibernation">Hibernation</a></li>
        
            <li><a class="toctree-l5" href="#event-handling-principles">Event Handling Principles</a></li>
        
            <li><a class="toctree-l5" href="#example_2">Example</a></li>
        
            <li><a class="toctree-l5" href="#starting-an-event-manager">Starting an Event Manager</a></li>
        
            <li><a class="toctree-l5" href="#adding-an-event-handler">Adding an Event Handler</a></li>
        
            <li><a class="toctree-l5" href="#notifying-about-events">Notifying about Events</a></li>
        
            <li><a class="toctree-l5" href="#deleting-an-event-handler">Deleting an Event Handler</a></li>
        
            <li><a class="toctree-l5" href="#stopping_2">Stopping</a></li>
        
            <li><a class="toctree-l5" href="#in-a-supervision-tree_2">In a Supervision Tree</a></li>
        
            <li><a class="toctree-l5" href="#standalone-event-managers">Standalone Event Managers</a></li>
        
            <li><a class="toctree-l5" href="#handling-other-messages_1">Handling Other Messages</a></li>
        
            <li><a class="toctree-l5" href="#supervision-principles">Supervision Principles</a></li>
        
            <li><a class="toctree-l5" href="#example_3">Example</a></li>
        
            <li><a class="toctree-l5" href="#supervisor-flags">Supervisor Flags</a></li>
        
            <li><a class="toctree-l5" href="#restart-strategy">Restart Strategy</a></li>
        
            <li><a class="toctree-l5" href="#one_for_one">one_for_one</a></li>
        
            <li><a class="toctree-l5" href="#one_for_all">one_for_all</a></li>
        
            <li><a class="toctree-l5" href="#rest_for_one">rest_for_one</a></li>
        
            <li><a class="toctree-l5" href="#simple_one_for_one">simple_one_for_one</a></li>
        
            <li><a class="toctree-l5" href="#maximum-restart-intensity">Maximum Restart Intensity</a></li>
        
            <li><a class="toctree-l5" href="#tuning-the-intensity-and-period">Tuning the intensity and period</a></li>
        
            <li><a class="toctree-l5" href="#child-specification">Child Specification</a></li>
        
            <li><a class="toctree-l5" href="#starting-a-supervisor">Starting a Supervisor</a></li>
        
            <li><a class="toctree-l5" href="#adding-a-child-process">Adding a Child Process</a></li>
        
            <li><a class="toctree-l5" href="#stopping-a-child-process">Stopping a Child Process</a></li>
        
            <li><a class="toctree-l5" href="#simplified-one_for_one-supervisors">Simplified one_for_one Supervisors</a></li>
        
            <li><a class="toctree-l5" href="#stopping_3">Stopping</a></li>
        
            <li><a class="toctree-l5" href="#simple-debugging">Simple Debugging</a></li>
        
            <li><a class="toctree-l5" href="#special-processes">Special Processes</a></li>
        
            <li><a class="toctree-l5" href="#example_4">Example</a></li>
        
            <li><a class="toctree-l5" href="#starting-the-process">Starting the Process</a></li>
        
            <li><a class="toctree-l5" href="#debugging">Debugging</a></li>
        
            <li><a class="toctree-l5" href="#handling-system-messages">Handling System Messages</a></li>
        
            <li><a class="toctree-l5" href="#user-defined-behaviours">User-Defined Behaviours</a></li>
        
            <li><a class="toctree-l5" href="#application-concept">Application Concept</a></li>
        
            <li><a class="toctree-l5" href="#application-callback-module">Application Callback Module</a></li>
        
            <li><a class="toctree-l5" href="#application-resource-file">Application Resource File</a></li>
        
            <li><a class="toctree-l5" href="#directory-structure">Directory Structure</a></li>
        
            <li><a class="toctree-l5" href="#directory-structure-guidelines-for-a-development-environment">Directory Structure Guidelines for a Development Environment</a></li>
        
            <li><a class="toctree-l5" href="#directory-structure-for-a-released-system">Directory Structure for a Released System</a></li>
        
            <li><a class="toctree-l5" href="#application-controller">Application Controller</a></li>
        
            <li><a class="toctree-l5" href="#loading-and-unloading-applications">Loading and Unloading Applications</a></li>
        
            <li><a class="toctree-l5" href="#starting-and-stopping-applications">Starting and Stopping Applications</a></li>
        
            <li><a class="toctree-l5" href="#configuring-an-application">Configuring an Application</a></li>
        
            <li><a class="toctree-l5" href="#application-start-types">Application Start Types</a></li>
        
            <li><a class="toctree-l5" href="#introduction">Introduction</a></li>
        
            <li><a class="toctree-l5" href="#specifying-included-applications">Specifying Included Applications</a></li>
        
            <li><a class="toctree-l5" href="#synchronizing-processes-during-startup">Synchronizing Processes during Startup</a></li>
        
            <li><a class="toctree-l5" href="#introduction_1">Introduction</a></li>
        
            <li><a class="toctree-l5" href="#specifying-distributed-applications">Specifying Distributed Applications</a></li>
        
            <li><a class="toctree-l5" href="#starting-and-stopping-distributed-applications">Starting and Stopping Distributed Applications</a></li>
        
            <li><a class="toctree-l5" href="#failover">Failover</a></li>
        
            <li><a class="toctree-l5" href="#takeover">Takeover</a></li>
        
            <li><a class="toctree-l5" href="#release-concept">Release Concept</a></li>
        
            <li><a class="toctree-l5" href="#release-resource-file">Release Resource File</a></li>
        
            <li><a class="toctree-l5" href="#generating-boot-scripts">Generating Boot Scripts</a></li>
        
            <li><a class="toctree-l5" href="#creating-a-release-package">Creating a Release Package</a></li>
        
            <li><a class="toctree-l5" href="#directory-structure_1">Directory Structure</a></li>
        
            <li><a class="toctree-l5" href="#disk-less-andor-read-only-clients">Disk-Less and/or Read-Only Clients</a></li>
        
            <li><a class="toctree-l5" href="#release-handling-principles">Release Handling Principles</a></li>
        
            <li><a class="toctree-l5" href="#release-handling-workflow">Release Handling Workflow</a></li>
        
            <li><a class="toctree-l5" href="#release-handling-aspects">Release Handling Aspects</a></li>
        
            <li><a class="toctree-l5" href="#requirements">Requirements</a></li>
        
            <li><a class="toctree-l5" href="#distributed-systems">Distributed Systems</a></li>
        
            <li><a class="toctree-l5" href="#release-handling-instructions">Release Handling Instructions</a></li>
        
            <li><a class="toctree-l5" href="#load_module">load_module</a></li>
        
            <li><a class="toctree-l5" href="#update">update</a></li>
        
            <li><a class="toctree-l5" href="#add_module-and-delete_module">add_module and delete_module</a></li>
        
            <li><a class="toctree-l5" href="#application-instructions">Application Instructions</a></li>
        
            <li><a class="toctree-l5" href="#apply-low-level">apply (Low-Level)</a></li>
        
            <li><a class="toctree-l5" href="#restart_new_emulator-low-level">restart_new_emulator (Low-Level)</a></li>
        
            <li><a class="toctree-l5" href="#restart_emulator-low-level">restart_emulator (Low-Level)</a></li>
        
            <li><a class="toctree-l5" href="#application-upgrade-file">Application Upgrade File</a></li>
        
            <li><a class="toctree-l5" href="#release-upgrade-file">Release Upgrade File</a></li>
        
            <li><a class="toctree-l5" href="#installing-a-release">Installing a Release</a></li>
        
            <li><a class="toctree-l5" href="#example-continued-from-the-previous-sections">Example (continued from the previous sections)</a></li>
        
            <li><a class="toctree-l5" href="#updating-application-specifications">Updating Application Specifications</a></li>
        
            <li><a class="toctree-l5" href="#changing-a-functional-module">Changing a Functional Module</a></li>
        
            <li><a class="toctree-l5" href="#changing-a-residence-module">Changing a Residence Module</a></li>
        
            <li><a class="toctree-l5" href="#changing-a-callback-module">Changing a Callback Module</a></li>
        
            <li><a class="toctree-l5" href="#changing-internal-state">Changing Internal State</a></li>
        
            <li><a class="toctree-l5" href="#module-dependencies">Module Dependencies</a></li>
        
            <li><a class="toctree-l5" href="#changing-code-for-a-special-process">Changing Code for a Special Process</a></li>
        
            <li><a class="toctree-l5" href="#changing-a-supervisor">Changing a Supervisor</a></li>
        
            <li><a class="toctree-l5" href="#changing-properties">Changing Properties</a></li>
        
            <li><a class="toctree-l5" href="#changing-child-specifications">Changing Child Specifications</a></li>
        
            <li><a class="toctree-l5" href="#adding-and-deleting-child-processes">Adding and Deleting Child Processes</a></li>
        
            <li><a class="toctree-l5" href="#adding-or-deleting-a-module">Adding or Deleting a Module</a></li>
        
            <li><a class="toctree-l5" href="#starting-or-terminating-a-process">Starting or Terminating a Process</a></li>
        
            <li><a class="toctree-l5" href="#adding-or-removing-an-application">Adding or Removing an Application</a></li>
        
            <li><a class="toctree-l5" href="#restarting-an-application">Restarting an Application</a></li>
        
            <li><a class="toctree-l5" href="#changing-an-application-specification">Changing an Application Specification</a></li>
        
            <li><a class="toctree-l5" href="#changing-application-configuration">Changing Application Configuration</a></li>
        
            <li><a class="toctree-l5" href="#changing-included-applications">Changing Included Applications</a></li>
        
            <li><a class="toctree-l5" href="#application-restart">Application Restart</a></li>
        
            <li><a class="toctree-l5" href="#supervisor-change">Supervisor Change</a></li>
        
            <li><a class="toctree-l5" href="#changing-non-erlang-code">Changing Non-Erlang Code</a></li>
        
            <li><a class="toctree-l5" href="#emulator-restart-and-upgrade">Emulator Restart and Upgrade</a></li>
        
            <li><a class="toctree-l5" href="#emulator-upgrade-from-pre-otp-r15">Emulator Upgrade From Pre OTP R15</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../release_handling/">Release Handling</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../release_structure/">Releases</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../spec_proc/">sys and proc_lib</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../statem/">gen_statem Behavior</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../sup_princ/">Supervisor Behaviour</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Efficiency guide</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../efficiency_guide/advanced/">Advanced</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../efficiency_guide/binaryhandling/">Constructing and Matching Binaries</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../efficiency_guide/book/">Efficiency Guide</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../efficiency_guide/commoncaveats/">Common Caveats</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../efficiency_guide/drivers/">Drivers</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../efficiency_guide/functions/">Functions</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../efficiency_guide/introduction/">Introduction</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../efficiency_guide/listhandling/">List Handling</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../efficiency_guide/myths/">The Seven Myths of Erlang Performance</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../efficiency_guide/part/">Efficiency Guide</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../efficiency_guide/processes/">Processes</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../efficiency_guide/profiling/">Profiling</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../efficiency_guide/retired_myths/">Retired Myths</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../efficiency_guide/tablesDatabases/">Tables and Databases</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Embedded</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../embedded/book/">Embedded Systems</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../embedded/embedded_nt/">Windows NT</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../embedded/embedded_solaris/">Embedded Solaris</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../embedded/part/">Embedded Systems User's Guide</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">General info</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../general_info/book/">General Information</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../general_info/deprecations/">Deprecations</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../general_info/part/">General Information</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../general_info/scheduled_for_removal/">Scheduled for Removal</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Getting started</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../getting_started/book/">Getting Started with Erlang</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../getting_started/conc_prog/">Concurrent Programming</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../getting_started/intro/">Introduction</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../getting_started/part/">Getting Started With Erlang</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../getting_started/records_macros/">Records and Macros</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../getting_started/robustness/">Robustness</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../getting_started/seq_prog/">Sequential Programming</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Installation guide</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../installation_guide/INSTALL-CROSS/">Cross Compiling Erlang/OTP</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../installation_guide/INSTALL-WIN32/">How to Build Erlang/OTP on Windows</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../installation_guide/INSTALL/">Building and Installing Erlang/OTP</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../installation_guide/OTP-PATCH-APPLY/">Patching OTP Applications</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../installation_guide/book/">Installation Guide</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../installation_guide/install-binary/">Installing the Binary Release</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../installation_guide/part/">Installation Guide</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Oam</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../oam/book/">OAM Principles</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../oam/oam_intro/">Introduction</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../oam/part/">OAM Principles</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Programming examples</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../programming_examples/bit_syntax/">Bit Syntax</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../programming_examples/book/">Programming Examples</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../programming_examples/funs/">Funs</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../programming_examples/list_comprehensions/">List Comprehensions</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../programming_examples/part/">Programming Examples</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../programming_examples/records/">Records</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Reference manual</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../reference_manual/book/">Erlang Reference Manual</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../reference_manual/character_set/">Character Set and Source File Encoding</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../reference_manual/code_loading/">Compilation and Code Loading</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../reference_manual/data_types/">Data Types</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../reference_manual/distributed/">Distributed Erlang</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../reference_manual/errors/">Errors and Error Handling</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../reference_manual/expressions/">Expressions</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../reference_manual/functions/">Functions</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../reference_manual/introduction/">Introduction</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../reference_manual/macros/">Preprocessor</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../reference_manual/modules/">Modules</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../reference_manual/part/">Erlang Reference Manual</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../reference_manual/patterns/">Pattern Matching</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../reference_manual/ports/">Ports and Port Drivers</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../reference_manual/processes/">Processes</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../reference_manual/records/">Records</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../reference_manual/typespec/">Types and Function Specifications</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">System architecture intro</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../system_architecture_intro/book/">System Architecture</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../system_architecture_intro/part/">Introduction to the System Architecture</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../system_architecture_intro/sys_arch_intro/">Introduction</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">System principles</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../system_principles/book/">System Principles</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../system_principles/create_target/">Creating and Upgrading a Target System</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../system_principles/error_logging/">Error Logging</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../system_principles/misc/">Support, Compatibility, Deprecations, and Removal</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../system_principles/part/">System Principles</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../system_principles/system_principles/">System Principles</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../system_principles/upgrade/">Upgrade when Erlang/OTP has Changed</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../system_principles/versions/">Versions</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Tutorial</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../tutorial/book/">Interoperability Tutorial</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../tutorial/c_port/">Ports</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../tutorial/c_portdriver/">Port Drivers</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../tutorial/cnode/">C Nodes</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../tutorial/erl_interface/">Erl_Interface</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../tutorial/example/">Problem Example</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../tutorial/introduction/">Introduction</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../tutorial/nif/">NIFs</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../tutorial/overview/">Overview</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../tutorial/part/">Interoperability Tutorial</a>
                </li>
    </ul>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Tftp</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../tftp/getting_started/">Getting Started</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../tftp/introduction/">Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../tftp/notes/">TFTP Release Notes</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../tftp/tftp/">tftp</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../tftp/usersguide/">TFTP User's Guide</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Tools</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../tools/cover/">cover</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../tools/cover_chapter/">cover</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../tools/cprof/">cprof</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../tools/cprof_chapter/">cprof - The Call Count Profiler</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../tools/eprof/">eprof</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../tools/erlang_mode/">Erlang mode for Emacs</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../tools/erlang_mode_chapter/">The Erlang mode for Emacs</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../tools/fprof/">fprof</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../tools/fprof_chapter/">fprof - The File Trace Profiler</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../tools/instrument/">instrument</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../tools/lcnt/">lcnt</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../tools/lcnt_chapter/">lcnt - The Lock Profiler</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../tools/make/">make</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../tools/notes/">Tools Release Notes</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../tools/tags/">tags</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../tools/xref/">xref</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../tools/xref_chapter/">Xref - The Cross Reference Tool</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Wx</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../wx/glu/">glu</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/notes/">wxErlang Release Notes</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wx/">wx</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxAcceleratorEntry/">wxAcceleratorEntry</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxAcceleratorTable/">wxAcceleratorTable</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxActivateEvent/">wxActivateEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxArtProvider/">wxArtProvider</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxAuiDockArt/">wxAuiDockArt</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxAuiManager/">wxAuiManager</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxAuiManagerEvent/">wxAuiManagerEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxAuiNotebook/">wxAuiNotebook</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxAuiNotebookEvent/">wxAuiNotebookEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxAuiPaneInfo/">wxAuiPaneInfo</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxAuiSimpleTabArt/">wxAuiSimpleTabArt</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxAuiTabArt/">wxAuiTabArt</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxBitmap/">wxBitmap</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxBitmapButton/">wxBitmapButton</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxBitmapDataObject/">wxBitmapDataObject</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxBoxSizer/">wxBoxSizer</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxBrush/">wxBrush</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxBufferedDC/">wxBufferedDC</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxBufferedPaintDC/">wxBufferedPaintDC</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxButton/">wxButton</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxCalendarCtrl/">wxCalendarCtrl</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxCalendarDateAttr/">wxCalendarDateAttr</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxCalendarEvent/">wxCalendarEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxCaret/">wxCaret</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxCheckBox/">wxCheckBox</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxCheckListBox/">wxCheckListBox</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxChildFocusEvent/">wxChildFocusEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxChoice/">wxChoice</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxChoicebook/">wxChoicebook</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxClientDC/">wxClientDC</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxClipboard/">wxClipboard</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxClipboardTextEvent/">wxClipboardTextEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxCloseEvent/">wxCloseEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxColourData/">wxColourData</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxColourDialog/">wxColourDialog</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxColourPickerCtrl/">wxColourPickerCtrl</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxColourPickerEvent/">wxColourPickerEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxComboBox/">wxComboBox</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxCommandEvent/">wxCommandEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxContextMenuEvent/">wxContextMenuEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxControl/">wxControl</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxControlWithItems/">wxControlWithItems</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxCursor/">wxCursor</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxDC/">wxDC</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxDCOverlay/">wxDCOverlay</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxDataObject/">wxDataObject</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxDateEvent/">wxDateEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxDatePickerCtrl/">wxDatePickerCtrl</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxDialog/">wxDialog</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxDirDialog/">wxDirDialog</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxDirPickerCtrl/">wxDirPickerCtrl</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxDisplay/">wxDisplay</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxDisplayChangedEvent/">wxDisplayChangedEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxDropFilesEvent/">wxDropFilesEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxEraseEvent/">wxEraseEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxEvent/">wxEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxEvtHandler/">wxEvtHandler</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxFileDataObject/">wxFileDataObject</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxFileDialog/">wxFileDialog</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxFileDirPickerEvent/">wxFileDirPickerEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxFilePickerCtrl/">wxFilePickerCtrl</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxFindReplaceData/">wxFindReplaceData</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxFindReplaceDialog/">wxFindReplaceDialog</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxFlexGridSizer/">wxFlexGridSizer</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxFocusEvent/">wxFocusEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxFont/">wxFont</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxFontData/">wxFontData</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxFontDialog/">wxFontDialog</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxFontPickerCtrl/">wxFontPickerCtrl</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxFontPickerEvent/">wxFontPickerEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxFrame/">wxFrame</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxGBSizerItem/">wxGBSizerItem</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxGCDC/">wxGCDC</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxGLCanvas/">wxGLCanvas</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxGauge/">wxGauge</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxGenericDirCtrl/">wxGenericDirCtrl</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxGraphicsBrush/">wxGraphicsBrush</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxGraphicsContext/">wxGraphicsContext</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxGraphicsFont/">wxGraphicsFont</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxGraphicsMatrix/">wxGraphicsMatrix</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxGraphicsObject/">wxGraphicsObject</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxGraphicsPath/">wxGraphicsPath</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxGraphicsPen/">wxGraphicsPen</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxGraphicsRenderer/">wxGraphicsRenderer</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxGrid/">wxGrid</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxGridBagSizer/">wxGridBagSizer</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxGridCellAttr/">wxGridCellAttr</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxGridCellBoolEditor/">wxGridCellBoolEditor</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxGridCellBoolRenderer/">wxGridCellBoolRenderer</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxGridCellChoiceEditor/">wxGridCellChoiceEditor</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxGridCellEditor/">wxGridCellEditor</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxGridCellFloatEditor/">wxGridCellFloatEditor</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxGridCellFloatRenderer/">wxGridCellFloatRenderer</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxGridCellNumberEditor/">wxGridCellNumberEditor</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxGridCellNumberRenderer/">wxGridCellNumberRenderer</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxGridCellRenderer/">wxGridCellRenderer</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxGridCellStringRenderer/">wxGridCellStringRenderer</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxGridCellTextEditor/">wxGridCellTextEditor</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxGridEvent/">wxGridEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxGridSizer/">wxGridSizer</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxHelpEvent/">wxHelpEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxHtmlEasyPrinting/">wxHtmlEasyPrinting</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxHtmlLinkEvent/">wxHtmlLinkEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxHtmlWindow/">wxHtmlWindow</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxIcon/">wxIcon</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxIconBundle/">wxIconBundle</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxIconizeEvent/">wxIconizeEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxIdleEvent/">wxIdleEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxImage/">wxImage</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxImageList/">wxImageList</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxInitDialogEvent/">wxInitDialogEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxJoystickEvent/">wxJoystickEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxKeyEvent/">wxKeyEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxLayoutAlgorithm/">wxLayoutAlgorithm</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxListBox/">wxListBox</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxListCtrl/">wxListCtrl</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxListEvent/">wxListEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxListItem/">wxListItem</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxListItemAttr/">wxListItemAttr</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxListView/">wxListView</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxListbook/">wxListbook</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxLocale/">wxLocale</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxLogNull/">wxLogNull</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxMDIChildFrame/">wxMDIChildFrame</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxMDIClientWindow/">wxMDIClientWindow</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxMDIParentFrame/">wxMDIParentFrame</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxMask/">wxMask</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxMaximizeEvent/">wxMaximizeEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxMemoryDC/">wxMemoryDC</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxMenu/">wxMenu</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxMenuBar/">wxMenuBar</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxMenuEvent/">wxMenuEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxMenuItem/">wxMenuItem</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxMessageDialog/">wxMessageDialog</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxMiniFrame/">wxMiniFrame</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxMirrorDC/">wxMirrorDC</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxMouseCaptureChangedEvent/">wxMouseCaptureChangedEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxMouseCaptureLostEvent/">wxMouseCaptureLostEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxMouseEvent/">wxMouseEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxMoveEvent/">wxMoveEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxMultiChoiceDialog/">wxMultiChoiceDialog</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxNavigationKeyEvent/">wxNavigationKeyEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxNotebook/">wxNotebook</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxNotebookEvent/">wxNotebookEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxNotifyEvent/">wxNotifyEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxOverlay/">wxOverlay</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxPageSetupDialog/">wxPageSetupDialog</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxPageSetupDialogData/">wxPageSetupDialogData</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxPaintDC/">wxPaintDC</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxPaintEvent/">wxPaintEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxPalette/">wxPalette</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxPaletteChangedEvent/">wxPaletteChangedEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxPanel/">wxPanel</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxPasswordEntryDialog/">wxPasswordEntryDialog</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxPen/">wxPen</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxPickerBase/">wxPickerBase</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxPopupTransientWindow/">wxPopupTransientWindow</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxPopupWindow/">wxPopupWindow</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxPostScriptDC/">wxPostScriptDC</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxPreviewCanvas/">wxPreviewCanvas</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxPreviewControlBar/">wxPreviewControlBar</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxPreviewFrame/">wxPreviewFrame</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxPrintData/">wxPrintData</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxPrintDialog/">wxPrintDialog</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxPrintDialogData/">wxPrintDialogData</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxPrintPreview/">wxPrintPreview</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxPrinter/">wxPrinter</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxPrintout/">wxPrintout</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxProgressDialog/">wxProgressDialog</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxQueryNewPaletteEvent/">wxQueryNewPaletteEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxRadioBox/">wxRadioBox</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxRadioButton/">wxRadioButton</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxRegion/">wxRegion</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxSashEvent/">wxSashEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxSashLayoutWindow/">wxSashLayoutWindow</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxSashWindow/">wxSashWindow</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxScreenDC/">wxScreenDC</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxScrollBar/">wxScrollBar</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxScrollEvent/">wxScrollEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxScrollWinEvent/">wxScrollWinEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxScrolledWindow/">wxScrolledWindow</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxSetCursorEvent/">wxSetCursorEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxShowEvent/">wxShowEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxSingleChoiceDialog/">wxSingleChoiceDialog</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxSizeEvent/">wxSizeEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxSizer/">wxSizer</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxSizerFlags/">wxSizerFlags</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxSizerItem/">wxSizerItem</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxSlider/">wxSlider</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxSpinButton/">wxSpinButton</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxSpinCtrl/">wxSpinCtrl</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxSpinEvent/">wxSpinEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxSplashScreen/">wxSplashScreen</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxSplitterEvent/">wxSplitterEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxSplitterWindow/">wxSplitterWindow</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxStaticBitmap/">wxStaticBitmap</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxStaticBox/">wxStaticBox</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxStaticBoxSizer/">wxStaticBoxSizer</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxStaticLine/">wxStaticLine</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxStaticText/">wxStaticText</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxStatusBar/">wxStatusBar</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxStdDialogButtonSizer/">wxStdDialogButtonSizer</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxStyledTextCtrl/">wxStyledTextCtrl</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxStyledTextEvent/">wxStyledTextEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxSysColourChangedEvent/">wxSysColourChangedEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxSystemOptions/">wxSystemOptions</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxSystemSettings/">wxSystemSettings</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxTaskBarIcon/">wxTaskBarIcon</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxTaskBarIconEvent/">wxTaskBarIconEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxTextAttr/">wxTextAttr</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxTextCtrl/">wxTextCtrl</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxTextDataObject/">wxTextDataObject</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxTextEntryDialog/">wxTextEntryDialog</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxToggleButton/">wxToggleButton</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxToolBar/">wxToolBar</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxToolTip/">wxToolTip</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxToolbook/">wxToolbook</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxTopLevelWindow/">wxTopLevelWindow</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxTreeCtrl/">wxTreeCtrl</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxTreeEvent/">wxTreeEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxTreebook/">wxTreebook</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxUpdateUIEvent/">wxUpdateUIEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxWindow/">wxWindow</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxWindowCreateEvent/">wxWindowCreateEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxWindowDC/">wxWindowDC</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxWindowDestroyEvent/">wxWindowDestroyEvent</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wxXmlResource/">wxXmlResource</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wx_misc/">wx_misc</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../wx/wx_object/">wx_object</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Xmerl</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../xmerl/notes/">Xmerl Release Notes</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../xmerl/xmerl/">xmerl</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../xmerl/xmerl_eventp/">xmerl_eventp</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../xmerl/xmerl_sax_parser/">xmerl_sax_parser</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../xmerl/xmerl_scan/">xmerl_scan</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../xmerl/xmerl_ug/">xmerl</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../xmerl/xmerl_xpath/">xmerl_xpath</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../xmerl/xmerl_xs/">xmerl_xs</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../xmerl/xmerl_xsd/">xmerl_xsd</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../..">Erlang OTP</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../..">Docs</a> &raquo;</li>
    
      
        
          <li>Design principles &raquo;</li>
        
      
        
          <li>System &raquo;</li>
        
      
    
    <li>OTP Design Principles</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="otp-design-principles">OTP Design Principles</h1>
<p><a name="otp design principles">otp design principles</a> 
The <strong>OTP design principles</strong> define how to structure Erlang code in terms of processes, modules, and directories.</p>
<h3 id="supervision-trees">Supervision Trees</h3>
<p>A basic concept in Erlang/OTP is the <strong>supervision tree</strong> . This is a process structuring model based on the idea of <strong>workers</strong> and <strong>supervisors</strong> :</p>
<ul>
<li>Workers are processes that perform computations, that is, they do the actual work.</li>
<li>Supervisors are processes that monitor the behaviour of workers. A supervisor can restart a worker if something goes wrong.</li>
<li>The supervision tree is a hierarchical arrangement of code into supervisors and workers, which makes it possible to design and program fault-tolerant software.</li>
</ul>
<p>In the following figure, square boxes represents supervisors and circles represent workers:
 <a name="sup6">sup6</a> <img alt="Supervision Tree" src="../sup6.gif" /> </p>
<h3 id="behaviours">Behaviours</h3>
<p>In a supervision tree, many of the processes have similar structures, they follow similar patterns. For example, the supervisors are similar in structure. The only difference between them is which child processes they supervise. Many of the workers are servers in a server-client relation, finite-state machines, or event handlers.</p>
<p><strong>Behaviours</strong> are formalizations of these common patterns. The idea is to divide the code for a process in a generic part (a behaviour module) and a specific part (a <strong>callback module</strong> ).</p>
<p>The behaviour module is part of Erlang/OTP. To implement a process such as a supervisor, the user only has to implement the callback module which is to export a pre-defined set of functions, the <strong>callback functions</strong> .</p>
<p>The following example illustrate how code can be divided into a generic and a specific part. Consider the following code (written in plain Erlang) for a simple server, which keeps track of a number of "channels". Other processes can allocate and free the channels by calling the functions <em>alloc/0</em> and <em>free/1</em> , respectively.
 <a name="ch1">ch1</a> </p>
<pre><code>
-module(ch1).
-export([start/0]).
-export([alloc/0, free/1]).
-export([init/0]).

start() -&gt;
    spawn(ch1, init, []).

alloc() -&gt;
    ch1 ! {self(), alloc},
    receive
        {ch1, Res} -&gt;
            Res
    end.

free(Ch) -&gt;
    ch1 ! {free, Ch},
    ok.

init() -&gt;
    register(ch1, self()),
    Chs = channels(),
    loop(Chs).

loop(Chs) -&gt;
    receive
        {From, alloc} -&gt;
            {Ch, Chs2} = alloc(Chs),
            From ! {ch1, Ch},
            loop(Chs2);
        {free, Ch} -&gt;
            Chs2 = free(Ch, Chs),
            loop(Chs2)
    end.
</code></pre>

<p>The code for the server can be rewritten into a generic part <em>server.erl</em> :</p>
<pre><code>
-module(server).
-export([start/1]).
-export([call/2, cast/2]).
-export([init/1]).

start(Mod) -&gt;
    spawn(server, init, [Mod]).

call(Name, Req) -&gt;
    Name ! {call, self(), Req},
    receive
        {Name, Res} -&gt;
            Res
    end.

cast(Name, Req) -&gt;
    Name ! {cast, Req},
    ok.

init(Mod) -&gt;
    register(Mod, self()),
    State = Mod:init(),
    loop(Mod, State).

loop(Mod, State) -&gt;
    receive
        {call, From, Req} -&gt;
            {Res, State2} = Mod:handle_call(Req, State),
            From ! {Mod, Res},
            loop(Mod, State2);
        {cast, Req} -&gt;
            State2 = Mod:handle_cast(Req, State),
            loop(Mod, State2)
    end.
</code></pre>

<p>And a callback module <em>ch2.erl</em> :</p>
<pre><code>
-module(ch2).
-export([start/0]).
-export([alloc/0, free/1]).
-export([init/0, handle_call/2, handle_cast/2]).

start() -&gt;
    server:start(ch2).

alloc() -&gt;
    server:call(ch2, alloc).

free(Ch) -&gt;
    server:cast(ch2, {free, Ch}).

init() -&gt;
    channels().

handle_call(alloc, Chs) -&gt;
    alloc(Chs). % =&gt; {Ch,Chs2}

handle_cast({free, Ch}, Chs) -&gt;
    free(Ch, Chs). % =&gt; Chs2
</code></pre>

<p>Notice the following:</p>
<ul>
<li>The code in <em>server</em> can be reused to build many different servers.</li>
<li>The server name, in this example the atom <em>ch2</em> , is hidden from the users of the client functions. This means that the name can be changed without affecting them.</li>
<li>The protocol (messages sent to and received from the server) is also hidden. This is good programming practice and allows one to change the protocol without changing the code using the interface functions.</li>
<li>The functionality of <em>server</em> can be extended without having to change <em>ch2</em> or any other callback module.</li>
</ul>
<p>In <em>ch1.erl</em> and <em>ch2.erl</em> above, the implementation of <em>channels/0</em> , <em>alloc/1</em> , and <em>free/2</em> has been intentionally left out, as it is not relevant to the example. For completeness, one way to write these functions are given below. This is an example only, a realistic implementation must be able to handle situations like running out of channels to allocate, and so on.</p>
<pre><code>
channels() -&gt;
   {_Allocated = [], _Free = lists:seq(1,100)}.

alloc({Allocated, [H|T] = _Free}) -&gt;
   {H, {[H|Allocated], T}}.

free(Ch, {Alloc, Free} = Channels) -&gt;
   case lists:member(Ch, Alloc) of
      true -&gt;
         {lists:delete(Ch, Alloc), [Ch|Free]};
      false -&gt;
         Channels
   end.        
</code></pre>

<p>Code written without using behaviours can be more efficient, but the increased efficiency is at the expense of generality. The ability to manage all applications in the system in a consistent manner is important.</p>
<p>Using behaviours also makes it easier to read and understand code written by other programmers. Improvised programming structures, while possibly more efficient, are always more difficult to understand.</p>
<p>The <em>server</em> module corresponds, greatly simplified, to the Erlang/OTP behaviour <em>gen_server</em> .</p>
<p>The standard Erlang/OTP behaviours are:</p>
<ul>
<li><a href="gen_server_concepts">gen_server</a></li>
</ul>
<p>For implementing the server of a client-server relation
* 
<a href="statem">gen_statem</a></p>
<p>For implementing state machines
* 
<a href="events">gen_event</a></p>
<p>For implementing event handling functionality
* 
<a href="sup_princ">supervisor</a></p>
<p>For implementing a supervisor in a supervision tree</p>
<p>The compiler understands the module attribute <em>-behaviour(Behaviour)</em> and issues warnings about missing callback functions, for example:</p>
<pre><code>
-module(chs3).
-behaviour(gen_server).
...

3&gt; c(chs3).
./chs3.erl:10: Warning: undefined call-back function handle_call/3
{ok,chs3}
</code></pre>

<h3 id="applications">Applications</h3>
<p>Erlang/OTP comes with a number of components, each implementing some specific functionality. Components are with Erlang/OTP terminology called <strong>applications</strong> . Examples of Erlang/OTP applications are Mnesia, which has everything needed for programming database services, and Debugger, which is used to debug Erlang programs. The minimal system based on Erlang/OTP consists of the following two applications:</p>
<ul>
<li>Kernel - Functionality necessary to run Erlang</li>
<li>STDLIB - Erlang standard libraries</li>
</ul>
<p>The application concept applies both to program structure (processes) and directory structure (modules).</p>
<p>The simplest applications do not have any processes, but consist of a collection of functional modules. Such an application is called a <strong>library application</strong> . An example of a library application is STDLIB.</p>
<p>An application with processes is easiest implemented as a supervision tree using the standard behaviours.</p>
<p>How to program applications is described in <a href="applications">Applications</a> .</p>
<h3 id="releases">Releases</h3>
<p>A <strong>release</strong> is a complete system made out from a subset of Erlang/OTP applications and a set of user-specific applications.</p>
<p>How to program releases is described in <a href="release_structure">Releases</a> .</p>
<p>How to install a release in a target environment is described in the section about target systems in Section 2 System Principles.</p>
<h3 id="release-handling">Release Handling</h3>
<p><strong>Release handling</strong> is upgrading and downgrading between different versions of a release, in a (possibly) running system. How to do this is described in <a href="release_handling">Release Handling</a> .
<a name="gen_server">gen_server</a> 
This section is to be read with the <a href="./gen_server">gen_server(3)</a> manual page in <em>stdlib</em> , where all interface functions and callback functions are described in detail.</p>
<h3 id="client-server-principles">Client-Server Principles</h3>
<p>The client-server model is characterized by a central server and an arbitrary number of clients. The client-server model is used for resource management operations, where several different clients want to share a common resource. The server is responsible for managing this resource.
 <a name="clientserver">clientserver</a> <img alt="Client-Server Model" src="../clientserver.gif" /> </p>
<h3 id="example">Example</h3>
<p>An example of a simple server written in plain Erlang is provided in <a href="./des_princ#ch1">Overview</a> . The server can be reimplemented using <em>gen_server</em> , resulting in this callback module:
 <a name="ex">ex</a> </p>
<pre><code>
-module(ch3).
-behaviour(gen_server).

-export([start_link/0]).
-export([alloc/0, free/1]).
-export([init/1, handle_call/3, handle_cast/2]).

start_link() -&gt;
    gen_server:start_link({local, ch3}, ch3, [], []).

alloc() -&gt;
    gen_server:call(ch3, alloc).

free(Ch) -&gt;
    gen_server:cast(ch3, {free, Ch}).

init(_Args) -&gt;
    {ok, channels()}.

handle_call(alloc, _From, Chs) -&gt;
    {Ch, Chs2} = alloc(Chs),
    {reply, Ch, Chs2}.

handle_cast({free, Ch}, Chs) -&gt;
    Chs2 = free(Ch, Chs),
    {noreply, Chs2}.
</code></pre>

<p>The code is explained in the next sections.</p>
<h3 id="starting-a-gen_server">Starting a Gen_Server</h3>
<p>In the example in the previous section, <em>gen_server</em> is started by calling <em>ch3:start_link()</em> :</p>
<pre><code>
start_link() -&gt;
    gen_server:start_link({local, ch3}, ch3, [], []) =&gt; {ok, Pid}
</code></pre>

<p><em>start_link</em> calls function <em>gen_server:start_link/4</em> . This function spawns and links to a new process, a <em>gen_server</em> .</p>
<ul>
<li>The first argument, <em>{local, ch3}</em> , specifies the name. The gen_server is then locally registered as <em>ch3</em> .</li>
</ul>
<p>If the name is omitted, the <em>gen_server</em> is not registered. Instead its pid must be used. The name can also be given as <em>{global, Name}</em> , in which case the <em>gen_server</em> is registered using <em>global:register_name/2</em> .
* 
The second argument, <em>ch3</em> , is the name of the callback module, that is, the module where the callback functions are located.</p>
<p>The interface functions ( <em>start_link</em> , <em>alloc</em> , and <em>free</em> ) are then located in the same module as the callback functions ( <em>init</em> , <em>handle_call</em> , and <em>handle_cast</em> ). This is normally good programming practice, to have the code corresponding to one process contained in one module.
* The third argument, <em>[]</em> , is a term that is passed as is to the callback function <em>init</em> . Here, <em>init</em> does not need any indata and ignores the argument.
* The fourth argument, <em>[]</em> , is a list of options. See the <em>gen_server(3)</em> manual page for available options.</p>
<p>If name registration succeeds, the new <em>gen_server</em> process calls the callback function <em>ch3:init([])</em> . <em>init</em> is expected to return <em>{ok, State}</em> , where <em>State</em> is the internal state of the <em>gen_server</em> . In this case, the state is the available channels.</p>
<pre><code>
init(_Args) -&gt;
    {ok, channels()}.
</code></pre>

<p><em>gen_server:start_link</em> is synchronous. It does not return until the <em>gen_server</em> has been initialized and is ready to receive requests.</p>
<p><em>gen_server:start_link</em> must be used if the <em>gen_server</em> is part of a supervision tree, that is, started by a supervisor. There is another function, <em>gen_server:start</em> , to start a standalone <em>gen_server</em> , that is, a <em>gen_server</em> that is not part of a supervision tree.</p>
<h3 id="synchronous-requests-call">Synchronous Requests - Call</h3>
<p>The synchronous request <em>alloc()</em> is implemented using <em>gen_server:call/2</em> :</p>
<pre><code>
alloc() -&gt;
    gen_server:call(ch3, alloc).
</code></pre>

<p><em>ch3</em> is the name of the <em>gen_server</em> and must agree with the name used to start it. <em>alloc</em> is the actual request.</p>
<p>The request is made into a message and sent to the <em>gen_server</em> . When the request is received, the <em>gen_server</em> calls <em>handle_call(Request, From, State)</em> , which is expected to return a tuple <em>{reply,Reply,State1}</em> . <em>Reply</em> is the reply that is to be sent back to the client, and <em>State1</em> is a new value for the state of the <em>gen_server</em> .</p>
<pre><code>
handle_call(alloc, _From, Chs) -&gt;
    {Ch, Chs2} = alloc(Chs),
    {reply, Ch, Chs2}.
</code></pre>

<p>In this case, the reply is the allocated channel <em>Ch</em> and the new state is the set of remaining available channels <em>Chs2</em> .</p>
<p>Thus, the call <em>ch3:alloc()</em> returns the allocated channel <em>Ch</em> and the <em>gen_server</em> then waits for new requests, now with an updated list of available channels.</p>
<h3 id="asynchronous-requests-cast">Asynchronous Requests - Cast</h3>
<p>The asynchronous request <em>free(Ch)</em> is implemented using <em>gen_server:cast/2</em> :</p>
<pre><code>
free(Ch) -&gt;
    gen_server:cast(ch3, {free, Ch}).
</code></pre>

<p><em>ch3</em> is the name of the <em>gen_server</em> . <em>{free, Ch}</em> is the actual request.</p>
<p>The request is made into a message and sent to the <em>gen_server</em> . <em>cast</em> , and thus <em>free</em> , then returns <em>ok</em> .</p>
<p>When the request is received, the <em>gen_server</em> calls <em>handle_cast(Request, State)</em> , which is expected to return a tuple <em>{noreply,State1}</em> . <em>State1</em> is a new value for the state of the <em>gen_server</em> .</p>
<pre><code>
handle_cast({free, Ch}, Chs) -&gt;
    Chs2 = free(Ch, Chs),
    {noreply, Chs2}.
</code></pre>

<p>In this case, the new state is the updated list of available channels <em>Chs2</em> . The <em>gen_server</em> is now ready for new requests.</p>
<h3 id="stopping">Stopping</h3>
<h3 id="in-a-supervision-tree">In a Supervision Tree</h3>
<p>If the <em>gen_server</em> is part of a supervision tree, no stop function is needed. The <em>gen_server</em> is automatically terminated by its supervisor. Exactly how this is done is defined by a <a href="./sup_princ#shutdown">shutdown strategy</a> set in the supervisor.</p>
<p>If it is necessary to clean up before termination, the shutdown strategy must be a time-out value and the <em>gen_server</em> must be set to trap exit signals in function <em>init</em> . When ordered to shutdown, the <em>gen_server</em> then calls the callback function <em>terminate(shutdown, State)</em> :</p>
<pre><code>
init(Args) -&gt;
    ...,
    process_flag(trap_exit, true),
    ...,
    {ok, State}.

...

terminate(shutdown, State) -&gt;
    ..code for cleaning up here..
    ok.
</code></pre>

<h3 id="standalone-gen_servers">Standalone Gen_Servers</h3>
<p>If the <em>gen_server</em> is not part of a supervision tree, a stop function can be useful, for example:</p>
<pre><code>
...
export([stop/0]).
...

stop() -&gt;
    gen_server:cast(ch3, stop).
...

handle_cast(stop, State) -&gt;
    {stop, normal, State};
handle_cast({free, Ch}, State) -&gt;
    ....

...

terminate(normal, State) -&gt;
    ok.
</code></pre>

<p>The callback function handling the <em>stop</em> request returns a tuple <em>{stop,normal,State1}</em> , where <em>normal</em> specifies that it is a normal termination and <em>State1</em> is a new value for the state of the <em>gen_server</em> . This causes the <em>gen_server</em> to call <em>terminate(normal, State1)</em> and then it terminates gracefully.</p>
<h3 id="handling-other-messages">Handling Other Messages</h3>
<p>If the <em>gen_server</em> is to be able to receive other messages than requests, the callback function <em>handle_info(Info, State)</em> must be implemented to handle them. Examples of other messages are exit messages, if the <em>gen_server</em> is linked to other processes (than the supervisor) and trapping exit signals.</p>
<pre><code>
handle_info({'EXIT', Pid, Reason}, State) -&gt;
    ..code to handle exits here..
    {noreply, State1}.
</code></pre>

<p>The <em>code_change</em> method must also be implemented.</p>
<pre><code>
code_change(OldVsn, State, Extra) -&gt;
    ..code to convert state (and more) during code change
    {ok, NewState}.
</code></pre>

<p><a name="gen_statem Behaviour">gen_statem Behaviour</a> 
This section is to be read with the <a href="./gen_statem">stdlib/gen_statem</a> manual page in STDLIB, where all interface functions and callback functions are described in detail.
 <a name="Event-Driven State Machines">Event-Driven State Machines</a> </p>
<h3 id="event-driven-state-machines">Event-Driven State Machines</h3>
<p>Established Automata Theory does not deal much with how a <strong>state transition</strong> is triggered, but assumes that the output is a function of the input (and the state) and that they are some kind of values.</p>
<p>For an Event-Driven State Machine, the input is an event that triggers a <strong>state transition</strong> and the output is actions executed during the <strong>state transition</strong> . It can analogously to the mathematical model of a Finite State Machine be described as a set of relations of the following form:</p>
<pre><code>
State(S) x Event(E) -&gt; Actions(A), State(S')
</code></pre>

<p>These relations are interpreted as follows: if we are in state <em>S</em> and event <em>E</em> occurs, we are to perform actions <em>A</em> and make a transition to state <em>S'</em> . Notice that <em>S'</em> can be equal to <em>S</em> and that <em>A</em> can be empty.</p>
<p>In <em>gen_statem</em> we define a <strong>state change</strong> as a <strong>state transition</strong> in which the new state <em>S'</em> is different from the current state <em>S</em> , where "different" means Erlang's strict inequality: <em>=/=</em> also know as "does not match". During a <strong>state changes</strong> , <em>gen_statem</em> does more things than during other <strong>state transitions</strong> .</p>
<p>As <em>A</em> and <em>S'</em> depend only on <em>S</em> and <em>E</em> , the kind of state machine described here is a Mealy machine (see, for example, the Wikipedia article "Mealy machine").</p>
<p>Like most <em>gen_</em> behaviors, <em>gen_statem</em> keeps a server <em>Data</em> besides the state. Because of this, and as there is no restriction on the number of states (assuming that there is enough virtual machine memory) or on the number of distinct input events, a state machine implemented with this behavior is in fact Turing complete. But it feels mostly like an Event-Driven Mealy machine.
 <a name="When to use gen_statem">When to use gen_statem</a> </p>
<h3 id="when-to-use-gen_statem">When to use gen_statem</h3>
<p>If your process logic is convenient to describe as a state machine, and you want any of these <em>gen_statem</em> key features:</p>
<ul>
<li>Co-located callback code for each state, for all <a href="#Event Types">Event Types</a> (such as <strong>call</strong> , <strong>cast</strong> and <strong>info</strong> )</li>
<li><a href="#Postponing Events">Postponing Events</a> (a substitute for selective receive)</li>
<li><a href="#Inserted Events">Inserted Events</a> that is: events from the state machine to itself (in particular purely internal events)</li>
<li><a href="#State Enter Calls">State Enter Calls</a> (callback on state entry co-located with the rest of each state's callback code)</li>
<li>Easy-to-use time-outs ( <a href="#State Time-Outs">State Time-Outs</a> , <a href="#Event Time-Outs">Event Time-Outs</a> and <a href="#Generic Time-Outs">Generic Time-outs</a> (named time-outs))</li>
</ul>
<p>If so, or if possibly needed in future versions, then you should consider using <em>gen_statem</em> over <a href="./gen_server">stdlib/gen_server</a> .</p>
<p>For simple state machines not needing these features <a href="./gen_server">stdlib/gen_server</a> works just fine. It also has got smaller call overhead, but we are talking about something like 2 vs 3.3 microseconds call roundtrip time here, so if the server callback does just a little bit more than just replying, or if the call is not extremely frequent, that difference will be hard to notice.
 <a name="Callback Module">Callback Module</a> </p>
<h3 id="callback-module">Callback Module</h3>
<p>The <strong>callback module</strong> contains functions that implement the state machine. When an event occurs, the <em>gen_statem</em> behaviour engine calls a function in the <strong>callback module</strong> with the event, current state and server data. This function performs the actions for this event, and returns the new state and server data and also actions to be performed by the behaviour engine.</p>
<p>The behaviour engine holds the state machine state, server data, timer references, a queue of posponed messages and other metadata. It receives all process messages, handles the system messages, and calls the <strong>callback module</strong> with machine specific events.
 <a name="Callback Modes">Callback Modes</a> </p>
<h3 id="callback-modes">Callback Modes</h3>
<p>The <em>gen_statem</em> behavior supports two <strong>callback modes</strong> :
 <dl></p>
<dt> stdlib/gen_statem#type-callback_mode </dt>

<dd>

Events are handled by one callback function per state.
</dd>

<dt> stdlib/gen_statem#type-callback_mode </dt>

<dd>

Events are handled by one single callback function.
</dd>

<p></dl> 
The <strong>callback mode</strong> is selected at server start and may be changed with a code upgrade/downgrade.</p>
<p>See the section <a href="#State Callback">State Callback</a> that describes the event handling callback function(s).</p>
<p>The <strong>callback mode</strong> is selected by implementing a mandatory callback function <a href="../stdlib/gen_statem#Module:callback_mode/0">stdlib/gen_statem#Module:callback_mode/0</a> that returns one of the <strong>callback modes</strong> .</p>
<p>The <a href="../stdlib/gen_statem#Module:callback_mode/0">stdlib/gen_statem#Module:callback_mode/0</a> function may also return a list containing the <strong>callback mode</strong> and the atom <em>state_enter</em> in which case <a href="#State Enter Calls">State Enter Calls</a> are activated for the <strong>callback mode</strong> .
 <a name="Choosing the Callback Mode">Choosing the Callback Mode</a> </p>
<h3 id="choosing-the-callback-mode">Choosing the Callback Mode</h3>
<p>The short version: choose <em>state_functions</em> - it is the one most like <em>gen_fsm</em> . But if you do not want the restriction that the state must be an atom, or if you do not want to write one <strong>state callback</strong> function per state; please read on...</p>
<p>The two <a href="#Callback Modes">Callback Modes</a> give different possibilities and restrictions, with one common goal: to handle all possible combinations of events and states.</p>
<p>This can be done, for example, by focusing on one state at the time and for every state ensure that all events are handled. Alternatively, you can focus on one event at the time and ensure that it is handled in every state. You can also use a mix of these strategies.</p>
<p>With <em>state_functions</em> , you are restricted to use atom-only states, and the <em>gen_statem</em> engine branches depending on state name for you. This encourages the <strong>callback module</strong> to co-locate the implementation of all event actions particular to one state in the same place in the code, hence to focus on one state at the time.</p>
<p>This mode fits well when you have a regular state diagram, like the ones in this chapter, which describes all events and actions belonging to a state visually around that state, and each state has its unique name.</p>
<p>With <em>handle_event_function</em> , you are free to mix strategies, as all events and states are handled in the same callback function.</p>
<p>This mode works equally well when you want to focus on one event at the time or on one state at the time, but function <a href="../stdlib/gen_statem#Module:handle_event/4">stdlib/gen_statem#Module:handle_event/4</a> quickly grows too large to handle without branching to helper functions.</p>
<p>The mode enables the use of non-atom states, for example, complex states or even hierarchical states. See section <a href="#Complex State">Complex State</a> . If, for example, a state diagram is largely alike for the client side and the server side of a protocol, you can have a state <em>{StateName,server}</em> or <em>{StateName,client}</em> , and make <em>StateName</em> determine where in the code to handle most events in the state. The second element of the tuple is then used to select whether to handle special client-side or server-side events.
 <a name="State Callback">State Callback</a> </p>
<h3 id="state-callback">State Callback</h3>
<p>The <strong>state callback</strong> is the callback function that handles an event in the current state, and which function that is depends on the <strong>callback mode</strong> :
 <dl></p>
<dt> state_functions </dt>

<dd>
The event is handled by:  stdlib/gen_statem#Module:StateName/3 
This form is the one mostly used in the Example section.
</dd>

<dt> handle_event_function </dt>

<dd>
The event is handled by:  stdlib/gen_statem#Module:handle_event/4 
See section One State Callback for an example.
</dd>

<p></dl> 
The state is either the name of the function itself or an argument to it. The other arguments are the <em>EventType</em> described in section <a href="#Event Types">Event Types</a> , the event dependent <em>EventContent</em> , and the current server <em>Data</em> .</p>
<p><strong>State enter calls</strong> are also handled by the event handler and have slightly different arguments. See section <a href="#State Enter Calls">State Enter Calls</a> .</p>
<p>The <strong>state callback</strong> return values are defined in the description of <a href="../stdlib/gen_statem#Module:StateName/3">stdlib/gen_statem#Module:StateName/3</a> in the <em>gen_statem</em> manual page, but here is a more readable list:
 <dl></p>
<dt>
{next_state, NextState, NewData, Actions}  {next_state, NextState, NewData}
</dt>

<dd>

Set next state and update the server data. If the Actions field is used, execute transition actions . An empty Actions list is equivalent to not returning the field.

See section Transition Actions for a list of possible transition actions .

If NextState =/= State this is a state change so the extra things gen_statem does are: the event queue is restarted from the oldest postponed event , any current state time-out is cancelled, and a state enter call is performed, if enabled.
</dd>

<dt>
{keep_state, NewData, Actions}  {keep_state, NewData} </dt>

<dd>

Same as the next_state values with NextState =:= State , that is, no state change .
</dd>

<dt>
{keep_state_and_data, Actions}  keep_state_and_data </dt>

<dd>

Same as the keep_state values with NextData =:= Data , that is, no change in server data.
</dd>

<dt>
{repeat_state, NewData, Actions}  {repeat_state, NewData}  {repeat_state_and_data, Actions}  repeat_state_and_data
</dt>

<dd>

Same as the keep_state or keep_state_and_data values, and if State Enter Calls are enabled, repeat the state enter call as if this state was entered again.

If these return values are used from a state enter call the OldState does not change, but if used from an event handling state callback the new state enter call's OldState will be the current state.
</dd>

<dt>
{stop, Reason, NewData}  {stop, Reason} </dt>

<dd>

Stop the server with reason Reason . If the NewData field is used, first update the server data.
</dd>

<dt>
{stop_and_reply, Reason, NewData, ReplyActions}  {stop_and_reply, Reason, ReplyActions}
</dt>

<dd>

Same as the stop values, but first execute the given Transition Actions that may only be reply actions.
</dd>

<p></dl> <a name="The First State">The First State</a> </p>
<h3 id="the-first-state">The First State</h3>
<p>To decide the first state the <a href="../stdlib/gen_statem#Module:init/1">stdlib/gen_statem#Module:init/1</a> callback function is called before any <a href="#State Callback">State Callback</a> is called. This function behaves like an <strong>state callback</strong> function, but gets its only argument <em>Args</em> from the <em>gen_statem</em> <a href="../stdlib/gen_statem#start/3">stdlib/gen_statem#start/3</a> or <a href="../stdlib/gen_statem#start_link/3">stdlib/gen_statem#start_link/3</a> function, and returns <em>{ok, State, Data}</em> or <em>{ok, State, Data, Actions}</em> . If you use the <a href="#Postponing Events">Postponing Events</a> action from this function, that action is ignored, since there is no event to postpone.
 <a name="Transition Actions">Transition Actions</a> </p>
<h3 id="transition-actions">Transition Actions</h3>
<p>In the first section <a href="#Event-Driven State Machines">Event-Driven State Machines</a> actions were mentioned as a part of the general state machine model. These general actions are implemented with the code that <strong>callback module</strong> <em>gen_statem</em> executes in an event-handling callback function before returning to the <em>gen_statem</em> engine.</p>
<p>There are more specific <strong>transition actions</strong> that a callback function can command the <em>gen_statem</em> engine to do after the callback function return. These are commanded by returning a list of <a href="../stdlib/gen_statem#type-action">actions</a> in the <a href="../stdlib/gen_statem#type-state_callback_result">return value</a> from the <a href="../stdlib/gen_statem#Module:StateName/3">callback function</a> . These are the possible <strong>transition actions</strong> :
 <dl></p>
<dt>
stdlib/gen_statem#type-postpone  {postpone, Boolean} </dt>

<dd>
If set postpone the current event, see section Postponing Events .
</dd>

<dt>
stdlib/gen_statem#type-hibernate  {hibernate, Boolean} </dt>

<dd>
If set hibernate the gen_statem , treated in section Hibernation .
</dd>

<dt>
stdlib/gen_statem#type-state_timeout  {state_timeout, EventContent, Time, Opts}
</dt>

<dd>
Start a state time-out, read more in sections Time-Outs and State Time-Outs .
</dd>

<dt>
stdlib/gen_statem#type-generic_timeout  {{timeout, Name}, EventContent, Time, Opts}
</dt>

<dd>
Start a generic time-out, read more in sections Time-Outs and Generic Time-Outs .
</dd>

<dt>
stdlib/gen_statem#type-event_timeout  {timeout, EventContent, Time, Opts}  Time
</dt>

<dd>
Start an event time-out, see more in sections Time-Outs and Event Time-Outs .
</dd>

<dt> stdlib/gen_statem#type-reply_action </dt>

<dd>
Reply to a caller, mentioned at the end of section All State Events .
</dd>

<dt> stdlib/gen_statem#type-action </dt>

<dd>
Generate the next event to handle, see section Inserted Events .
</dd>

<p></dl> 
For details, see the <em>gen_statem(3)</em> manual page for type <a href="../stdlib/gen_statem#type-action">stdlib/gen_statem#type-action</a> . You can, for example, reply to many callers, generate multiple next events, and set a time-out to use absolute instead of relative time (using the <em>Opts</em> field).
 <a name="Event Types">Event Types</a> </p>
<h3 id="event-types">Event Types</h3>
<p>Events are categorized in different <a href="../stdlib/gen_statem#type-event_type">stdlib/gen_statem#type-event_type</a> . Events of all types are for a given state handled in the same callback function, and that function gets <em>EventType</em> and <em>EventContent</em> as arguments.</p>
<p>The following is a complete list of <strong>event types</strong> and where they come from:
 <dl></p>
<dt> stdlib/gen_statem#type-external_event_type </dt>

<dd> Generated by stdlib/gen_statem#cast/2 . </dd>

<dt> stdlib/gen_statem#type-external_event_type </dt>

<dd>
Generated by stdlib/gen_statem#call/2 , where From is the reply address to use when replying either through the transition action {reply,From,Msg} or by calling stdlib/gen_statem#reply/1 .
</dd>

<dt> stdlib/gen_statem#type-external_event_type </dt>

<dd>
Generated by any regular process message sent to the gen_statem process.
</dd>

<dt> stdlib/gen_statem#type-timeout_event_type </dt>

<dd>
Generated by transition action stdlib/gen_statem#type-timeout_action state timer timing out. Read more in sections Time-Outs and State Time-Outs .
</dd>

<dt> stdlib/gen_statem#type-timeout_event_type </dt>

<dd>
Generated by transition action stdlib/gen_statem#type-timeout_action generic timer timing out. Read more in sections Time-Outs and Generic Time-Outs .
</dd>

<dt> stdlib/gen_statem#type-timeout_event_type </dt>

<dd>
Generated by transition action stdlib/gen_statem#type-timeout_action (or its short form Time ) event timer timing out. Read more in sections Time-Outs and Event Time-Outs .
</dd>

<dt> stdlib/gen_statem#type-event_type </dt>

<dd>
Generated by transition action stdlib/gen_statem#type-enter_action . All event types above can also be generated using the next_event action: {next_event,EventType,EventContent} .
</dd>

<p></dl> <a name="State Enter Calls">State Enter Calls</a> </p>
<h3 id="state-enter-calls">State Enter Calls</h3>
<p>The <em>gen_statem</em> behavior can if this is enabled, regardless of <strong>callback mode</strong> , automatically <a href="../stdlib/gen_statem#type-state_enter">call the state callback</a> with special arguments whenever the state changes so you can write state enter actions near the rest of the <strong>state transition</strong> rules. It typically looks like this:</p>
<pre><code>
StateName(enter, OldState, Data) -&gt;
    ... code for state enter actions here ...
    {keep_state, NewData};
StateName(EventType, EventContent, Data) -&gt;
    ... code for actions here ...
    {next_state, NewStateName, NewData}.
</code></pre>

<p>Since the <strong>state enter call</strong> is not an event there are restrictions on the allowed return value and <a href="#Transition Actions">State Transition Actions</a> . You may not change the state, <a href="#Postponing Events">postpone</a> this non-event, or <a href="#Inserted Events">insert any events</a> .</p>
<p>The first state that is entered will get a <strong>state enter call</strong> with <em>OldState</em> equal to the current state.</p>
<p>You may repeat the <strong>state enter call</strong> using the <em>{repeat_state,...}</em> return value from the <a href="#State Callback">state callback</a> . In this case <em>OldState</em> will also be equal to the current state.</p>
<p>Depending on how your state machine is specified, this can be a very useful feature, but it forces you to handle the <strong>state enter calls</strong> in all states. See also the <a href="#State Enter Actions">State Enter Actions</a> section.
 <a name="Time-Outs">Time-Outs</a> </p>
<h3 id="time-outs">Time-outs</h3>
<p>Time-outs in <em>gen_statem</em> are started from a <a href="#Transition Actions">Transition Actions</a> during a state transition that is when exiting from the <a href="#State Callback">State Callback</a> .</p>
<p>There are 3 types of time-outs in <em>gen_statem</em> :
 <dl></p>
<dt> stdlib/gen_statem#type-state_timeout </dt>

<dd>
There is one State Time-Out that is automatically cancelled by a state change .
</dd>

<dt> stdlib/gen_statem#type-generic_timeout </dt>

<dd>
There are any number of Generic Time-Outs differing by their Name . They have no automatic cancelling.
</dd>

<dt> stdlib/gen_statem#type-event_timeout </dt>

<dd>
There is one Event Time-Out that is automatically cancelled by any event. Note that postponed and inserted events cancel this timeout just as external events.
</dd>

<p></dl> 
When a time-out is started any running time-out with the same tag, <em>state_timeout</em> , <em>{timeout, Name}</em> or <em>timeout</em> , is cancelled, that is the time-out is restarted with the new time.</p>
<p>All time-outs has got an <em>EventContent</em> that is part of the <a href="#Transition Actions">Transition Actions</a> that starts the time-out. Different <em>EventContent</em> s does not create different time-outs. The <em>EventContent</em> is delivered to the <a href="#State Callback">State Callback</a> when the time-out expires.
 <a name="Cancelling a Time-Out">Cancelling a Time-Out</a> </p>
<h3 id="cancelling-a-time-out">Cancelling a Time-Out</h3>
<p>If a time-out is started with the time <em>infinity</em> it will never time out, in fact it will not even be started, and any running time-out with the same tag will be cancelled. The <em>EventContent</em> will in this case be ignored, so why not set it to <em>undefined</em> .
 <a name="Time-Out Zero">Time-Out Zero</a> </p>
<h3 id="time-out-zero">Time-Out Zero</h3>
<p>If a time-out is started with the time <em>0</em> it will actually not be started. Instead the time-out event will immediately be inserted to be processed after any events already enqueued, and before any not yet received external events. Note that some time-outs are automatically cancelled so if you for example combine <a href="#Postponing Events">postponing</a> an event in a <strong>state change</strong> with starting an <a href="#Event Time-Outs">event time-out</a> with time <em>0</em> there will be no timeout event inserted since the event time-out is cancelled by the postponed event that is delivered due to the state change.
 <a name="Example">Example</a> </p>
<h3 id="example_1">Example</h3>
<p>A door with a code lock can be seen as a state machine. Initially, the door is locked. When someone presses a button, an event is generated. The pressed buttons are collected, up to the number of buttons in the correct code. If correct, the door is unlocked for 10 seconds. If not correct, we wait for a new button to be pressed.
 <img alt="Code Lock State Diagram" src="../code_lock.svg" /> 
This code lock state machine can be implemented using <em>gen_statem</em> with the following <strong>callback module</strong> :</p>
<pre><code class="erl">
-module(code_lock).
-behaviour(gen_statem).
-define(NAME, code_lock).

-export([start_link/1]).
-export([button/1]).
-export([init/1,callback_mode/0,terminate/3]).
-export([locked/3,open/3]).

start_link(Code) -&gt;
    gen_statem:start_link({local,?NAME}, ?MODULE, Code, []).

button(Button) -&gt;
    gen_statem:cast(?NAME, {button,Button}).

init(Code) -&gt;
    do_lock(),
    Data = #{code =&gt; Code, length =&gt; length(Code), buttons =&gt; []},
    {ok, locked, Data}.

callback_mode() -&gt;
    state_functions.

</code></pre>

<pre><code class="erl">
locked(
  cast, {button,Button},
  #{code := Code, length := Length, buttons := Buttons} = Data) -&gt;
    NewButtons =
        if
            length(Buttons) &lt; Length -&gt;
                Buttons;
            true -&gt;
                tl(Buttons)
        end ++ [Button],
    if
        NewButtons =:= Code -&gt; % Correct
        do_unlock(),
            {next_state, open, Data#{buttons := []},
             [{state_timeout,10000,lock}]}; % Time in milliseconds
    true -&gt; % Incomplete | Incorrect
            {next_state, locked, Data#{buttons := NewButtons}}
    end.

</code></pre>

<pre><code class="erl">
open(state_timeout, lock,  Data) -&gt;
    do_lock(),
    {next_state, locked, Data};
open(cast, {button,_}, Data) -&gt;
    {next_state, open, Data}.

</code></pre>

<pre><code class="erl">
do_lock() -&gt;
    io:format(&quot;Lock~n&quot;, []).
do_unlock() -&gt;
    io:format(&quot;Unlock~n&quot;, []).

terminate(_Reason, State, _Data) -&gt;
    State =/= locked andalso do_lock(),
    ok.

</code></pre>

<p>The code is explained in the next sections.
 <a name="Starting gen_statem">Starting gen_statem</a> </p>
<h3 id="starting-gen_statem">Starting gen_statem</h3>
<p>In the example in the previous section, <em>gen_statem</em> is started by calling <em>code_lock:start_link(Code)</em> :</p>
<pre><code class="erl">
start_link(Code) -&gt;
    gen_statem:start_link({local,?NAME}, ?MODULE, Code, []).

</code></pre>

<p><em>start_link</em> calls function <a href="../stdlib/gen_statem#start_link/4">stdlib/gen_statem#start_link/4</a> , which spawns and links to a new process, a <em>gen_statem</em> .</p>
<ul>
<li>The first argument, <em>{local,?NAME}</em> , specifies the name. In this case, the <em>gen_statem</em> is locally registered as <em>code_lock</em> through the macro <em>?NAME</em> .</li>
</ul>
<p>If the name is omitted, the <em>gen_statem</em> is not registered. Instead its pid must be used. The name can also be specified as <em>{global,Name}</em> , then the <em>gen_statem</em> is registered using <a href="../kernel/global#register_name/2">kernel/global#register_name/2</a> in Kernel.
* 
The second argument, <em>?MODULE</em> , is the name of the <strong>callback module</strong> , that is, the module where the callback functions are located, which is this module.</p>
<p>The interface functions ( <em>start_link/1</em> and <em>button/1</em> ) are located in the same module as the callback functions ( <em>init/1</em> , <em>locked/3</em> , and <em>open/3</em> ). It is normally good programming practice to have the client-side code and the server-side code contained in one module.
* The third argument, <em>Code</em> , is a list of digits, which is the correct unlock code that is passed to callback function <em>init/1</em> .
* The fourth argument, <em>[]</em> , is a list of options. For the available options, see <a href="../stdlib/gen_statem#start_link/3">stdlib/gen_statem#start_link/3</a> .</p>
<p>If name registration succeeds, the new <em>gen_statem</em> process calls callback function <em>code_lock:init(Code)</em> . This function is expected to return <em>{ok, State, Data}</em> , where <em>State</em> is the initial state of the <em>gen_statem</em> , in this case <em>locked</em> ; assuming that the door is locked to begin with. <em>Data</em> is the internal server data of the <em>gen_statem</em> . Here the server data is a <a href="./maps">map</a> with key <em>code</em> that stores the correct button sequence, key <em>length</em> store its length, and key <em>buttons</em> that stores the collected buttons up to the same length.</p>
<pre><code class="erl">
init(Code) -&gt;
    do_lock(),
    Data = #{code =&gt; Code, length =&gt; length(Code), buttons =&gt; []},
    {ok, locked, Data}.

</code></pre>

<p>Function <a href="../stdlib/gen_statem#start_link/3">stdlib/gen_statem#start_link/3</a> is synchronous. It does not return until the <em>gen_statem</em> is initialized and is ready to receive events.</p>
<p>Function <a href="../stdlib/gen_statem#start_link/3">stdlib/gen_statem#start_link/3</a> must be used if the <em>gen_statem</em> is part of a supervision tree, that is, started by a supervisor. Another function, <a href="../stdlib/gen_statem#start/3">stdlib/gen_statem#start/3</a> can be used to start a standalone <em>gen_statem</em> , that is, a <em>gen_statem</em> that is not part of a supervision tree.</p>
<p>Function <a href="../stdlib/gen_statem#Module:callback_mode/0">stdlib/gen_statem#Module:callback_mode/0</a> selects the <a href="#Callback Modes">Callback Modes</a> for the <strong>callback module</strong> , in this case <a href="../stdlib/gen_statem#type-callback_mode">stdlib/gen_statem#type-callback_mode</a> . That is, each state has got its own handler function:</p>
<pre><code class="erl">
callback_mode() -&gt;
    state_functions.

</code></pre>

<p><a name="Handling Events">Handling Events</a> </p>
<h3 id="handling-events">Handling Events</h3>
<p>The function notifying the code lock about a button event is implemented using <a href="../stdlib/gen_statem#cast/2">stdlib/gen_statem#cast/2</a> :</p>
<pre><code class="erl">
button(Button) -&gt;
    gen_statem:cast(?NAME, {button,Button}).

</code></pre>

<p>The first argument is the name of the <em>gen_statem</em> and must agree with the name used to start it. So, we use the same macro <em>?NAME</em> as when starting. <em>{button,Button}</em> is the event content.</p>
<p>The event is sent to the <em>gen_statem</em> . When the event is received, the <em>gen_statem</em> calls <em>StateName(cast, Event, Data)</em> , which is expected to return a tuple <em>{next_state, NewStateName, NewData}</em> , or <em>{next_state, NewStateName, NewData, Actions}</em> . <em>StateName</em> is the name of the current state and <em>NewStateName</em> is the name of the next state to go to. <em>NewData</em> is a new value for the server data of the <em>gen_statem</em> , and <em>Actions</em> is a list of actions to be performed by the <em>gen_statem</em> engine.</p>
<pre><code class="erl">
locked(
  cast, {button,Button},
  #{code := Code, length := Length, buttons := Buttons} = Data) -&gt;
    NewButtons =
        if
            length(Buttons) &lt; Length -&gt;
                Buttons;
            true -&gt;
                tl(Buttons)
        end ++ [Button],
    if
        NewButtons =:= Code -&gt; % Correct
        do_unlock(),
            {next_state, open, Data#{buttons := []},
             [{state_timeout,10000,lock}]}; % Time in milliseconds
    true -&gt; % Incomplete | Incorrect
            {next_state, locked, Data#{buttons := NewButtons}}
    end.

</code></pre>

<p>In state <em>locked</em> , when a button is pressed, it is collected with the last pressed buttons up to the length of the correct code, and compared with the correct code. Depending on the result, the door is either unlocked and the <em>gen_statem</em> goes to state <em>open</em> , or the door remains in state <em>locked</em> .</p>
<p>When changing to state <em>open</em> , the collected buttons are reset, the lock unlocked, and a state timer for 10 s is started.</p>
<pre><code class="erl">
open(cast, {button,_}, Data) -&gt;
    {next_state, open, Data}.

</code></pre>

<p>In state <em>open</em> , a button event is ignored by staying in the same state. This can also be done by returning <em>{keep_state, Data}</em> or in this case since <em>Data</em> unchanged even by returning <em>keep_state_and_data</em> .
 <a name="State Time-Outs">State Time-Outs</a> </p>
<h3 id="state-time-outs">State Time-Outs</h3>
<p>When a correct code has been given, the door is unlocked and the following tuple is returned from <em>locked/2</em> :</p>
<pre><code class="erl">
{next_state, open, Data#{buttons := []},
 [{state_timeout,10000,lock}]}; % Time in milliseconds

</code></pre>

<p>10,000 is a time-out value in milliseconds. After this time (10 seconds), a time-out occurs. Then, <em>StateName(state_timeout, lock, Data)</em> is called. The time-out occurs when the door has been in state <em>open</em> for 10 seconds. After that the door is locked again:</p>
<pre><code class="erl">
open(state_timeout, lock,  Data) -&gt;
    do_lock(),
    {next_state, locked, Data};

</code></pre>

<p>The timer for a state time-out is automatically cancelled when the state machine does a <strong>state change</strong> . You can restart a state time-out by setting it to a new time, which cancels the running timer and starts a new. This implies that you can cancel a state time-out by restarting it with time <em>infinity</em> .
 <a name="All State Events">All State Events</a> </p>
<h3 id="all-state-events">All State Events</h3>
<p>Sometimes events can arrive in any state of the <em>gen_statem</em> . It is convenient to handle these in a common state handler function that all state functions call for events not specific to the state.</p>
<p>Consider a <em>code_length/0</em> function that returns the length of the correct code. We dispatch all events that are not state-specific to the common function <em>handle_common/3</em> :</p>
<pre><code class="erl">
...
-export([button/1,code_length/0]).
...

code_length() -&gt;
    gen_statem:call(?NAME, code_length).

...
locked(...) -&gt; ... ;
locked(EventType, EventContent, Data) -&gt;
    handle_common(EventType, EventContent, Data).

...
open(...) -&gt; ... ;
open(EventType, EventContent, Data) -&gt;
    handle_common(EventType, EventContent, Data).

handle_common({call,From}, code_length, #{code := Code} = Data) -&gt;
    {keep_state, Data,
     [{reply,From,length(Code)}]}.

</code></pre>

<p>Another way to do it is through a convenience macro <em>?HANDLE_COMMON/0</em> :</p>
<pre><code class="erl">
...
-export([button/1,code_length/0]).
...

code_length() -&gt;
    gen_statem:call(?NAME, code_length).

-define(HANDLE_COMMON,
    ?FUNCTION_NAME(T, C, D) -&gt; handle_common(T, C, D)).
%%
handle_common({call,From}, code_length, #{code := Code} = Data) -&gt;
    {keep_state, Data,
     [{reply,From,length(Code)}]}.

...
locked(...) -&gt; ... ;
?HANDLE_COMMON.

...
open(...) -&gt; ... ;
?HANDLE_COMMON.

</code></pre>

<p>This example uses <a href="../stdlib/gen_statem#call/2">stdlib/gen_statem#call/2</a> , which waits for a reply from the server. The reply is sent with a <em>{reply,From,Reply}</em> tuple in an action list in the <em>{keep_state, ...}</em> tuple that retains the current state. This return form is convenient when you want to stay in the current state but do not know or care about what it is.</p>
<p>If the common <strong>state callback</strong> needs to know the current state a function <em>handle_common/4</em> can be used instead:</p>
<pre><code class="erl">
-define(HANDLE_COMMON,
    ?FUNCTION_NAME(T, C, D) -&gt; handle_common(T, C, ?FUNCTION_NAME, D)).

</code></pre>

<p><a name="One State Callback">One State Callback</a> </p>
<h3 id="one-state-callback">One State Callback</h3>
<p>If <a href="#Callback Modes">Callback Modes</a> <em>handle_event_function</em> is used, all events are handled in <a href="../stdlib/gen_statem#Module:handle_event/4">stdlib/gen_statem#Module:handle_event/4</a> and we can (but do not have to) use an event-centered approach where we first branch depending on event and then depending on state:</p>
<pre><code class="erl">
...
-export([handle_event/4]).

...
callback_mode() -&gt;
    handle_event_function.

handle_event(cast, {button,Button}, State, #{code := Code} = Data) -&gt;
    case State of
    locked -&gt;
            #{length := Length, buttons := Buttons} = Data,
            NewButtons =
                if
                    length(Buttons) &lt; Length -&gt;
                        Buttons;
                    true -&gt;
                        tl(Buttons)
                end ++ [Button],
            if
                NewButtons =:= Code -&gt; % Correct
                    do_unlock(),
                    {next_state, open, Data#{buttons := []},
                     [{state_timeout,10000,lock}]}; % Time in milliseconds
                true -&gt; % Incomplete | Incorrect
                    {keep_state, Data#{buttons := NewButtons}}
            end;
    open -&gt;
            keep_state_and_data
    end;
handle_event(state_timeout, lock, open, Data) -&gt;
    do_lock(),
    {next_state, locked, Data};
handle_event(
  {call,From}, code_length, _State, #{code := Code} = Data) -&gt;
    {keep_state, Data,
     [{reply,From,length(Code)}]}.

...

</code></pre>

<p><a name="Stopping">Stopping</a> </p>
<h3 id="stopping_1">Stopping</h3>
<p><a name="In a Supervision Tree">In a Supervision Tree</a> </p>
<h3 id="in-a-supervision-tree_1">In a Supervision Tree</h3>
<p>If the <em>gen_statem</em> is part of a supervision tree, no stop function is needed. The <em>gen_statem</em> is automatically terminated by its supervisor. Exactly how this is done is defined by a <a href="./sup_princ#shutdown">shutdown strategy</a> set in the supervisor.</p>
<p>If it is necessary to clean up before termination, the shutdown strategy must be a time-out value and the <em>gen_statem</em> must in function <em>init/1</em> set itself to trap exit signals by calling <a href="../erts/erlang#process_flag/2">erts/erlang#process_flag/2</a> :</p>
<pre><code class="erl">
init(Args) -&gt;
    process_flag(trap_exit, true),
    do_lock(),
    ...

</code></pre>

<p>When ordered to shut down, the <em>gen_statem</em> then calls callback function <em>terminate(shutdown, State, Data)</em> .</p>
<p>In this example, function <em>terminate/3</em> locks the door if it is open, so we do not accidentally leave the door open when the supervision tree terminates:</p>
<pre><code class="erl">
terminate(_Reason, State, _Data) -&gt;
    State =/= locked andalso do_lock(),
    ok.

</code></pre>

<p><a name="Standalone gen_statem">Standalone gen_statem</a> </p>
<h3 id="standalone-gen_statem">Standalone gen_statem</h3>
<p>If the <em>gen_statem</em> is not part of a supervision tree, it can be stopped using <a href="../stdlib/gen_statem#stop/1">stdlib/gen_statem#stop/1</a> , preferably through an API function:</p>
<pre><code class="erl">
...
-export([start_link/1,stop/0]).

...
stop() -&gt;
    gen_statem:stop(?NAME).

</code></pre>

<p>This makes the <em>gen_statem</em> call callback function <em>terminate/3</em> just like for a supervised server and waits for the process to terminate.
 <a name="Event Time-Outs">Event Time-Outs</a> </p>
<h3 id="event-time-outs">Event Time-Outs</h3>
<p>A time-out feature inherited from <em>gen_statem</em> 's predecessor <a href="./gen_fsm">stdlib/gen_fsm</a> , is an event time-out, that is, if an event arrives the timer is cancelled. You get either an event or a time-out, but not both.</p>
<p>It is ordered by the <a href="#Transition Actions">Transition Actions</a> <em>{timeout,Time,EventContent}</em> , or just an integer <em>Time</em> , even without the enclosing actions list (the latter is a form inherited from <em>gen_fsm</em> .</p>
<p>This type of time-out is useful for example to act on inactivity. Let us restart the code sequence if no button is pressed for say 30 seconds:</p>
<pre><code class="erl">
...

locked(timeout, _, Data) -&gt;
    {next_state, locked, Data#{buttons := []}};
locked(
  cast, {button,Button},
  #{code := Code, length := Length, buttons := Buttons} = Data) -&gt;
...
    true -&gt; % Incomplete | Incorrect
            {next_state, locked, Data#{buttons := NewButtons},
             30000} % Time in milliseconds
...

</code></pre>

<p>Whenever we receive a button event we start an event time-out of 30 seconds, and if we get an <strong>event type</strong> of <em>timeout</em> we reset the remaining code sequence.</p>
<p>An event time-out is cancelled by any other event so you either get some other event or the time-out event. It is therefore not possible nor needed to cancel or restart an event time-out. Whatever event you act on has already cancelled the event time-out...</p>
<p>Note that an event time-out does not work well with when you have for example a status call as in section <a href="#All State Events">All State Events</a> , or handle unknown events, since all kinds of events will cancel the event time-out.
 <a name="Generic Time-Outs">Generic Time-Outs</a> </p>
<h3 id="generic-time-outs">Generic Time-Outs</h3>
<p>The previous example of state time-outs only work if the state machine stays in the same state during the time-out time. And event time-outs only work if no disturbing unrelated events occur.</p>
<p>You may want to start a timer in one state and respond to the time-out in another, maybe cancel the time-out without changing states, or perhaps run multiple time-outs in parallel. All this can be accomplished with <a href="../stdlib/gen_statem#type-generic_timeout">generic time-outs</a> . They may look a little bit like <a href="../stdlib/gen_statem#type-event_timeout">event time-outs</a> but contain a name to allow for any number of them simultaneously and they are not automatically cancelled.</p>
<p>Here is how to accomplish the state time-out in the previous example by instead using a generic time-out named for example <em>open</em> :</p>
<pre><code class="erl">
...
locked(
  cast, {button,Button},
  #{code := Code, length := Length, buttons := Buttons} = Data) -&gt;
...
    if
        NewButtons =:= Code -&gt; % Correct
        do_unlock(),
            {next_state, open, Data#{buttons := []},
             [{{timeout,open},10000,lock}]}; % Time in milliseconds
...

open({timeout,open}, lock, Data) -&gt;
    do_lock(),
    {next_state,locked,Data};
open(cast, {button,_}, Data) -&gt;
    {keep_state,Data};
...

</code></pre>

<p>Specific generic time-outs can just as <a href="#State Time-Outs">state time-outs</a> be restarted or cancelled by setting it to a new time or <em>infinity</em> .</p>
<p>In this particular case we do not need to cancel the time-out since the time-out event is the only possible reason to do a <strong>state change</strong> from <em>open</em> to <em>locked</em> .</p>
<p>Instead of bothering with when to cancel a time-out, a late time-out event can be handled by ignoring it if it arrives in a state where it is known to be late.
 <a name="Erlang Timers">Erlang Timers</a> </p>
<h3 id="erlang-timers">Erlang Timers</h3>
<p>The most versatile way to handle time-outs is to use Erlang Timers; see <a href="../erts/erlang#start_timer/4">erts/erlang#start_timer/4</a> . Most time-out tasks can be performed with the time-out features in <em>gen_statem</em> , but an example of one that cannot is if you should need the return value from <a href="../erts/erlang#cancel_timer/2">erts/erlang#cancel_timer/2</a> , that is; the remaining time of the timer.</p>
<p>Here is how to accomplish the state time-out in the previous example by instead using an Erlang Timer:</p>
<pre><code class="erl">
...
locked(
  cast, {button,Button},
  #{code := Code, length := Length, buttons := Buttons} = Data) -&gt;
...
    if
        NewButtons =:= Code -&gt; % Correct
        do_unlock(),
        Tref =
                 erlang:start_timer(
                     10000, self(), lock), % Time in milliseconds
            {next_state, open, Data#{buttons := [], timer =&gt; Tref}};
...

open(info, {timeout,Tref,lock}, #{timer := Tref} = Data) -&gt;
    do_lock(),
    {next_state,locked,maps:remove(timer, Data)};
open(cast, {button,_}, Data) -&gt;
    {keep_state,Data};
...

</code></pre>

<p>Removing the <em>timer</em> key from the map when we do a <strong>state change</strong> to <em>locked</em> is not strictly necessary since we can only get into state <em>open</em> with an updated <em>timer</em> map value. But it can be nice to not have outdated values in the state <em>Data</em> !</p>
<p>If you need to cancel a timer because of some other event, you can use <a href="../erts/erlang#cancel_timer/2">erts/erlang#cancel_timer/2</a> . Note that a time-out message cannot arrive after this, unless you have postponed it before (see the next section), so ensure that you do not accidentally postpone such messages. Also note that a time-out message may have arrived just before you cancelling it, so you may have to read out such a message from the process mailbox depending on the return value from <a href="../erts/erlang#cancel_timer/2">erts/erlang#cancel_timer/2</a> .</p>
<p>Another way to handle a late time-out can be to not cancel it, but to ignore it if it arrives in a state where it is known to be late.
 <a name="Postponing Events">Postponing Events</a> </p>
<h3 id="postponing-events">Postponing Events</h3>
<p>If you want to ignore a particular event in the current state and handle it in a future state, you can postpone the event. A postponed event is retried after a <strong>state change</strong> , that is, <em>OldState =/= NewState</em> .</p>
<p>Postponing is ordered by the <a href="#Transition Actions">Transition Actions</a> <em>postpone</em> .</p>
<p>In this example, instead of ignoring button events while in the <em>open</em> state, we can postpone them and they are queued and later handled in the <em>locked</em> state:</p>
<pre><code class="erl">
...
open(cast, {button,_}, Data) -&gt;
    {keep_state,Data,[postpone]};
...

</code></pre>

<p>Since a postponed event is only retried after a <strong>state change</strong> , you have to think about where to keep a state data item. You can keep it in the server <em>Data</em> or in the <em>State</em> itself, for example by having two more or less identical states to keep a boolean value, or by using a complex state (see section <a href="#Complex State">Complex State</a> ) with <a href="#Callback Modes">Callback Modes</a> <a href="../stdlib/gen_statem#type-callback_mode">stdlib/gen_statem#type-callback_mode</a> . If a change in the value changes the set of events that is handled, then the value should be kept in the State. Otherwise no postponed events will be retried since only the server Data changes.</p>
<p>This is not important if you do not postpone events. But if you later decide to start postponing some events, then the design flaw of not having separate states when they should be, might become a hard to find bug.
 <a name="Fuzzy State Diagrams">Fuzzy State Diagrams</a> </p>
<h3 id="fuzzy-state-diagrams">Fuzzy State Diagrams</h3>
<p>It is not uncommon that a state diagram does not specify how to handle events that are not illustrated in a particular state in the diagram. Hopefully this is described in an associated text or from the context.</p>
<p>Possible actions: ignore as in drop the event (maybe log it) or deal with the event in some other state as in postpone it.
 <a name="Selective Receive">Selective Receive</a> </p>
<h3 id="selective-receive">Selective Receive</h3>
<p>Erlang's selective receive statement is often used to describe simple state machine examples in straightforward Erlang code. The following is a possible implementation of the first example:</p>
<pre><code class="erl">
-module(code_lock).
-define(NAME, code_lock_1).
-export([start_link/1,button/1]).

start_link(Code) -&gt;
    spawn(
      fun () -&gt;
          true = register(?NAME, self()),
          do_lock(),
          locked(Code, length(Code), [])
      end).

button(Button) -&gt;
    ?NAME ! {button,Button}.

</code></pre>

<pre><code class="erl">
locked(Code, Length, Buttons) -&gt;
    receive
        {button,Button} -&gt;
            NewButtons =
                if
                    length(Buttons) &lt; Length -&gt;
                        Buttons;
                    true -&gt;
                        tl(Buttons)
                end ++ [Button],
            if
                NewButtons =:= Code -&gt; % Correct
                    do_unlock(),
            open(Code, Length);
                true -&gt; % Incomplete | Incorrect
                    locked(Code, Length, NewButtons)
            end
    end.

</code></pre>

<pre><code class="erl">
open(Code, Length) -&gt;
    receive
    after 10000 -&gt; % Time in milliseconds
        do_lock(),
        locked(Code, Length, [])
    end.

do_lock() -&gt;
    io:format(&quot;Locked~n&quot;, []).
do_unlock() -&gt;
    io:format(&quot;Open~n&quot;, []).

</code></pre>

<p>The selective receive in this case causes implicitly <em>open</em> to postpone any events to the <em>locked</em> state.</p>
<p>A selective receive cannot be used from a <em>gen_statem</em> behavior as for any *gen_<strong> behavior, as the receive statement is within the *gen_</strong> engine itself. It must be there because all <a href="./sys">stdlib/sys</a> compatible behaviors must respond to system messages and therefore do that in their engine receive loop, passing non-system messages to the <strong>callback module</strong> .</p>
<p>The <a href="#Transition Actions">Transition Actions</a> <em>postpone</em> is designed to model selective receives. A selective receive implicitly postpones any not received events, but the <em>postpone</em> <strong>transition action</strong> explicitly postpones one received event.</p>
<p>Both mechanisms have the same theoretical time and memory complexity, while the selective receive language construct has smaller constant factors.
 <a name="State Enter Actions">State Enter Actions</a> </p>
<h3 id="state-enter-actions">State Enter Actions</h3>
<p>Say you have a state machine specification that uses state enter actions. Allthough you can code this using inserted events (described in the next section), especially if just one or a few states has got state enter actions, this is a perfect use case for the built in <a href="#State Enter Calls">State Enter Calls</a> .</p>
<p>You return a list containing <em>state_enter</em> from your <a href="../stdlib/gen_statem#Module:callback_mode/0">stdlib/gen_statem#Module:callback_mode/0</a> function and the <em>gen_statem</em> engine will call your <strong>state callback</strong> once with an event <em>(enter, OldState, ...)</em> whenever it does a <strong>state change</strong> . Then you just need to handle these event-like calls in all states.</p>
<pre><code class="erl">
...
init(Code) -&gt;
    process_flag(trap_exit, true),
    Data = #{code =&gt; Code, length = length(Code)},
    {ok, locked, Data}.

callback_mode() -&gt;
    [state_functions,state_enter].

locked(enter, _OldState, Data) -&gt;
    do_lock(),
    {keep_state,Data#{buttons =&gt; []}};
locked(
  cast, {button,Button},
  #{code := Code, length := Length, buttons := Buttons} = Data) -&gt;
...
    if
        NewButtons =:= Code -&gt; % Correct
            {next_state, open, Data};
...

open(enter, _OldState, _Data) -&gt;
    do_unlock(),
    {keep_state_and_data,
     [{state_timeout,10000,lock}]}; % Time in milliseconds
open(state_timeout, lock, Data) -&gt;
    {next_state, locked, Data};
...

</code></pre>

<p>You can repeat the state enter code by returning one of <em>{repeat_state, ...}</em> , <em>{repeat_state_and_data,_}</em> or <em>repeat_state_and_data</em> that otherwise behaves exactly like their <em>keep_state</em> siblings. See the type <a href="../stdlib/gen_statem#type-state_callback_result">stdlib/gen_statem#type-state_callback_result</a> in the reference manual.
 <a name="Inserted Events">Inserted Events</a> </p>
<h3 id="inserted-events">Inserted Events</h3>
<p>It can sometimes be beneficial to be able to generate events to your own state machine. This can be done with the <a href="#Transition Actions">Transition Actions</a> <em>{next_event,EventType,EventContent}</em> .</p>
<p>You can generate events of any existing <a href="../stdlib/gen_statem#type-action">type</a> , but the <em>internal</em> type can only be generated through action <em>next_event</em> . Hence, it cannot come from an external source, so you can be certain that an <em>internal</em> event is an event from your state machine to itself.</p>
<p>One example for this is to pre-process incoming data, for example decrypting chunks or collecting characters up to a line break.</p>
<p>Purists may argue that this should be modelled with a separate state machine that sends pre-processed events to the main state machine, but to decrease overhead the small pre-processing state machine can be implemented in the common state event handling of the main state machine using a few state data variables that then sends the pre-processed events as internal events to the main state machine. Using internal events also can make it easier to synchronize the state machines.</p>
<p>A variant of this is to use a <a href="#Complex State">complex state</a> with <a href="#One State Callback">One State Callback</a> . The state is then modeled with for example a tuple <em>{MainFSMState,SubFSMState}</em> .</p>
<p>To illustrate this we make up an example where the buttons instead generate down and up (press and release) events, and the lock responds to an up event only after the corresponding down event.</p>
<pre><code class="erl">
...
-export([down/1, up/1]).
...
down(Button) -&gt;
    gen_statem:cast(?NAME, {down,Button}).

up(Button) -&gt;
    gen_statem:cast(?NAME, {up,Button}).

...

locked(enter, _OldState, Data) -&gt;
    do_lock(),
    {keep_state,Data#{buttons =&gt; []}};
locked(
  internal, {button,Button},
  #{code := Code, length := Length, buttons := Buttons} = Data) -&gt;
...

</code></pre>

<pre><code class="erl">
handle_common(cast, {down,Button}, Data) -&gt;
    {keep_state, Data#{button =&gt; Button}};
handle_common(cast, {up,Button}, Data) -&gt;
    case Data of
        #{button := Button} -&gt;
            {keep_state,maps:remove(button, Data),
             [{next_event,internal,{button,Button}}]};
        #{} -&gt;
            keep_state_and_data
    end;
...

open(internal, {button,_}, Data) -&gt;
    {keep_state,Data,[postpone]};
...

</code></pre>

<p>If you start this program with <em>code_lock:start([17])</em> you can unlock with <em>code_lock:down(17), code_lock:up(17).</em>
 <a name="Example Revisited">Example Revisited</a> </p>
<h3 id="example-revisited">Example Revisited</h3>
<p>This section includes the example after most of the mentioned modifications and some more using <strong>state enter calls</strong> , which deserves a new state diagram:
 <img alt="Code Lock State Diagram Revisited" src="../code_lock_2.svg" /> 
Notice that this state diagram does not specify how to handle a button event in the state <em>open</em> . So, you need to read in some side notes, that is, here: that unspecified events shall be postponed (handled in some later state). Also, the state diagram does not show that the <em>code_length/0</em> call must be handled in every state.
 <a name="Callback Mode: state_functions">Callback Mode: state_functions</a> </p>
<h3 id="callback-mode-state_functions">Callback Mode: state_functions</h3>
<p>Using state functions:</p>
<pre><code class="erl">
-module(code_lock).
-behaviour(gen_statem).
-define(NAME, code_lock_2).

-export([start_link/1,stop/0]).
-export([down/1,up/1,code_length/0]).
-export([init/1,callback_mode/0,terminate/3]).
-export([locked/3,open/3]).

start_link(Code) -&gt;
    gen_statem:start_link({local,?NAME}, ?MODULE, Code, []).
stop() -&gt;
    gen_statem:stop(?NAME).

down(Button) -&gt;
    gen_statem:cast(?NAME, {down,Button}).
up(Button) -&gt;
    gen_statem:cast(?NAME, {up,Button}).
code_length() -&gt;
    gen_statem:call(?NAME, code_length).

</code></pre>

<pre><code class="erl">
init(Code) -&gt;
    process_flag(trap_exit, true),
    Data = #{code =&gt; Code, length =&gt; length(Code), buttons =&gt; []},
    {ok, locked, Data}.

callback_mode() -&gt;
    [state_functions,state_enter].

-define(HANDLE_COMMON,
    ?FUNCTION_NAME(T, C, D) -&gt; handle_common(T, C, D)).
%%
handle_common(cast, {down,Button}, Data) -&gt;
    {keep_state, Data#{button =&gt; Button}};
handle_common(cast, {up,Button}, Data) -&gt;
    case Data of
        #{button := Button} -&gt;
            {keep_state, maps:remove(button, Data),
             [{next_event,internal,{button,Button}}]};
        #{} -&gt;
            keep_state_and_data
    end;
handle_common({call,From}, code_length, #{code := Code}) -&gt;
    {keep_state_and_data,
     [{reply,From,length(Code)}]}.

</code></pre>

<pre><code class="erl">
locked(enter, _OldState, Data) -&gt;
    do_lock(),
    {keep_state, Data#{buttons := []}};
locked(state_timeout, button, Data) -&gt;
    {keep_state, Data#{buttons := []}};
locked(
  internal, {button,Button},
  #{code := Code, length := Length, buttons := Buttons} = Data) -&gt;
    NewButtons =
        if
            length(Buttons) &lt; Length -&gt;
                Buttons;
            true -&gt;
                tl(Buttons)
        end ++ [Button],
    if
        NewButtons =:= Code -&gt; % Correct
            {next_state, open, Data};
    true -&gt; % Incomplete | Incorrect
            {keep_state, Data#{buttons := NewButtons},
             [{state_timeout,30000,button}]} % Time in milliseconds
    end;
?HANDLE_COMMON.

</code></pre>

<pre><code class="erl">
open(enter, _OldState, _Data) -&gt;
    do_unlock(),
    {keep_state_and_data,
     [{state_timeout,10000,lock}]}; % Time in milliseconds
open(state_timeout, lock, Data) -&gt;
    {next_state, locked, Data};
open(internal, {button,_}, _) -&gt;
    {keep_state_and_data, [postpone]};
?HANDLE_COMMON.

do_lock() -&gt;
    io:format(&quot;Locked~n&quot;, []).
do_unlock() -&gt;
    io:format(&quot;Open~n&quot;, []).

terminate(_Reason, State, _Data) -&gt;
    State =/= locked andalso do_lock(),
    ok.

</code></pre>

<p><a name="Callback Mode: handle_event_function">Callback Mode: handle_event_function</a> </p>
<h3 id="callback-mode-handle_event_function">Callback Mode: handle_event_function</h3>
<p>This section describes what to change in the example to use one <em>handle_event/4</em> function. The previously used approach to first branch depending on event does not work that well here because of the <strong>state enter calls</strong> , so this example first branches depending on state:</p>
<pre><code class="erl">
-export([handle_event/4]).

</code></pre>

<pre><code class="erl">
callback_mode() -&gt;
    [handle_event_function,state_enter].

</code></pre>

<pre><code class="erl">
%%
%% State: locked
handle_event(enter, _OldState, locked, Data) -&gt;
    do_lock(),
    {keep_state, Data#{buttons := []}};
handle_event(state_timeout, button, locked, Data) -&gt;
    {keep_state, Data#{buttons := []}};
handle_event(
  internal, {button,Button}, locked,
  #{code := Code, length := Length, buttons := Buttons} = Data) -&gt;
    NewButtons =
        if
            length(Buttons) &lt; Length -&gt;
                Buttons;
            true -&gt;
                tl(Buttons)
        end ++ [Button],
    if
        NewButtons =:= Code -&gt; % Correct
            {next_state, open, Data};
    true -&gt; % Incomplete | Incorrect
            {keep_state, Data#{buttons := NewButtons},
             [{state_timeout,30000,button}]} % Time in milliseconds
    end;

</code></pre>

<pre><code class="erl">
%%
%% State: open
handle_event(enter, _OldState, open, _Data) -&gt;
    do_unlock(),
    {keep_state_and_data,
     [{state_timeout,10000,lock}]}; % Time in milliseconds
handle_event(state_timeout, lock, open, Data) -&gt;
    {next_state, locked, Data};
handle_event(internal, {button,_}, open, _) -&gt;
    {keep_state_and_data,[postpone]};

</code></pre>

<pre><code class="erl">
%% Common events
handle_event(cast, {down,Button}, _State, Data) -&gt;
    {keep_state, Data#{button =&gt; Button}};
handle_event(cast, {up,Button}, _State, Data) -&gt;
    case Data of
        #{button := Button} -&gt;
            {keep_state, maps:remove(button, Data),
             [{next_event,internal,{button,Button}},
              {state_timeout,30000,button}]}; % Time in milliseconds
        #{} -&gt;
            keep_state_and_data
    end;
handle_event({call,From}, code_length, _State, #{length := Length}) -&gt;
    {keep_state_and_data,
     [{reply,From,Length}]}.

</code></pre>

<p>Notice that postponing buttons from the <em>open</em> state to the <em>locked</em> state feels like a strange thing to do for a code lock, but it at least illustrates event postponing.
 <a name="Filter the State">Filter the State</a> </p>
<h3 id="filter-the-state">Filter the State</h3>
<p>The example servers so far in this chapter print the full internal state in the error log, for example, when killed by an exit signal or because of an internal error. This state contains both the code lock code and which digits that remain to unlock.</p>
<p>This state data can be regarded as sensitive, and maybe not what you want in the error log because of some unpredictable event.</p>
<p>Another reason to filter the state can be that the state is too large to print, as it fills the error log with uninteresting details.</p>
<p>To avoid this, you can format the internal state that gets in the error log and gets returned from <a href="../stdlib/sys#get_status/1">stdlib/sys#get_status/1</a> by implementing function <a href="../stdlib/gen_statem#Module:format_status/2">stdlib/gen_statem#Module:format_status/2</a> , for example like this:</p>
<pre><code class="erl">
...
-export([init/1,terminate/3,format_status/2]).
...

format_status(Opt, [_PDict,State,Data]) -&gt;
    StateData =
    {State,
     maps:filter(
       fun (code, _) -&gt; false;
           (_, _) -&gt; true
       end,
       Data)},
    case Opt of
    terminate -&gt;
        StateData;
    normal -&gt;
        [{data,[{&quot;State&quot;,StateData}]}]
    end.

</code></pre>

<p>It is not mandatory to implement a <a href="../stdlib/gen_statem#Module:format_status/2">stdlib/gen_statem#Module:format_status/2</a> function. If you do not, a default implementation is used that does the same as this example function without filtering the <em>Data</em> term, that is, <em>StateData = {State,Data}</em> , in this example containing sensitive information.
 <a name="Complex State">Complex State</a> </p>
<h3 id="complex-state">Complex State</h3>
<p>The <strong>callback mode</strong> <a href="../stdlib/gen_statem#type-callback_mode">stdlib/gen_statem#type-callback_mode</a> enables using a non-atom state as described in section <a href="#Callback Modes">Callback Modes</a> , for example, a complex state term like a tuple.</p>
<p>One reason to use this is when you have a state item that when changed should cancel the <a href="#State Time-Outs">state time-out</a> , or one that affects the event handling in combination with postponing events. We will go for the latter and complicate the previous example by introducing a configurable lock button (this is the state item in question), which in the <em>open</em> state immediately locks the door, and an API function <em>set_lock_button/1</em> to set the lock button.</p>
<p>Suppose now that we call <em>set_lock_button</em> while the door is open, and we have already postponed a button event that was the new lock button:</p>
<pre><code class="erl">
1&gt; code_lock:start_link([a,b,c], x).
{ok,&lt;0.666.0&gt;}
2&gt; code_lock:button(a).
ok
3&gt; code_lock:button(b).
ok
4&gt; code_lock:button(c).
ok
Open
5&gt; code_lock:button(y).
ok
6&gt; code_lock:set_lock_button(y).
x
% What should happen here?  Immediate lock or nothing?

</code></pre>

<p>We could say that the button was pressed too early so it is not to be recognized as the lock button. Or we can make the lock button part of the state so when we then change the lock button in the locked state, the change becomes a <strong>state change</strong> and all postponed events are retried, therefore the lock is immediately locked!</p>
<p>We define the state as <em>{StateName,LockButton}</em> , where <em>StateName</em> is as before and <em>LockButton</em> is the current lock button:</p>
<pre><code class="erl">
-module(code_lock).
-behaviour(gen_statem).
-define(NAME, code_lock_3).

-export([start_link/2,stop/0]).
-export([button/1,set_lock_button/1]).
-export([init/1,callback_mode/0,terminate/3]).
-export([handle_event/4]).

start_link(Code, LockButton) -&gt;
    gen_statem:start_link(
        {local,?NAME}, ?MODULE, {Code,LockButton}, []).
stop() -&gt;
    gen_statem:stop(?NAME).

button(Button) -&gt;
    gen_statem:cast(?NAME, {button,Button}).
set_lock_button(LockButton) -&gt;
    gen_statem:call(?NAME, {set_lock_button,LockButton}).

</code></pre>

<pre><code class="erl">
init({Code,LockButton}) -&gt;
    process_flag(trap_exit, true),
    Data = #{code =&gt; Code, length =&gt; length(Code), buttons =&gt; []},
    {ok, {locked,LockButton}, Data}.

callback_mode() -&gt;
    [handle_event_function,state_enter].

%% State: locked
handle_event(enter, _OldState, {locked,_}, Data) -&gt;
    do_lock(),
    {keep_state, Data#{buttons := []}};
handle_event(state_timeout, button, {locked,_}, Data) -&gt;
    {keep_state, Data#{buttons := []}};
handle_event(
  cast, {button,Button}, {locked,LockButton},
  #{code := Code, length := Length, buttons := Buttons} = Data) -&gt;
    NewButtons =
        if
            length(Buttons) &lt; Length -&gt;
                Buttons;
            true -&gt;
                tl(Buttons)
        end ++ [Button],
    if
        NewButtons =:= Code -&gt; % Correct
            {next_state, {open,LockButton}, Data};
    true -&gt; % Incomplete | Incorrect
            {keep_state, Data#{buttons := NewButtons},
             [{state_timeout,30000,button}]} % Time in milliseconds
    end;

</code></pre>

<pre><code class="erl">
%%
%% State: open
handle_event(enter, _OldState, {open,_}, _Data) -&gt;
    do_unlock(),
    {keep_state_and_data,
     [{state_timeout,10000,lock}]}; % Time in milliseconds
handle_event(state_timeout, lock, {open,LockButton}, Data) -&gt;
    {next_state, {locked,LockButton}, Data};
handle_event(cast, {button,LockButton}, {open,LockButton}, Data) -&gt;
    {next_state, {locked,LockButton}, Data};
handle_event(cast, {button,_}, {open,_}, _Data) -&gt;
    {keep_state_and_data,[postpone]};

</code></pre>

<pre><code class="erl">
%%
%% Common events
handle_event(
  {call,From}, {set_lock_button,NewLockButton},
  {StateName,OldLockButton}, Data) -&gt;
    {next_state, {StateName,NewLockButton}, Data,
     [{reply,From,OldLockButton}]}.

</code></pre>

<pre><code class="erl">
do_lock() -&gt;
    io:format(&quot;Locked~n&quot;, []).
do_unlock() -&gt;
    io:format(&quot;Open~n&quot;, []).

terminate(_Reason, State, _Data) -&gt;
    State =/= locked andalso do_lock(),
    ok.

</code></pre>

<p><a name="Hibernation">Hibernation</a> </p>
<h3 id="hibernation">Hibernation</h3>
<p>If you have many servers in one node and they have some state(s) in their lifetime in which the servers can be expected to idle for a while, and the amount of heap memory all these servers need is a problem, then the memory footprint of a server can be mimimized by hibernating it through <a href="../stdlib/proc_lib#hibernate/3">stdlib/proc_lib#hibernate/3</a> .</p>
<div class="admonition info">
<p class="admonition-title">Note</p>
</div>
<p>It is rather costly to hibernate a process; see <a href="../erts/erlang#hibernate/3">erts/erlang#hibernate/3</a> . It is not something you want to do after every event.</p>
<p>We can in this example hibernate in the <em>{open,_}</em> state, because what normally occurs in that state is that the state time-out after a while triggers a transition to <em>{locked,_}</em> :</p>
<pre><code class="erl">
...
%%
%% State: open
handle_event(enter, _OldState, {open,_}, _Data) -&gt;
    do_unlock(),
    {keep_state_and_data,
     [{state_timeout,10000,lock}, % Time in milliseconds
      hibernate]};
...

</code></pre>

<p>The atom <a href="../stdlib/gen_statem#type-hibernate">stdlib/gen_statem#type-hibernate</a> in the action list on the last line when entering the <em>{open,_}</em> state is the only change. If any event arrives in the <em>{open,_},</em> state, we do not bother to rehibernate, so the server stays awake after any event.</p>
<p>To change that we would need to insert action <em>hibernate</em> in more places. For example, the state-independent <em>set_lock_button</em> operation would have to use <em>hibernate</em> but only in the <em>{open,_}</em> state, which would clutter the code.</p>
<p>Another not uncommon scenario is to use the <a href="#Event Time-Outs">event time-out</a> to trigger hibernation after a certain time of inactivity. There is also a server start option <a href="../stdlib/gen_statem#type-enter_loop_opt">stdlib/gen_statem#type-enter_loop_opt</a> for <a href="../stdlib/gen_statem#start/3">stdlib/gen_statem#start/3</a> , <a href="../stdlib/gen_statem#start_link/3">stdlib/gen_statem#start_link/3</a> or <a href="../stdlib/gen_statem#enter_loop/4">stdlib/gen_statem#enter_loop/4</a> that may be used to automatically hibernate the server.</p>
<p>This particular server probably does not use heap memory worth hibernating for. To gain anything from hibernation, your server would have to produce non-insignificant garbage during callback execution, for which this example server can serve as a bad example.
<a name="gen_event">gen_event</a> 
This section is to be read with the <em>gen_event(3)</em> manual page in STDLIB, where all interface functions and callback functions are described in detail.</p>
<h3 id="event-handling-principles">Event Handling Principles</h3>
<p>In OTP, an <strong>event manager</strong> is a named object to which events can be sent. An <strong>event</strong> can be, for example, an error, an alarm, or some information that is to be logged.</p>
<p>In the event manager, zero, one, or many <strong>event handlers</strong> are installed. When the event manager is notified about an event, the event is processed by all the installed event handlers. For example, an event manager for handling errors can by default have a handler installed, which writes error messages to the terminal. If the error messages during a certain period is to be saved to a file as well, the user adds another event handler that does this. When logging to the file is no longer necessary, this event handler is deleted.</p>
<p>An event manager is implemented as a process and each event handler is implemented as a callback module.</p>
<p>The event manager essentially maintains a list of <em>{Module, State}</em> pairs, where each <em>Module</em> is an event handler, and <em>State</em> is the internal state of that event handler.</p>
<h3 id="example_2">Example</h3>
<p>The callback module for the event handler writing error messages to the terminal can look as follows:</p>
<pre><code>
-module(terminal_logger).
-behaviour(gen_event).

-export([init/1, handle_event/2, terminate/2]).

init(_Args) -&gt;
    {ok, []}.

handle_event(ErrorMsg, State) -&gt;
    io:format(&quot;***Error*** ~p~n&quot;, [ErrorMsg]),
    {ok, State}.

terminate(_Args, _State) -&gt;
    ok.
</code></pre>

<p>The callback module for the event handler writing error messages to a file can look as follows:</p>
<pre><code>
-module(file_logger).
-behaviour(gen_event).

-export([init/1, handle_event/2, terminate/2]).

init(File) -&gt;
    {ok, Fd} = file:open(File, read),
    {ok, Fd}.

handle_event(ErrorMsg, Fd) -&gt;
    io:format(Fd, &quot;***Error*** ~p~n&quot;, [ErrorMsg]),
    {ok, Fd}.

terminate(_Args, Fd) -&gt;
    file:close(Fd).
</code></pre>

<p>The code is explained in the next sections.
 <a name="mgr">mgr</a> </p>
<h3 id="starting-an-event-manager">Starting an Event Manager</h3>
<p>To start an event manager for handling errors, as described in the previous example, call the following function:</p>
<pre><code>
gen_event:start_link({local, error_man})
</code></pre>

<p>This function spawns and links to a new process, an event manager.</p>
<p>The argument, <em>{local, error_man}</em> specifies the name. The event manager is then locally registered as <em>error_man</em> .</p>
<p>If the name is omitted, the event manager is not registered. Instead its pid must be used. The name can also be given as <em>{global, Name}</em> , in which case the event manager is registered using <em>global:register_name/2</em> .</p>
<p><em>gen_event:start_link</em> must be used if the event manager is part of a supervision tree, that is, started by a supervisor. There is another function, <em>gen_event:start</em> , to start a standalone event manager, that is, an event manager that is not part of a supervision tree.</p>
<h3 id="adding-an-event-handler">Adding an Event Handler</h3>
<p>The following example shows how to start an event manager and add an event handler to it by using the shell:</p>
<pre><code>
1&gt;  gen_event:start({local, error_man}). 
{ok, &lt;0.31.0&gt;}
2&gt; 
gen_event:add_handler(error_man, terminal_logger, []). 
ok
</code></pre>

<p>This function sends a message to the event manager registered as <em>error_man</em> , telling it to add the event handler <em>terminal_logger</em> . The event manager calls the callback function <em>terminal_logger:init([])</em> , where the argument <em>[]</em> is the third argument to <em>add_handler</em> . <em>init</em> is expected to return <em>{ok, State}</em> , where <em>State</em> is the internal state of the event handler.</p>
<pre><code>
init(_Args) -&gt;
    {ok, []}.
</code></pre>

<p>Here, <em>init</em> does not need any input data and ignores its argument. For <em>terminal_logger</em> , the internal state is not used. For <em>file_logger</em> , the internal state is used to save the open file descriptor.</p>
<pre><code>
init(File) -&gt;
    {ok, Fd} = file:open(File, read),
    {ok, Fd}.
</code></pre>

<h3 id="notifying-about-events">Notifying about Events</h3>
<pre><code>
3&gt;  gen_event:notify(error_man, no_reply).

***Error*** no_reply
ok
</code></pre>

<p><em>error_man</em> is the name of the event manager and <em>no_reply</em> is the event.</p>
<p>The event is made into a message and sent to the event manager. When the event is received, the event manager calls <em>handle_event(Event, State)</em> for each installed event handler, in the same order as they were added. The function is expected to return a tuple <em>{ok,State1}</em> , where <em>State1</em> is a new value for the state of the event handler.</p>
<p>In <em>terminal_logger</em> :</p>
<pre><code>
handle_event(ErrorMsg, State) -&gt;
    io:format(&quot;***Error*** ~p~n&quot;, [ErrorMsg]),
    {ok, State}.
</code></pre>

<p>In <em>file_logger</em> :</p>
<pre><code>
handle_event(ErrorMsg, Fd) -&gt;
    io:format(Fd, &quot;***Error*** ~p~n&quot;, [ErrorMsg]),
    {ok, Fd}.
</code></pre>

<h3 id="deleting-an-event-handler">Deleting an Event Handler</h3>
<pre><code>
4&gt;  gen_event:delete_handler(error_man, terminal_logger, []).

ok
</code></pre>

<p>This function sends a message to the event manager registered as <em>error_man</em> , telling it to delete the event handler <em>terminal_logger</em> . The event manager calls the callback function <em>terminal_logger:terminate([], State)</em> , where the argument <em>[]</em> is the third argument to <em>delete_handler</em> . <em>terminate</em> is to be the opposite of <em>init</em> and do any necessary cleaning up. Its return value is ignored.</p>
<p>For <em>terminal_logger</em> , no cleaning up is necessary:</p>
<pre><code>
terminate(_Args, _State) -&gt;
    ok.
</code></pre>

<p>For <em>file_logger</em> , the file descriptor opened in <em>init</em> must be closed:</p>
<pre><code>
terminate(_Args, Fd) -&gt;
    file:close(Fd).
</code></pre>

<h3 id="stopping_2">Stopping</h3>
<p>When an event manager is stopped, it gives each of the installed event handlers the chance to clean up by calling <em>terminate/2</em> , the same way as when deleting a handler.</p>
<h3 id="in-a-supervision-tree_2">In a Supervision Tree</h3>
<p>If the event manager is part of a supervision tree, no stop function is needed. The event manager is automatically terminated by its supervisor. Exactly how this is done is defined by a <a href="./sup_princ#shutdown">shutdown strategy</a> set in the supervisor.</p>
<h3 id="standalone-event-managers">Standalone Event Managers</h3>
<p>An event manager can also be stopped by calling:</p>
<pre><code>
&gt;  gen_event:stop(error_man). 
ok
</code></pre>

<h3 id="handling-other-messages_1">Handling Other Messages</h3>
<p>If the <em>gen_event</em> is to be able to receive other messages than events, the callback function <em>handle_info(Info, StateName, StateData)</em> must be implemented to handle them. Examples of other messages are exit messages, if the <em>gen_event</em> is linked to other processes (than the supervisor) and trapping exit signals.</p>
<pre><code>
handle_info({'EXIT', Pid, Reason}, State) -&gt;
    ..code to handle exits here..
    {ok, NewState}.
</code></pre>

<p>The <em>code_change</em> method must also be implemented.</p>
<pre><code>
code_change(OldVsn, State, Extra) -&gt;
    ..code to convert state (and more) during code change
    {ok, NewState}
</code></pre>

<p>This section should be read with the <a href="./supervisor">supervisor(3)</a> manual page in STDLIB, where all details about the supervisor behaviour is given.</p>
<h3 id="supervision-principles">Supervision Principles</h3>
<p>A supervisor is responsible for starting, stopping, and monitoring its child processes. The basic idea of a supervisor is that it is to keep its child processes alive by restarting them when necessary.</p>
<p>Which child processes to start and monitor is specified by a list of <a href="#spec">child specifications</a> . The child processes are started in the order specified by this list, and terminated in the reversed order.</p>
<h3 id="example_3">Example</h3>
<p>The callback module for a supervisor starting the server from <a href="./gen_server_concepts#ex">gen_server Behaviour</a> can look as follows:
 <a name="ex">ex</a> </p>
<pre><code>
-module(ch_sup).
-behaviour(supervisor).

-export([start_link/0]).
-export([init/1]).

start_link() -&gt;
    supervisor:start_link(ch_sup, []).

init(_Args) -&gt;
    SupFlags = #{strategy =&gt; one_for_one, intensity =&gt; 1, period =&gt; 5},
    ChildSpecs = [#{id =&gt; ch3,
                    start =&gt; {ch3, start_link, []},
                    restart =&gt; permanent,
                    shutdown =&gt; brutal_kill,
                    type =&gt; worker,
                    modules =&gt; [cg3]}],
    {ok, {SupFlags, ChildSpecs}}.
</code></pre>

<p>The <em>SupFlags</em> variable in the return value from <em>init/1</em> represents the <a href="#flags">supervisor flags</a> .</p>
<p>The <em>ChildSpecs</em> variable in the return value from <em>init/1</em> is a list of <a href="#spec">child specifications</a> .
 <a name="flags">flags</a> </p>
<h3 id="supervisor-flags">Supervisor Flags</h3>
<p>This is the type definition for the supervisor flags:</p>
<pre><code>
sup_flags() = #{strategy =&gt; strategy(),         % optional
                intensity =&gt; non_neg_integer(), % optional
                period =&gt; pos_integer()}        % optional
    strategy() = one_for_all
               | one_for_one
               | rest_for_one
               | simple_one_for_one
</code></pre>

<ul>
<li><em>strategy</em> specifies the <a href="#strategy">restart strategy</a> .</li>
<li><em>intensity</em> and <em>period</em> specify the <a href="#max_intensity">maximum restart intensity</a> .
 <a name="strategy">strategy</a> </li>
</ul>
<h3 id="restart-strategy">Restart Strategy</h3>
<p>The restart strategy is specified by the <em>strategy</em> key in the supervisor flags map returned by the callback function <em>init</em> :</p>
<pre><code>
SupFlags = #{strategy =&gt; Strategy, ...}
</code></pre>

<p>The <em>strategy</em> key is optional in this map. If it is not given, it defaults to <em>one_for_one</em> .</p>
<h3 id="one_for_one">one_for_one</h3>
<p>If a child process terminates, only that process is restarted.
 <a name="sup4">sup4</a> <img alt="One_For_One Supervision" src="../sup4.gif" /> </p>
<h3 id="one_for_all">one_for_all</h3>
<p>If a child process terminates, all other child processes are terminated, and then all child processes, including the terminated one, are restarted.
 <a name="sup5">sup5</a> <img alt="One_For_All Supervision" src="../sup5.gif" /> </p>
<h3 id="rest_for_one">rest_for_one</h3>
<p>If a child process terminates, the rest of the child processes (that is, the child processes after the terminated process in start order) are terminated. Then the terminated child process and the rest of the child processes are restarted.</p>
<h3 id="simple_one_for_one">simple_one_for_one</h3>
<p>See <a href="#simple">simple-one-for-one supervisors</a> .
 <a name="max_intensity">max_intensity</a> </p>
<h3 id="maximum-restart-intensity">Maximum Restart Intensity</h3>
<p>The supervisors have a built-in mechanism to limit the number of restarts which can occur in a given time interval. This is specified by the two keys <em>intensity</em> and <em>period</em> in the supervisor flags map returned by the callback function <em>init</em> :</p>
<pre><code>
SupFlags = #{intensity =&gt; MaxR, period =&gt; MaxT, ...}
</code></pre>

<p>If more than <em>MaxR</em> number of restarts occur in the last <em>MaxT</em> seconds, the supervisor terminates all the child processes and then itself. The termination reason for the supervisor itself in that case will be <em>shutdown</em> .</p>
<p>When the supervisor terminates, then the next higher-level supervisor takes some action. It either restarts the terminated supervisor or terminates itself.</p>
<p>The intention of the restart mechanism is to prevent a situation where a process repeatedly dies for the same reason, only to be restarted again.</p>
<p>The keys <em>intensity</em> and <em>period</em> are optional in the supervisor flags map. If they are not given, they default to <em>1</em> and <em>5</em> , respectively.</p>
<h3 id="tuning-the-intensity-and-period">Tuning the intensity and period</h3>
<p>The default values are 1 restart per 5 seconds. This was chosen to be safe for most systems, even with deep supervision hierarchies, but you will probably want to tune the settings for your particular use case.</p>
<p>First, the intensity decides how big bursts of restarts you want to tolerate. For example, you might want to accept a burst of at most 5 or 10 attempts, even within the same second, if it results in a successful restart.</p>
<p>Second, you need to consider the sustained failure rate, if crashes keep happening but not often enough to make the supervisor give up. If you set intensity to 10 and set the period as low as 1, the supervisor will allow child processes to keep restarting up to 10 times per second, forever, filling your logs with crash reports until someone intervenes manually.</p>
<p>You should therefore set the period to be long enough that you can accept that the supervisor keeps going at that rate. For example, if you have picked an intensity value of 5, then setting the period to 30 seconds will give you at most one restart per 6 seconds for any longer period of time, which means that your logs won't fill up too quickly, and you will have a chance to observe the failures and apply a fix.</p>
<p>These choices depend a lot on your problem domain. If you don't have real time monitoring and ability to fix problems quickly, for example in an embedded system, you might want to accept at most one restart per minute before the supervisor should give up and escalate to the next level to try to clear the error automatically. On the other hand, if it is more important that you keep trying even at a high failure rate, you might want a sustained rate of as much as 1-2 restarts per second.</p>
<p>Avoiding common mistakes:</p>
<ul>
<li>Do not forget to consider the burst rate. If you set intensity to 1 and period to 6, it gives the same sustained error rate as 5/30 or 10/60, but will not allow even 2 restart attempts in quick succession. This is probably not what you wanted.</li>
<li>Do not set the period to a very high value if you want to tolerate bursts. If you set intensity to 5 and period to 3600 (one hour), the supervisor will allow a short burst of 5 restarts, but then gives up if it sees another single restart almost an hour later. You probably want to regard those crashes as separate incidents, so setting the period to 5 or 10 minutes will be more reasonable.</li>
<li>If your application has multiple levels of supervision, then do not simply set the restart intensities to the same values on all levels. Keep in mind that the total number of restarts (before the top level supervisor gives up and terminates the application) will be the product of the intensity values of all the supervisors above the failing child process.</li>
</ul>
<p>For example, if the top level allows 10 restarts, and the next level also allows 10, a crashing child below that level will be restarted 100 times, which is probably excessive. Allowing at most 3 restarts for the top level supervisor might be a better choice in this case.
 <a name="spec">spec</a> </p>
<h3 id="child-specification">Child Specification</h3>
<p>The type definition for a child specification is as follows:</p>
<pre><code>
child_spec() = #{id =&gt; child_id(),       % mandatory
                 start =&gt; mfargs(),      % mandatory
                 restart =&gt; restart(),   % optional
                 shutdown =&gt; shutdown(), % optional
                 type =&gt; worker(),       % optional
                 modules =&gt; modules()}   % optional
    child_id() = term()
    mfargs() = {M :: module(), F :: atom(), A :: [term()]}
    modules() = [module()] | dynamic
    restart() = permanent | transient | temporary
    shutdown() = brutal_kill | timeout()
    worker() = worker | supervisor
</code></pre>

<ul>
<li><em>id</em> is used to identify the child specification internally by the supervisor.</li>
</ul>
<p>The <em>id</em> key is mandatory.</p>
<p>Note that this identifier occasionally has been called "name". As far as possible, the terms "identifier" or "id" are now used but in order to keep backwards compatibility, some occurences of "name" can still be found, for example in error messages.
* 
<em>start</em> defines the function call used to start the child process. It is a module-function-arguments tuple used as <em>apply(M, F, A)</em> .</p>
<p>It is to be (or result in) a call to any of the following:</p>
<ul>
<li><em>supervisor:start_link</em></li>
<li><em>gen_server:start_link</em></li>
<li><em>gen_statem:start_link</em></li>
<li><em>gen_event:start_link</em></li>
<li>A function compliant with these functions. For details, see the <em>supervisor(3)</em> manual page.</li>
</ul>
<p>The <em>start</em> key is mandatory.
* 
<em>restart</em> defines when a terminated child process is to be restarted.</p>
<ul>
<li>A <em>permanent</em> child process is always restarted.</li>
<li>A <em>temporary</em> child process is never restarted (not even when the supervisor restart strategy is <em>rest_for_one</em> or <em>one_for_all</em> and a sibling death causes the temporary process to be terminated).</li>
<li>A <em>transient</em> child process is restarted only if it terminates abnormally, that is, with an exit reason other than <em>normal</em> , <em>shutdown</em> , or <em>{shutdown,Term}</em> .</li>
</ul>
<p>The <em>restart</em> key is optional. If it is not given, the default value <em>permanent</em> will be used.
* <a name="shutdown">shutdown</a> 
<em>shutdown</em> defines how a child process is to be terminated.</p>
<ul>
<li><em>brutal_kill</em> means that the child process is unconditionally terminated using <em>exit(Child, kill)</em> .</li>
<li>An integer time-out value means that the supervisor tells the child process to terminate by calling <em>exit(Child, shutdown)</em> and then waits for an exit signal back. If no exit signal is received within the specified time, the child process is unconditionally terminated using <em>exit(Child, kill)</em> .</li>
<li>If the child process is another supervisor, it must be set to <em>infinity</em> to give the subtree enough time to shut down. It is also allowed to set it to <em>infinity</em> , if the child process is a worker. See the warning below:</li>
</ul>
<p>Setting the shutdown time to anything other than <em>infinity</em> for a child of type <em>supervisor</em> can cause a race condition where the child in question unlinks its own children, but fails to terminate them before it is killed.</p>
<p>Be careful when setting the shutdown time to <em>infinity</em> when the child process is a worker. Because, in this situation, the termination of the supervision tree depends on the child process; it must be implemented in a safe way and its cleanup procedure must always return.</p>
<p>The <em>shutdown</em> key is optional. If it is not given, and the child is of type <em>worker</em> , the default value <em>5000</em> will be used; if the child is of type <em>supervisor</em> , the default value <em>infinity</em> will be used.
* 
<em>type</em> specifies if the child process is a supervisor or a worker.</p>
<p>The <em>type</em> key is optional. If it is not given, the default value <em>worker</em> will be used.
* 
<em>modules</em> are to be a list with one element <em>[Module]</em> , where <em>Module</em> is the name of the callback module, if the child process is a supervisor, gen_server, gen_statem. If the child process is a gen_event, the value shall be <em>dynamic</em> .</p>
<p>This information is used by the release handler during upgrades and downgrades, see <a href="release_handling">Release Handling</a> .</p>
<p>The <em>modules</em> key is optional. If it is not given, it defaults to <em>[M]</em> , where <em>M</em> comes from the child's start <em>{M,F,A}</em> .</p>
<p><strong>Example:</strong> The child specification to start the server <em>ch3</em> in the previous example look as follows:</p>
<pre><code>
#{id =&gt; ch3,
  start =&gt; {ch3, start_link, []},
  restart =&gt; permanent,
  shutdown =&gt; brutal_kill,
  type =&gt; worker,
  modules =&gt; [ch3]}
</code></pre>

<p>or simplified, relying on the default values:</p>
<pre><code>
#{id =&gt; ch3,
  start =&gt; {ch3, start_link, []}
  shutdown =&gt; brutal_kill}
</code></pre>

<p>Example: A child specification to start the event manager from the chapter about <a href="./events#mgr">gen_event</a> :</p>
<pre><code>
#{id =&gt; error_man,
  start =&gt; {gen_event, start_link, [{local, error_man}]},
  modules =&gt; dynamic}
</code></pre>

<p>Both server and event manager are registered processes which can be expected to be always accessible. Thus they are specified to be <em>permanent</em> .</p>
<p><em>ch3</em> does not need to do any cleaning up before termination. Thus, no shutdown time is needed, but <em>brutal_kill</em> is sufficient. <em>error_man</em> can need some time for the event handlers to clean up, thus the shutdown time is set to 5000 ms (which is the default value).</p>
<p>Example: A child specification to start another supervisor:</p>
<pre><code>
#{id =&gt; sup,
  start =&gt; {sup, start_link, []},
  restart =&gt; transient,
  type =&gt; supervisor} % will cause default shutdown=&gt;infinity
</code></pre>

<p><a name="super_tree">super_tree</a> </p>
<h3 id="starting-a-supervisor">Starting a Supervisor</h3>
<p>In the previous example, the supervisor is started by calling <em>ch_sup:start_link()</em> :</p>
<pre><code>
start_link() -&gt;
    supervisor:start_link(ch_sup, []).
</code></pre>

<p><em>ch_sup:start_link</em> calls function <em>supervisor:start_link/2</em> , which spawns and links to a new process, a supervisor.</p>
<ul>
<li>The first argument, <em>ch_sup</em> , is the name of the callback module, that is, the module where the <em>init</em> callback function is located.</li>
<li>The second argument, <em>[]</em> , is a term that is passed as is to the callback function <em>init</em> . Here, <em>init</em> does not need any indata and ignores the argument.</li>
</ul>
<p>In this case, the supervisor is not registered. Instead its pid must be used. A name can be specified by calling <em>supervisor:start_link({local, Name}, Module, Args)</em> or <em>supervisor:start_link({global, Name}, Module, Args)</em> .</p>
<p>The new supervisor process calls the callback function <em>ch_sup:init([])</em> . <em>init</em> shall return <em>{ok, {SupFlags, ChildSpecs}}</em> :</p>
<pre><code>
init(_Args) -&gt;
    SupFlags = #{},
    ChildSpecs = [#{id =&gt; ch3,
                    start =&gt; {ch3, start_link, []},
                    shutdown =&gt; brutal_kill}],
    {ok, {SupFlags, ChildSpecs}}.
</code></pre>

<p>The supervisor then starts all its child processes according to the child specifications in the start specification. In this case there is one child process, <em>ch3</em> .</p>
<p><em>supervisor:start_link</em> is synchronous. It does not return until all child processes have been started.</p>
<h3 id="adding-a-child-process">Adding a Child Process</h3>
<p>In addition to the static supervision tree, dynamic child processes can be added to an existing supervisor with the following call:</p>
<pre><code>
supervisor:start_child(Sup, ChildSpec)
</code></pre>

<p><em>Sup</em> is the pid, or name, of the supervisor. <em>ChildSpec</em> is a <a href="#spec">child specification</a> .</p>
<p>Child processes added using <em>start_child/2</em> behave in the same way as the other child processes, with the an important exception: if a supervisor dies and is recreated, then all child processes that were dynamically added to the supervisor are lost.</p>
<h3 id="stopping-a-child-process">Stopping a Child Process</h3>
<p>Any child process, static or dynamic, can be stopped in accordance with the shutdown specification:</p>
<pre><code>
supervisor:terminate_child(Sup, Id)
</code></pre>

<p>The child specification for a stopped child process is deleted with the following call:</p>
<pre><code>
supervisor:delete_child(Sup, Id)
</code></pre>

<p><em>Sup</em> is the pid, or name, of the supervisor. <em>Id</em> is the value associated with the <em>id</em> key in the <a href="#spec">child specification</a> .</p>
<p>As with dynamically added child processes, the effects of deleting a static child process is lost if the supervisor itself restarts.
 <a name="simple">simple</a> </p>
<h3 id="simplified-one_for_one-supervisors">Simplified one_for_one Supervisors</h3>
<p>A supervisor with restart strategy <em>simple_one_for_one</em> is a simplified <em>one_for_one</em> supervisor, where all child processes are dynamically added instances of the same process.</p>
<p>The following is an example of a callback module for a <em>simple_one_for_one</em> supervisor:</p>
<pre><code>
-module(simple_sup).
-behaviour(supervisor).

-export([start_link/0]).
-export([init/1]).

start_link() -&gt;
    supervisor:start_link(simple_sup, []).

init(_Args) -&gt;
    SupFlags = #{strategy =&gt; simple_one_for_one,
                 intensity =&gt; 0,
                 period =&gt; 1},
    ChildSpecs = [#{id =&gt; call,
                    start =&gt; {call, start_link, []},
                    shutdown =&gt; brutal_kill}],
    {ok, {SupFlags, ChildSpecs}}.
</code></pre>

<p>When started, the supervisor does not start any child processes. Instead, all child processes are added dynamically by calling:</p>
<pre><code>
supervisor:start_child(Sup, List)
</code></pre>

<p><em>Sup</em> is the pid, or name, of the supervisor. <em>List</em> is an arbitrary list of terms, which are added to the list of arguments specified in the child specification. If the start function is specified as <em>{M, F, A}</em> , the child process is started by calling <em>apply(M, F, A++List)</em> .</p>
<p>For example, adding a child to <em>simple_sup</em> above:</p>
<pre><code>
supervisor:start_child(Pid, [id1])
</code></pre>

<p>The result is that the child process is started by calling <em>apply(call, start_link, []++[id1])</em> , or actually:</p>
<pre><code>
call:start_link(id1)
</code></pre>

<p>A child under a <em>simple_one_for_one</em> supervisor can be terminated with the following:</p>
<pre><code>
supervisor:terminate_child(Sup, Pid)
</code></pre>

<p><em>Sup</em> is the pid, or name, of the supervisor and <em>Pid</em> is the pid of the child.</p>
<p>Because a <em>simple_one_for_one</em> supervisor can have many children, it shuts them all down asynchronously. This means that the children will do their cleanup in parallel and therefore the order in which they are stopped is not defined.</p>
<h3 id="stopping_3">Stopping</h3>
<p>Since the supervisor is part of a supervision tree, it is automatically terminated by its supervisor. When asked to shut down, it terminates all child processes in reversed start order according to the respective shutdown specifications, and then terminates itself.
<a name="sys and proc_lib">sys and proc_lib</a> 
The <em>sys</em> module has functions for simple debugging of processes implemented using behaviours. It also has functions that, together with functions in the <em>proc_lib</em> module, can be used to implement a <strong>special process</strong> that complies to the OTP design principles without using a standard behaviour. These functions can also be used to implement user-defined (non-standard) behaviours.</p>
<p>Both <em>sys</em> and <em>proc_lib</em> belong to the STDLIB application.</p>
<h3 id="simple-debugging">Simple Debugging</h3>
<p>The <em>sys</em> module has functions for simple debugging of processes implemented using behaviours. The <em>code_lock</em> example from <a href="./statem#Example">gen_statem Behaviour</a> is used to illustrate this:</p>
<pre><code>
Erlang/OTP 20 [DEVELOPMENT] [erts-9.0] [source-5ace45e] [64-bit] [smp:8:8] [ds:8:8:10] [async-threads:10] [hipe] [kernel-poll:false]

Eshell V9.0  (abort with ^G)
1&gt;  code_lock:start_link([1,2,3,4]).
Lock
{ok,&lt;0.63.0&gt;}
2&gt; sys:statistics(code_lock, true).
ok
3&gt;  sys:trace(code_lock, true).
ok
4&gt;  code_lock:button(1).
*DBG* code_lock receive cast {button,1} in state locked
ok
*DBG* code_lock consume cast {button,1} in state locked
5&gt;  code_lock:button(2).
*DBG* code_lock receive cast {button,2} in state locked
ok
*DBG* code_lock consume cast {button,2} in state locked
6&gt;  code_lock:button(3).
*DBG* code_lock receive cast {button,3} in state locked
ok
*DBG* code_lock consume cast {button,3} in state locked
7&gt;  code_lock:button(4).
*DBG* code_lock receive cast {button,4} in state locked
ok
Unlock
*DBG* code_lock consume cast {button,4} in state locked
*DBG* code_lock receive state_timeout lock in state open
Lock
*DBG* code_lock consume state_timeout lock in state open
8&gt; sys:statistics(code_lock, get).
{ok,[{start_time,{{2017,4,21},{16,8,7}}},
     {current_time,{{2017,4,21},{16,9,42}}},
     {reductions,2973},
     {messages_in,5},
     {messages_out,0}]}
9&gt; sys:statistics(code_lock, false).
ok
10&gt; sys:trace(code_lock, false).
ok
11&gt; sys:get_status(code_lock).
{status,&lt;0.63.0&gt;,
        {module,gen_statem},
        [[{'$initial_call',{code_lock,init,1}},
          {'$ancestors',[&lt;0.61.0&gt;]}],
         running,&lt;0.61.0&gt;,[],
         [{header,&quot;Status for state machine code_lock&quot;},
          {data,[{&quot;Status&quot;,running},
                 {&quot;Parent&quot;,&lt;0.61.0&gt;},
                 {&quot;Logged Events&quot;,[]},
                 {&quot;Postponed&quot;,[]}]},
          {data,[{&quot;State&quot;,
                  {locked,#{code =&gt; [1,2,3,4],remaining =&gt; [1,2,3,4]}}}]}]]}

</code></pre>

<h3 id="special-processes">Special Processes</h3>
<p>This section describes how to write a process that complies to the OTP design principles, without using a standard behaviour. Such a process is to:</p>
<ul>
<li>Be started in a way that makes the process fit into a supervision tree</li>
<li>Support the <em>sys</em> <a href="#debug">debug facilities</a></li>
<li>Take care of <a href="#msg">system messages</a> .</li>
</ul>
<p>System messages are messages with a special meaning, used in the supervision tree. Typical system messages are requests for trace output, and requests to suspend or resume process execution (used during release handling). Processes implemented using standard behaviours automatically understand these messages.</p>
<h3 id="example_4">Example</h3>
<p>The simple server from <a href="./des_princ#ch1">Overview</a> , implemented using <em>sys</em> and <em>proc_lib</em> so it fits into a supervision tree:
 <a name="ex">ex</a> </p>
<pre><code>
-module(ch4).
-export([start_link/0]).
-export([alloc/0, free/1]).
-export([init/1]).
-export([system_continue/3, system_terminate/4,
         write_debug/3,
         system_get_state/1, system_replace_state/2]).

start_link() -&gt;
    proc_lib:start_link(ch4, init, [self()]).

alloc() -&gt;
    ch4 ! {self(), alloc},
    receive
        {ch4, Res} -&gt;
            Res
    end.

free(Ch) -&gt;
    ch4 ! {free, Ch},
    ok.

init(Parent) -&gt;
    register(ch4, self()),
    Chs = channels(),
    Deb = sys:debug_options([]),
    proc_lib:init_ack(Parent, {ok, self()}),
    loop(Chs, Parent, Deb).

loop(Chs, Parent, Deb) -&gt;
    receive
        {From, alloc} -&gt;
            Deb2 = sys:handle_debug(Deb, fun ch4:write_debug/3,
                                    ch4, {in, alloc, From}),
            {Ch, Chs2} = alloc(Chs),
            From ! {ch4, Ch},
            Deb3 = sys:handle_debug(Deb2, fun ch4:write_debug/3,
                                    ch4, {out, {ch4, Ch}, From}),
            loop(Chs2, Parent, Deb3);
        {free, Ch} -&gt;
            Deb2 = sys:handle_debug(Deb, fun ch4:write_debug/3,
                                    ch4, {in, {free, Ch}}),
            Chs2 = free(Ch, Chs),
            loop(Chs2, Parent, Deb2);

        {system, From, Request} -&gt;
            sys:handle_system_msg(Request, From, Parent,
                                  ch4, Deb, Chs)
    end.

system_continue(Parent, Deb, Chs) -&gt;
    loop(Chs, Parent, Deb).

system_terminate(Reason, _Parent, _Deb, _Chs) -&gt;
    exit(Reason).

system_get_state(Chs) -&gt;
    {ok, Chs}.

system_replace_state(StateFun, Chs) -&gt;
    NChs = StateFun(Chs),
    {ok, NChs, NChs}.

write_debug(Dev, Event, Name) -&gt;
    io:format(Dev, &quot;~p event = ~p~n&quot;, [Name, Event]).
</code></pre>

<p>Example on how the simple debugging functions in the <em>sys</em> module can also be used for <em>ch4</em> :</p>
<pre><code>
%  erl

Erlang (BEAM) emulator version 5.2.3.6 [hipe] [threads:0]

Eshell V5.2.3.6  (abort with ^G)
1&gt; 
ch4:start_link(). 
{ok, &lt;0.30.0&gt;}
2&gt;  sys:statistics(ch4, true).

ok
3&gt;  sys:trace(ch4, true). 
ok
4&gt;  ch4:alloc().

ch4 event = {in,alloc, &lt;0.25.0&gt;}
ch4 event = {out,{ch4,ch1},
&lt;0.25.0&gt;}
ch1
5&gt;  ch4:free(ch1).

ch4 event = {in,{free,ch1}}
ok
6&gt;  sys:statistics(ch4, get).

{ok,[{start_time,{{2003,6,13},{9,47,5}}},
     {current_time,{{2003,6,13},{9,47,56}}},
     {reductions,109},
     {messages_in,2},
     {messages_out,1}]}
7&gt; 
sys:statistics(ch4, false). 
ok
8&gt;  sys:trace(ch4, false).

ok
9&gt;  sys:get_status(ch4). 
{status,
&lt;0.30.0&gt;,
        {module,ch4},
        [[{'$ancestors',[
&lt;0.25.0&gt;]},{'$initial_call',{ch4,init,[
&lt;0.25.0&gt;]}}],
         running,
&lt;0.25.0&gt;,[],
         [ch1,ch2,ch3]]}
</code></pre>

<h3 id="starting-the-process">Starting the Process</h3>
<p>A function in the <em>proc_lib</em> module is to be used to start the process. Several functions are available, for example, <em>spawn_link/3,4</em> for asynchronous start and <em>start_link/3,4,5</em> for synchronous start.</p>
<p>A process started using one of these functions stores information (for example, about the ancestors and initial call) that is needed for a process in a supervision tree.</p>
<p>If the process terminates with another reason than <em>normal</em> or <em>shutdown</em> , a crash report is generated. For more information about the crash report, see the SASL User's Guide.</p>
<p>In the example, synchronous start is used. The process starts by calling <em>ch4:start_link()</em> :</p>
<pre><code>
start_link() -&gt;
    proc_lib:start_link(ch4, init, [self()]).
</code></pre>

<p><em>ch4:start_link</em> calls the function <em>proc_lib:start_link</em> . This function takes a module name, a function name, and an argument list as arguments, spawns, and links to a new process. The new process starts by executing the given function, here <em>ch4:init(Pid)</em> , where <em>Pid</em> is the pid ( <em>self()</em> ) of the first process, which is the parent process.</p>
<p>All initialization, including name registration, is done in <em>init</em> . The new process must also acknowledge that it has been started to the parent:</p>
<pre><code>
init(Parent) -&gt;
    ...
    proc_lib:init_ack(Parent, {ok, self()}),
    loop(...).
</code></pre>

<p><em>proc_lib:start_link</em> is synchronous and does not return until <em>proc_lib:init_ack</em> has been called.
 <a name="debug">debug</a> </p>
<h3 id="debugging">Debugging</h3>
<p>To support the debug facilites in <em>sys</em> , a <strong>debug structure</strong> is needed. The <em>Deb</em> term is initialized using <em>sys:debug_options/1</em> :</p>
<pre><code>
init(Parent) -&gt;
    ...
    Deb = sys:debug_options([]),
    ...
    loop(Chs, Parent, Deb).
</code></pre>

<p><em>sys:debug_options/1</em> takes a list of options as argument. Here the list is empty, which means no debugging is enabled initially. For information about the possible options, see the <em>sys(3)</em> manual page in STDLIB.</p>
<p>Then, for each <strong>system event</strong> to be logged or traced, the following function is to be called.</p>
<pre><code>
sys:handle_debug(Deb, Func, Info, Event) =&gt; Deb1
</code></pre>

<p>Here:</p>
<ul>
<li><em>Deb</em> is the debug structure.</li>
<li><em>Func</em> is a fun specifying a (user-defined) function used to format trace output. For each system event, the format function is called as <em>Func(Dev, Event, Info)</em> , where: </li>
<li><em>Dev</em> is the I/O device to which the output is to be printed. See the <em>io(3)</em> manual page in STDLIB.</li>
<li><em>Event</em> and <em>Info</em> are passed as is from <em>handle_debug</em> .</li>
<li><em>Info</em> is used to pass more information to <em>Func</em> . It can be any term and is passed as is.</li>
<li><em>Event</em> is the system event. It is up to the user to define what a system event is and how it is to be represented. Typically at least incoming and outgoing messages are considered system events and represented by the tuples <em>{in,Msg[,From]}</em> and <em>{out,Msg,To[,State]}</em> , respectively.</li>
</ul>
<p><em>handle_debug</em> returns an updated debug structure <em>Deb1</em> .</p>
<p>In the example, <em>handle_debug</em> is called for each incoming and outgoing message. The format function <em>Func</em> is the function <em>ch4:write_debug/3</em> , which prints the message using <em>io:format/3</em> .</p>
<pre><code>
loop(Chs, Parent, Deb) -&gt;
    receive
        {From, alloc} -&gt;
            Deb2 = sys:handle_debug(Deb, fun ch4:write_debug/3,
                                    ch4, {in, alloc, From}),
            {Ch, Chs2} = alloc(Chs),
            From ! {ch4, Ch},
            Deb3 = sys:handle_debug(Deb2, fun ch4:write_debug/3,
                                    ch4, {out, {ch4, Ch}, From}),
            loop(Chs2, Parent, Deb3);
        {free, Ch} -&gt;
            Deb2 = sys:handle_debug(Deb, fun ch4:write_debug/3,
                                    ch4, {in, {free, Ch}}),
            Chs2 = free(Ch, Chs),
            loop(Chs2, Parent, Deb2);
        ...
    end.

write_debug(Dev, Event, Name) -&gt;
    io:format(Dev, &quot;~p event = ~p~n&quot;, [Name, Event]).
</code></pre>

<p><a name="msg">msg</a> </p>
<h3 id="handling-system-messages">Handling System Messages</h3>
<p><strong>System messages</strong> are received as:</p>
<pre><code>
{system, From, Request}
</code></pre>

<p>The content and meaning of these messages do not need to be interpreted by the process. Instead the following function is to be called:</p>
<pre><code>
sys:handle_system_msg(Request, From, Parent, Module, Deb, State)
</code></pre>

<p>This function does not return. It handles the system message and then either calls the following if process execution is to continue:</p>
<pre><code>
Module:system_continue(Parent, Deb, State)
</code></pre>

<p>Or calls the following if the process is to terminate:</p>
<pre><code>
Module:system_terminate(Reason, Parent, Deb, State)
</code></pre>

<p>A process in a supervision tree is expected to terminate with the same reason as its parent.</p>
<ul>
<li><em>Request</em> and <em>From</em> are to be passed as is from the system message to the call to <em>handle_system_msg</em> .</li>
<li><em>Parent</em> is the pid of the parent.</li>
<li><em>Module</em> is the name of the module.</li>
<li><em>Deb</em> is the debug structure.</li>
<li><em>State</em> is a term describing the internal state and is passed to <em>system_continue</em> / <em>system_terminate</em> / <em>system_get_state</em> / <em>system_replace_state</em> .</li>
</ul>
<p>If the process is to return its state, <em>handle_system_msg</em> calls:</p>
<pre><code>
Module:system_get_state(State)
</code></pre>

<p>If the process is to replace its state using the fun <em>StateFun</em> , <em>handle_system_msg</em> calls:</p>
<pre><code>
Module:system_replace_state(StateFun, State)
</code></pre>

<p>In the example:</p>
<pre><code>
loop(Chs, Parent, Deb) -&gt;
    receive
        ...

        {system, From, Request} -&gt;
            sys:handle_system_msg(Request, From, Parent,
                                  ch4, Deb, Chs)
    end.

system_continue(Parent, Deb, Chs) -&gt;
    loop(Chs, Parent, Deb).

system_terminate(Reason, Parent, Deb, Chs) -&gt;
    exit(Reason).

system_get_state(Chs) -&gt;
    {ok, Chs, Chs}.

system_replace_state(StateFun, Chs) -&gt;
    NChs = StateFun(Chs),
    {ok, NChs, NChs}.

</code></pre>

<p>If the special process is set to trap exits and if the parent process terminates, the expected behavior is to terminate with the same reason:</p>
<pre><code>
init(...) -&gt;
    ...,
    process_flag(trap_exit, true),
    ...,
    loop(...).

loop(...) -&gt;
    receive
        ...

        {'EXIT', Parent, Reason} -&gt;
            ..maybe some cleaning up here..
            exit(Reason);
        ...
    end.
</code></pre>

<h3 id="user-defined-behaviours">User-Defined Behaviours</h3>
<p><a name="behaviours">behaviours</a> To implement a user-defined behaviour, write code similar to code for a special process, but call functions in a callback module for handling specific tasks.</p>
<p>If the compiler is to warn for missing callback functions, as it does for the OTP behaviours, add <em>-callback</em> attributes in the behaviour module to describe the expected callbacks:</p>
<pre><code>
-callback Name1(Arg1_1, Arg1_2, ..., Arg1_N1) -&gt; Res1.
-callback Name2(Arg2_1, Arg2_2, ..., Arg2_N2) -&gt; Res2.
...
-callback NameM(ArgM_1, ArgM_2, ..., ArgM_NM) -&gt; ResM.
</code></pre>

<p><em>NameX</em> are the names of the expected callbacks. <em>ArgX_Y</em> and <em>ResX</em> are types as they are described in <a href="../reference_manual/typespec">Types and Function Specifications</a> . The whole syntax of the <em>-spec</em> attribute is supported by the <em>-callback</em> attribute.</p>
<p>Callback functions that are optional for the user of the behaviour to implement are specified by use of the <em>-optional_callbacks</em> attribute:</p>
<pre><code>
-optional_callbacks([OptName1/OptArity1, ..., OptNameK/OptArityK]).
</code></pre>

<p>where each <em>OptName/OptArity</em> specifies the name and arity of a callback function. Note that the <em>-optional_callbacks</em> attribute is to be used together with the <em>-callback</em> attribute; it cannot be combined with the <em>behaviour_info()</em> function described below.</p>
<p>Tools that need to know about optional callback functions can call <em>Behaviour:behaviour_info(optional_callbacks)</em> to get a list of all optional callback functions.</p>
<div class="admonition info">
<p class="admonition-title">Note</p>
</div>
<p>We recommend using the <em>-callback</em> attribute rather than the <em>behaviour_info()</em> function. The reason is that the extra type information can be used by tools to produce documentation or find discrepancies.</p>
<p>As an alternative to the <em>-callback</em> and <em>-optional_callbacks</em> attributes you may directly implement and export <em>behaviour_info()</em> :</p>
<pre><code>
behaviour_info(callbacks) -&gt;
    [{Name1, Arity1},...,{NameN, ArityN}].
</code></pre>

<p>where each <em>{Name, Arity}</em> specifies the name and arity of a callback function. This function is otherwise automatically generated by the compiler using the <em>-callback</em> attributes.</p>
<p>When the compiler encounters the module attribute <em>-behaviour(Behaviour).</em> in a module <em>Mod</em> , it calls <em>Behaviour:behaviour_info(callbacks)</em> and compares the result with the set of functions actually exported from <em>Mod</em> , and issues a warning if any callback function is missing.</p>
<p>Example:</p>
<pre><code>
%% User-defined behaviour module
-module(simple_server).
-export([start_link/2, init/3, ...]).

-callback init(State :: term()) -&gt; 'ok'.
-callback handle_req(Req :: term(), State :: term()) -&gt; {'ok', Reply :: term()}.
-callback terminate() -&gt; 'ok'.
-callback format_state(State :: term()) -&gt; term().

-optional_callbacks([format_state/1]).

%% Alternatively you may define:
%%
%% -export([behaviour_info/1]).
%% behaviour_info(callbacks) -&gt;
%%     [{init,1},
%%      {handle_req,2},
%%      {terminate,0}].

start_link(Name, Module) -&gt;
    proc_lib:start_link(?MODULE, init, [self(), Name, Module]).

init(Parent, Name, Module) -&gt;
    register(Name, self()),
    ...,
    Dbg = sys:debug_options([]),
    proc_lib:init_ack(Parent, {ok, self()}),
    loop(Parent, Module, Deb, ...).

...
</code></pre>

<p>In a callback module:</p>
<pre><code>
-module(db).
-behaviour(simple_server).

-export([init/1, handle_req/2, terminate/0]).

...
</code></pre>

<p>The contracts specified with <em>-callback</em> attributes in behaviour modules can be further refined by adding <em>-spec</em> attributes in callback modules. This can be useful as <em>-callback</em> contracts are usually generic. The same callback module with contracts for the callbacks:</p>
<pre><code>
-module(db).
-behaviour(simple_server).

-export([init/1, handle_req/2, terminate/0]).

-record(state, {field1 :: [atom()], field2 :: integer()}).

-type state()   :: #state{}.
-type request() :: {'store', term(), term()};
                   {'lookup', term()}.

...

-spec handle_req(request(), state()) -&gt; {'ok', term()}.

...
</code></pre>

<p>Each <em>-spec</em> contract is to be a subtype of the respective <em>-callback</em> contract.
<a name="appl">appl</a> 
This section is to be read with the <em>app(4)</em> and <em>application(3)</em> manual pages in Kernel.</p>
<h3 id="application-concept">Application Concept</h3>
<p>When you have written code implementing some specific functionality you might want to make the code into an <strong>application</strong> , that is, a component that can be started and stopped as a unit, and which can also be reused in other systems.</p>
<p>To do this, create an <a href="#callback_module">application callback module</a> , and describe how the application is to be started and stopped.</p>
<p>Then, an <strong>application specification</strong> is needed, which is put in an <a href="#appl_res_file">application resource file</a> . Among other things, this file specifies which modules the application consists of and the name of the callback module.</p>
<p>If you use <em>systools</em> , the Erlang/OTP tools for packaging code (see <a href="release_structure">Releases</a> ), the code for each application is placed in a separate directory following a pre-defined <a href="#app_dir">directory structure</a> .
 <a name="callback_module">callback_module</a> </p>
<h3 id="application-callback-module">Application Callback Module</h3>
<p>How to start and stop the code for the application, that is, the supervision tree, is described by two callback functions:</p>
<pre><code>
start(StartType, StartArgs) -&gt; {ok, Pid} | {ok, Pid, State}
stop(State)

</code></pre>

<ul>
<li><em>start</em> is called when starting the application and is to create the supervision tree by starting the top supervisor. It is expected to return the pid of the top supervisor and an optional term, <em>State</em> , which defaults to <em>[]</em> . This term is passed as is to <em>stop</em> .</li>
<li><em>StartType</em> is usually the atom <em>normal</em> . It has other values only in the case of a takeover or failover, see <a href="distributed_applications">Distributed Applications</a> .</li>
<li><em>StartArgs</em> is defined by the key <em>mod</em> in the <a href="#appl_res_file">application resource file</a> .</li>
<li><em>stop/1</em> is called <strong>after</strong> the application has been stopped and is to do any necessary cleaning up. The actual stopping of the application, that is, the shutdown of the supervision tree, is handled automatically as described in <a href="#stopping">Starting and Stopping Applications</a> .
 <a name="ch_app">ch_app</a> 
Example of an application callback module for packaging the supervision tree from <a href="./sup_princ#ex">Supervisor Behaviour</a> :</li>
</ul>
<pre><code>
-module(ch_app).
-behaviour(application).

-export([start/2, stop/1]).

start(_Type, _Args) -&gt;
    ch_sup:start_link().

stop(_State) -&gt;
    ok.
</code></pre>

<p>A library application that cannot be started or stopped, does not need any application callback module.
 <a name="appl_res_file">appl_res_file</a> </p>
<h3 id="application-resource-file">Application Resource File</h3>
<p>To define an application, an <strong>application specification</strong> is created, which is put in an <strong>application resource file</strong> , or in short an <em>.app</em> file:</p>
<pre><code>
{application, Application, [Opt1,...,OptN]}.
</code></pre>

<ul>
<li><em>Application</em> , an atom, is the name of the application. The file must be named <em>Application.app</em> .</li>
<li>Each <em>Opt</em> is a tuple <em>{Key,Value}</em> , which define a certain property of the application. All keys are optional. Default values are used for any omitted keys.</li>
</ul>
<p>The contents of a minimal <em>.app</em> file for a library application <em>libapp</em> looks as follows:</p>
<pre><code>
{application, libapp, []}.
</code></pre>

<p>The contents of a minimal <em>.app</em> file <em>ch_app.app</em> for a supervision tree application like <em>ch_app</em> looks as follows:</p>
<pre><code>
{application, ch_app,
 [{mod, {ch_app,[]}}]}.
</code></pre>

<p>The key <em>mod</em> defines the callback module and start argument of the application, in this case <em>ch_app</em> and <em>[]</em> , respectively. This means that the following is called when the application is to be started:</p>
<pre><code>
ch_app:start(normal, [])
</code></pre>

<p>The following is called when the application is stopped.</p>
<pre><code>
ch_app:stop([])
</code></pre>

<p>When using <em>systools</em> , the Erlang/OTP tools for packaging code (see Section <a href="release_structure">Releases</a> ), the keys <em>description</em> , <em>vsn</em> , <em>modules</em> , <em>registered</em> , and <em>applications</em> are also to be specified:</p>
<pre><code>
{application, ch_app,
 [{description, &quot;Channel allocator&quot;},
  {vsn, &quot;1&quot;},
  {modules, [ch_app, ch_sup, ch3]},
  {registered, [ch3]},
  {applications, [kernel, stdlib, sasl]},
  {mod, {ch_app,[]}}
 ]}.
</code></pre>

<ul>
<li><em>description</em> - A short description, a string. Defaults to "".</li>
<li><em>vsn</em> - Version number, a string. Defaults to "".</li>
<li><em>modules</em> - All modules <strong>introduced</strong> by this application. <em>systools</em> uses this list when generating boot scripts and tar files. A module must be defined in only one application. Defaults to <em>[]</em> .</li>
<li><em>registered</em> - All names of registered processes in the application. <em>systools</em> uses this list to detect name clashes between applications. Defaults to <em>[]</em> .</li>
<li><em>applications</em> - All applications that must be started before this application is started. <em>systools</em> uses this list to generate correct boot scripts. Defaults to <em>[]</em> . Notice that all applications have dependencies to at least Kernel and STDLIB.</li>
</ul>
<div class="admonition info">
<p class="admonition-title">Note</p>
</div>
<p>For details about the syntax and contents of the application resource file, see the <a href="./app">app</a> manual page in Kernel.</p>
<p><a name="app_dir">app_dir</a> </p>
<h3 id="directory-structure">Directory Structure</h3>
<p>When packaging code using <em>systools</em> , the code for each application is placed in a separate directory, <em>lib/Application-Vsn</em> , where <em>Vsn</em> is the version number.</p>
<p>This can be useful to know, even if <em>systools</em> is not used, since Erlang/OTP is packaged according to the OTP principles and thus comes with a specific directory structure. The code server (see the <a href="./code">kernel/code</a> manual page in Kernel) automatically uses code from the directory with the highest version number, if more than one version of an application is present.</p>
<h3 id="directory-structure-guidelines-for-a-development-environment">Directory Structure Guidelines for a Development Environment</h3>
<p>Any directory structure for development will suffice as long as the released directory structure adhere to the <a href="#app_dir_released">description below</a> , but it is encouraged that the same directory structure also be used in a development environment. The version number should be omitted from the application directory name since this is an artifact of the release step.</p>
<p>Some sub-directories are <strong>required</strong> . Some sub-directories are <strong>optional</strong> , meaning that it should only be used if the application itself requires it. Finally, some sub-directories are <strong>recommended</strong> , meaning it is encouraged that it is used and used as described here. For example, both documentation and tests are encouraged to exist in an application for it to be deemed a proper OTP application.</p>
<pre><code>
    ─ ${application}
      ├── doc
      │   ├── internal
      │   ├── examples
      │   └── src
      ├── include
      ├── priv
      ├── src
      │   └── ${application}.app.src
      └── test

</code></pre>

<ul>
<li><em>src</em> - Required. Contains the Erlang source code, the source of the <em>.app</em> file and internal include files used by the application itself. Additional sub-directories within <em>src</em> can be used as namespaces to organize source files. These directories should never be deeper than one level.</li>
<li><em>priv</em> - Optional. Used for application specific files.</li>
<li><em>include</em> - Optional. Used for public include files that must be reachable from other applications.</li>
<li><em>doc</em> - Recommended. Any source documentation should be placed in sub-directories here.</li>
<li><em>doc/internal</em> - Recommended. Any documentation that describes implementation details about this application, not intended for publication, should be placed here.</li>
<li><em>doc/examples</em> - Recommended. Source code for examples on how to use this application should be placed here. It is encouraged that examples are sourced to the public documentation from this directory.</li>
<li><em>doc/src</em> - Recommended. All source files for documentation, such as Markdown, AsciiDoc or XML-files, should be placed here.</li>
<li><em>test</em> - Recommended. All files regarding tests, such as test suites and test specifications, should be placed here.</li>
</ul>
<p>Other directories in the development environment may be needed. If source code from languages other than Erlang is used, for instance C-code for NIFs, that code should be placed in a separate directory. By convention it is recommended to prefix such directories with the language name, for example <em>c_src</em> for C, <em>java_src</em> for Java or <em>go_src</em> for Go. Directories with <em>_src</em> suffix indicates that it is a part of the application and the compilation step. The final build artifacts should target the <em>priv/lib</em> or <em>priv/bin</em> directories.</p>
<p>The <em>priv</em> directory holds assets that the application needs during runtime. Executables should reside in <em>priv/bin</em> and dynamically-linked libraries should reside in <em>priv/lib</em> . Other assets are free to reside within the <em>priv</em> directory but it is recommended it does so in a structured manner.</p>
<p>Source files from other languages that generate Erlang code, such as ASN.1 or Mibs, should be placed in directories, at the top level or in <em>src</em> , with the same name as the source language, for example <em>asn1</em> and <em>mibs</em> . Build artifacts should be placed in their respective language directory, such as <em>src</em> for Erlang code or <em>java_src</em> for Java code.</p>
<p>The <em>.app</em> file for release may reside in the <em>ebin</em> -directory in a development environment but it is encouraged that this is an artifact of the build step. By convention a <em>.app.src</em> file is used, which resides in the <em>src</em> directory. This file is nearly identical as the <em>.app</em> file but certain fields may be replaced during the build step, such as the application version.</p>
<p>Directory names should not be capitalized.</p>
<p>It is encouraged to omit empty directories.
 <a name="app_dir_released">app_dir_released</a> </p>
<h3 id="directory-structure-for-a-released-system">Directory Structure for a Released System</h3>
<p>A released application must follow a certain structure.</p>
<pre><code>
    ─ ${application}-${version}
      ├── bin
      ├── doc
      │   ├── html
      │   ├── man[1-9]
      │   ├── pdf
      │   ├── internal
      │   └── examples
      ├── ebin
      │   └── ${application}.app
      ├── include
      ├── priv
      │   ├── lib
      │   └── bin
      └── src

</code></pre>

<ul>
<li><em>src</em> - Optional. Contains the Erlang source code and internal include files used by the application itself. This directory is no longer required in a released application.</li>
<li><em>ebin</em> - Required. Contains the Erlang object code, the <em>beam</em> files. The <em>.app</em> file must also be placed here.</li>
<li><em>priv</em> - Optional. Used for application specific files. <em>code:priv_dir/1</em> is to be used to access this directory.</li>
<li><em>priv/lib</em> - Recommended. Any shared-object files that are used by the application, such as NIFs or linked-in-drivers, should be placed here.</li>
<li><em>priv/bin</em> - Recommended. Any executable that is used by the application, such as port-programs, should be placed here.</li>
<li><em>include</em> - Optional. Used for public include files that must be reachable from other applications.</li>
<li><em>bin</em> - Optional. Any executable that is a product of the application, such as escripts or shell-scripts, should be placed here.</li>
<li><em>doc</em> - Optional. Any released documentation should be placed in sub-directories here.</li>
<li><em>doc/man1</em> - Recommended. Man pages for Application executables.</li>
<li><em>doc/man3</em> - Recommended. Man pages for module APIs.</li>
<li><em>doc/man6</em> - Recommended. Man pages for Application overview.</li>
<li><em>doc/html</em> - Optional. HTML pages for the entire Application.</li>
<li><em>doc/pdf</em> - Optional. PDF documentation for the entire Application.</li>
</ul>
<p>The <em>src</em> directory could be useful to release for debugging purposes but is not required. The <em>include</em> directory should only be released if the applications has public include files.</p>
<p>The only documentation that is recommended to be released in this way are the man pages. HTML and PDF will normally be distributed in some other manner.</p>
<p>It is encouraged to omit empty directories.
 <a name="application_controller">application_controller</a> </p>
<h3 id="application-controller">Application Controller</h3>
<p>When an Erlang runtime system is started, a number of processes are started as part of the Kernel application. One of these processes is the <strong>application controller</strong> process, registered as <em>application_controller</em> .</p>
<p>All operations on applications are coordinated by the application controller. It is interacted through the functions in the module <em>application</em> , see the <em>application(3)</em> manual page in Kernel. In particular, applications can be loaded, unloaded, started, and stopped.</p>
<h3 id="loading-and-unloading-applications">Loading and Unloading Applications</h3>
<p>Before an application can be started, it must be <strong>loaded</strong> . The application controller reads and stores the information from the <em>.app</em> file:</p>
<pre><code>
1&gt;  application:load(ch_app). 
ok
2&gt; 
application:loaded_applications().

[{kernel,&quot;ERTS  CXC 138 10&quot;,&quot;2.8.1.3&quot;},
 {stdlib,&quot;ERTS  CXC 138 10&quot;,&quot;1.11.4.3&quot;},
 {ch_app,&quot;Channel allocator&quot;,&quot;1&quot;}]
</code></pre>

<p>An application that has been stopped, or has never been started, can be unloaded. The information about the application is erased from the internal database of the application controller.</p>
<pre><code>
3&gt;  application:unload(ch_app). 
ok
4&gt; 
application:loaded_applications().

[{kernel,&quot;ERTS  CXC 138 10&quot;,&quot;2.8.1.3&quot;},
 {stdlib,&quot;ERTS  CXC 138 10&quot;,&quot;1.11.4.3&quot;}]
</code></pre>

<div class="admonition info">
<p class="admonition-title">Note</p>
</div>
<p>Loading/unloading an application does not load/unload the code used by the application. Code loading is done the usual way.</p>
<p><a name="stopping">stopping</a> </p>
<h3 id="starting-and-stopping-applications">Starting and Stopping Applications</h3>
<p>An application is started by calling:</p>
<pre><code>
5&gt;  application:start(ch_app). 
ok
6&gt; 
application:which_applications().

[{kernel,&quot;ERTS  CXC 138 10&quot;,&quot;2.8.1.3&quot;},
 {stdlib,&quot;ERTS  CXC 138 10&quot;,&quot;1.11.4.3&quot;},
 {ch_app,&quot;Channel allocator&quot;,&quot;1&quot;}]
</code></pre>

<p>If the application is not already loaded, the application controller first loads it using <em>application:load/1</em> . It checks the value of the <em>applications</em> key, to ensure that all applications that are to be started before this application are running.
 <a name="application_master">application_master</a> 
The application controller then creates an <strong>application master</strong> for the application. The application master becomes the group leader of all the processes in the application. I/O is forwarded to the previous group leader, though, this is just a way to identify processes that belong to the application. Used for example to find itself from any process, or, reciprocally, to kill them all when it terminates.</p>
<p>The application master starts the application by calling the application callback function <em>start/2</em> in the module, and with the start argument, defined by the <em>mod</em> key in the <em>.app</em> file.</p>
<p>An application is stopped, but not unloaded, by calling:</p>
<pre><code>
7&gt;  application:stop(ch_app). 
ok
</code></pre>

<p>The application master stops the application by telling the top supervisor to shut down. The top supervisor tells all its child processes to shut down, and so on; the entire tree is terminated in reversed start order. The application master then calls the application callback function <em>stop/1</em> in the module defined by the <em>mod</em> key.</p>
<h3 id="configuring-an-application">Configuring an Application</h3>
<p>An application can be configured using <strong>configuration parameters</strong> . These are a list of <em>{Par,Val}</em> tuples specified by a key <em>env</em> in the <em>.app</em> file:</p>
<pre><code>
{application, ch_app,
 [{description, &quot;Channel allocator&quot;},
  {vsn, &quot;1&quot;},
  {modules, [ch_app, ch_sup, ch3]},
  {registered, [ch3]},
  {applications, [kernel, stdlib, sasl]},
  {mod, {ch_app,[]}},
  {env, [{file, &quot;/usr/local/log&quot;}]}
 ]}.
</code></pre>

<p><em>Par</em> is to be an atom. <em>Val</em> is any term. The application can retrieve the value of a configuration parameter by calling <em>application:get_env(App, Par)</em> or a number of similar functions, see the <em>application(3)</em> manual page in Kernel.</p>
<p><strong>Example:</strong></p>
<pre><code>
%  erl

Erlang (BEAM) emulator version 5.2.3.6 [hipe] [threads:0]

Eshell V5.2.3.6  (abort with ^G)
1&gt; 
application:start(ch_app). 
ok
2&gt; 
application:get_env(ch_app, file). 
{ok,&quot;/usr/local/log&quot;}
</code></pre>

<p>The values in the <em>.app</em> file can be overridden by values in a <strong>system configuration file</strong> . This is a file that contains configuration parameters for relevant applications:</p>
<pre><code>
[{Application1, [{Par11,Val11},...]},
 ...,
 {ApplicationN, [{ParN1,ValN1},...]}].
</code></pre>

<p>The system configuration is to be called <em>Name.config</em> and Erlang is to be started with the command-line argument <em>-config Name</em> . For details, see the <em>config(4)</em> manual page in Kernel.</p>
<p><strong>Example:</strong></p>
<p>A file <em>test.config</em> is created with the following contents:</p>
<pre><code>
[{ch_app, [{file, &quot;testlog&quot;}]}].
</code></pre>

<p>The value of <em>file</em> overrides the value of <em>file</em> as defined in the <em>.app</em> file:</p>
<pre><code>
%  erl -config test

Erlang (BEAM) emulator version 5.2.3.6 [hipe] [threads:0]

Eshell V5.2.3.6  (abort with ^G)
1&gt; 
application:start(ch_app). 
ok
2&gt; 
application:get_env(ch_app, file). 
{ok,&quot;testlog&quot;}
</code></pre>

<p>If <a href="./release_handling#sys">release handling</a> is used, exactly one system configuration file is to be used and that file is to be called <em>sys.config</em> .</p>
<p>The values in the <em>.app</em> file and the values in a system configuration file can be overridden directly from the command line:</p>
<pre><code>
%  erl -ApplName Par1 Val1 ... ParN ValN
</code></pre>

<p><strong>Example:</strong></p>
<pre><code>
%  erl -ch_app file '&quot;testlog&quot;'

Erlang (BEAM) emulator version 5.2.3.6 [hipe] [threads:0]

Eshell V5.2.3.6  (abort with ^G)
1&gt; 
application:start(ch_app). 
ok
2&gt; 
application:get_env(ch_app, file). 
{ok,&quot;testlog&quot;}
</code></pre>

<h3 id="application-start-types">Application Start Types</h3>
<p>A <strong>start type</strong> is defined when starting the application:</p>
<pre><code>
application:start(Application, Type)
</code></pre>

<p><em>application:start(Application)</em> is the same as calling <em>application:start(Application, temporary)</em> . The type can also be <em>permanent</em> or <em>transient</em> :</p>
<ul>
<li>If a permanent application terminates, all other applications and the runtime system are also terminated.</li>
<li>If a transient application terminates with reason <em>normal</em> , this is reported but no other applications are terminated. If a transient application terminates abnormally, that is with any other reason than <em>normal</em> , all other applications and the runtime system are also terminated.</li>
<li>If a temporary application terminates, this is reported but no other applications are terminated.</li>
</ul>
<p>An application can always be stopped explicitly by calling <em>application:stop/1</em> . Regardless of the mode, no other applications are affected.</p>
<p>The transient mode is of little practical use, since when a supervision tree terminates, the reason is set to <em>shutdown</em> , not <em>normal</em> .
<a name="included appl">included appl</a> </p>
<h3 id="introduction">Introduction</h3>
<p>An application can <strong>include</strong> other applications. An <strong>included application</strong> has its own application directory and <em>.app</em> file, but it is started as part of the supervisor tree of another application.</p>
<p>An application can only be included by one other application.</p>
<p>An included application can include other applications.</p>
<p>An application that is not included by any other application is called a <strong>primary application</strong> .
 <a name="inclappls">inclappls</a> <img alt="Primary Application and Included Applications" src="../inclappls.gif" /> 
The application controller automatically loads any included applications when loading a primary application, but does not start them. Instead, the top supervisor of the included application must be started by a supervisor in the including application.</p>
<p>This means that when running, an included application is in fact part of the primary application, and a process in an included application considers itself belonging to the primary application.</p>
<h3 id="specifying-included-applications">Specifying Included Applications</h3>
<p>Which applications to include is defined by the <em>included_applications</em> key in the <em>.app</em> file:</p>
<pre><code>
{application, prim_app,
 [{description, &quot;Tree application&quot;},
  {vsn, &quot;1&quot;},
  {modules, [prim_app_cb, prim_app_sup, prim_app_server]},
  {registered, [prim_app_server]},
  {included_applications, [incl_app]},
  {applications, [kernel, stdlib, sasl]},
  {mod, {prim_app_cb,[]}},
  {env, [{file, &quot;/usr/local/log&quot;}]}
 ]}.
</code></pre>

<h3 id="synchronizing-processes-during-startup">Synchronizing Processes during Startup</h3>
<p>The supervisor tree of an included application is started as part of the supervisor tree of the including application. If there is a need for synchronization between processes in the including and included applications, this can be achieved by using <strong>start phases</strong> .</p>
<p>Start phases are defined by the <em>start_phases</em> key in the <em>.app</em> file as a list of tuples <em>{Phase,PhaseArgs}</em> , where <em>Phase</em> is an atom and <em>PhaseArgs</em> is a term.</p>
<p>The value of the <em>mod</em> key of the including application must be set to <em>{application_starter,[Module,StartArgs]}</em> , where <em>Module</em> as usual is the application callback module. <em>StartArgs</em> is a term provided as argument to the callback function <em>Module:start/2</em> :</p>
<pre><code>
{application, prim_app,
 [{description, &quot;Tree application&quot;},
  {vsn, &quot;1&quot;},
  {modules, [prim_app_cb, prim_app_sup, prim_app_server]},
  {registered, [prim_app_server]},
  {included_applications, [incl_app]},
  {start_phases, [{init,[]}, {go,[]}]},
  {applications, [kernel, stdlib, sasl]},
  {mod, {application_starter,[prim_app_cb,[]]}},
  {env, [{file, &quot;/usr/local/log&quot;}]}
 ]}.

{application, incl_app,
 [{description, &quot;Included application&quot;},
  {vsn, &quot;1&quot;},
  {modules, [incl_app_cb, incl_app_sup, incl_app_server]},
  {registered, []},
  {start_phases, [{go,[]}]},
  {applications, [kernel, stdlib, sasl]},
  {mod, {incl_app_cb,[]}}
 ]}.
</code></pre>

<p>When starting a primary application with included applications, the primary application is started the normal way, that is:</p>
<ul>
<li>The application controller creates an application master for the application</li>
<li>The application master calls <em>Module:start(normal, StartArgs)</em> to start the top supervisor.</li>
</ul>
<p>Then, for the primary application and each included application in top-down, left-to-right order, the application master calls <em>Module:start_phase(Phase, Type, PhaseArgs)</em> for each phase defined for the primary application, in that order. If a phase is not defined for an included application, the function is not called for this phase and application.</p>
<p>The following requirements apply to the <em>.app</em> file for an included application:</p>
<ul>
<li>The <em>{mod, {Module,StartArgs}}</em> option must be included. This option is used to find the callback module <em>Module</em> of the application. <em>StartArgs</em> is ignored, as <em>Module:start/2</em> is called only for the primary application.</li>
<li>If the included application itself contains included applications, instead the <em>{mod, {application_starter, [Module,StartArgs]}}</em> option must be included.</li>
<li>The <em>{start_phases, [{Phase,PhaseArgs}]}</em> option must be included, and the set of specified phases must be a subset of the set of phases specified for the primary application.</li>
</ul>
<p>When starting <em>prim_app</em> as defined above, the application controller calls the following callback functions before <em>application:start(prim_app)</em> returns a value:</p>
<pre><code>
application:start(prim_app)
 =&gt; prim_app_cb:start(normal, [])
 =&gt; prim_app_cb:start_phase(init, normal, [])
 =&gt; prim_app_cb:start_phase(go, normal, [])
 =&gt; incl_app_cb:start_phase(go, normal, [])
ok
</code></pre>

<p><a name="distributed appl">distributed appl</a> </p>
<h3 id="introduction_1">Introduction</h3>
<p>In a distributed system with several Erlang nodes, it can be necessary to control applications in a distributed manner. If the node, where a certain application is running, goes down, the application is to be restarted at another node.</p>
<p>Such an application is called a <strong>distributed application</strong> . Notice that it is the control of the application that is distributed. All applications can be distributed in the sense that they, for example, use services on other nodes.</p>
<p>Since a distributed application can move between nodes, some addressing mechanism is required to ensure that it can be addressed by other applications, regardless on which node it currently executes. This issue is not addressed here, but the <em>global</em> or <em>pg2</em> modules in Kernel can be used for this purpose.</p>
<h3 id="specifying-distributed-applications">Specifying Distributed Applications</h3>
<p>Distributed applications are controlled by both the application controller and a distributed application controller process, <em>dist_ac</em> . Both these processes are part of the Kernel application. Distributed applications are thus specified by configuring the Kernel application, using the following configuration parameter (see also <em>kernel(6)</em> ):</p>
<p><em>distributed = [{Application, [Timeout,] NodeDesc}]</em></p>
<ul>
<li>Specifies where the application <em>Application = atom()</em> can execute.</li>
<li>
<blockquote>
<p><em>NodeDesc = [Node | {Node,...,Node}]</em> is a list of node names in priority order. The order between nodes in a tuple is undefined.</p>
</blockquote>
</li>
<li><em>Timeout = integer()</em> specifies how many milliseconds to wait before restarting the application at another node. It defaults to 0.</li>
</ul>
<p>For distribution of application control to work properly, the nodes where a distributed application can run must contact each other and negotiate where to start the application. This is done using the following configuration parameters in Kernel:</p>
<ul>
<li><em>sync_nodes_mandatory = [Node]</em> - Specifies which other nodes must be started (within the time-out specified by <em>sync_nodes_timeout</em> ).</li>
<li><em>sync_nodes_optional = [Node]</em> - Specifies which other nodes can be started (within the time-out specified by <em>sync_nodes_timeout</em> ).</li>
<li><em>sync_nodes_timeout = integer() | infinity</em> - Specifies how many milliseconds to wait for the other nodes to start.</li>
</ul>
<p>When started, the node waits for all nodes specified by <em>sync_nodes_mandatory</em> and <em>sync_nodes_optional</em> to come up. When all nodes are up, or when all mandatory nodes are up and the time specified by <em>sync_nodes_timeout</em> has elapsed, all applications start. If not all mandatory nodes are up, the node terminates.</p>
<p><strong>Example:</strong></p>
<p>An application <em>myapp</em> is to run at the node <em>cp1@cave</em> . If this node goes down, <em>myapp</em> is to be restarted at <em>cp2@cave</em> or <em>cp3@cave</em> . A system configuration file <em>cp1.config</em> for <em>cp1@cave</em> can look as follows:</p>
<pre><code>
[{kernel,
  [{distributed, [{myapp, 5000, [cp1@cave, {cp2@cave, cp3@cave}]}]},
   {sync_nodes_mandatory, [cp2@cave, cp3@cave]},
   {sync_nodes_timeout, 5000}
  ]
 }
].
</code></pre>

<p>The system configuration files for <em>cp2@cave</em> and <em>cp3@cave</em> are identical, except for the list of mandatory nodes, which is to be <em>[cp1@cave, cp3@cave]</em> for <em>cp2@cave</em> and <em>[cp1@cave, cp2@cave]</em> for <em>cp3@cave</em> .</p>
<div class="admonition info">
<p class="admonition-title">Note</p>
</div>
<p>All involved nodes must have the same value for <em>distributed</em> and <em>sync_nodes_timeout</em> . Otherwise the system behaviour is undefined.</p>
<h3 id="starting-and-stopping-distributed-applications">Starting and Stopping Distributed Applications</h3>
<p>When all involved (mandatory) nodes have been started, the distributed application can be started by calling <em>application:start(Application)</em> at <strong>all of these nodes.</strong></p>
<p>A boot script (see <a href="release_structure">Releases</a> ) can be used that automatically starts the application.</p>
<p>The application is started at the first operational node that is listed in the list of nodes in the <em>distributed</em> configuration parameter. The application is started as usual. That is, an application master is created and calls the application callback function:</p>
<pre><code>
Module:start(normal, StartArgs)
</code></pre>

<p>Example:</p>
<p>Continuing the example from the previous section, the three nodes are started, specifying the system configuration file:</p>
<pre><code>
&gt;  erl -sname cp1 -config cp1 
&gt;  erl -sname cp2 -config cp2 
&gt; 
erl -sname cp3 -config cp3
</code></pre>

<p>When all nodes are operational, <em>myapp</em> can be started. This is achieved by calling <em>application:start(myapp)</em> at all three nodes. It is then started at <em>cp1</em> , as shown in the following figure:
 <a name="dist1">dist1</a> <img alt="Application myapp - Situation 1" src="../dist1.gif" /> 
Similarly, the application must be stopped by calling <em>application:stop(Application)</em> at all involved nodes.</p>
<h3 id="failover">Failover</h3>
<p>If the node where the application is running goes down, the application is restarted (after the specified time-out) at the first operational node that is listed in the list of nodes in the <em>distributed</em> configuration parameter. This is called a <strong>failover</strong> .</p>
<p>The application is started the normal way at the new node, that is, by the application master calling:</p>
<pre><code>
Module:start(normal, StartArgs)
</code></pre>

<p>An exception is if the application has the <em>start_phases</em> key defined (see <a href="included_applications">Included Applications</a> ). The application is then instead started by calling:</p>
<pre><code>
Module:start({failover, Node}, StartArgs)
</code></pre>

<p>Here <em>Node</em> is the terminated node.</p>
<p><strong>Example:</strong></p>
<p>If <em>cp1</em> goes down, the system checks which one of the other nodes, <em>cp2</em> or <em>cp3</em> , has the least number of running applications, but waits for 5 seconds for <em>cp1</em> to restart. If <em>cp1</em> does not restart and <em>cp2</em> runs fewer applications than <em>cp3</em> , <em>myapp</em> is restarted on <em>cp2</em> .
 <a name="dist2">dist2</a> <img alt="Application myapp - Situation 2" src="../dist2.gif" /> 
Suppose now that <em>cp2</em> goes also down and does not restart within 5 seconds. <em>myapp</em> is now restarted on <em>cp3</em> .
 <a name="dist3">dist3</a> <img alt="Application myapp - Situation 3" src="../dist3.gif" /> </p>
<h3 id="takeover">Takeover</h3>
<p>If a node is started, which has higher priority according to <em>distributed</em> than the node where a distributed application is running, the application is restarted at the new node and stopped at the old node. This is called a <strong>takeover</strong> .</p>
<p>The application is started by the application master calling:</p>
<pre><code>
Module:start({takeover, Node}, StartArgs)
</code></pre>

<p>Here <em>Node</em> is the old node.</p>
<p><strong>Example:</strong></p>
<p>If <em>myapp</em> is running at <em>cp3</em> , and if <em>cp2</em> now restarts, it does not restart <em>myapp</em> , as the order between the <em>cp2</em> and <em>cp3</em> nodes is undefined.
 <a name="dist4">dist4</a> <img alt="Application myapp - Situation 4" src="../dist4.gif" /> 
However, if <em>cp1</em> also restarts, the function <em>application:takeover/2</em> moves <em>myapp</em> to <em>cp1</em> , as <em>cp1</em> has a higher priority than <em>cp3</em> for this application. In this case, <em>Module:start({takeover, cp3@cave}, StartArgs)</em> is executed at <em>cp1</em> to start the application.
 <a name="dist5">dist5</a> <img alt="Application myapp - Situation 5" src="../dist5.gif" />
<a name="releases section">releases section</a> 
This section is to be read with the <em>rel(4)</em> , <em>systools(3)</em> , and <em>script(4)</em> manual pages in SASL.</p>
<h3 id="release-concept">Release Concept</h3>
<p>When you have written one or more applications, you might want to create a complete system with these applications and a subset of the Erlang/OTP applications. This is called a <strong>release</strong> .</p>
<p>To do this, create a <a href="#res_file">release resource file</a> that defines which applications are included in the release.</p>
<p>The release resource file is used to generate <a href="#boot">boot scripts</a> and <a href="#pack">release packages</a> . A system that is transferred to and installed at another site is called a <strong>target system</strong> . How to use a release package to create a target system is described in System Principles.
 <a name="res_file">res_file</a> </p>
<h3 id="release-resource-file">Release Resource File</h3>
<p>To define a release, create a <strong>release resource file</strong> , or in short a <em>.rel</em> file. In the file, specify the name and version of the release, which ERTS version it is based on, and which applications it consists of:</p>
<pre><code>
{release, {Name,Vsn}, {erts, EVsn},
 [{Application1, AppVsn1},
   ...
  {ApplicationN, AppVsnN}]}.
</code></pre>

<p><em>Name</em> , <em>Vsn</em> , <em>EVsn</em> , and <em>AppVsn</em> are strings.</p>
<p>The file must be named <em>Rel.rel</em> , where <em>Rel</em> is a unique name.</p>
<p>Each <em>Application</em> (atom) and <em>AppVsn</em> is the name and version of an application included in the release. The minimal release based on Erlang/OTP consists of the Kernel and STDLIB applications, so these applications must be included in the list.</p>
<p>If the release is to be upgraded, it must also include the SASL application.
 <a name="ch_rel">ch_rel</a> 
<strong>Example:</strong> A release of <em>ch_app</em> from <a href="./applications#ch_app">Applications</a> has the following <em>.app</em> file:</p>
<pre><code>
{application, ch_app,
 [{description, &quot;Channel allocator&quot;},
  {vsn, &quot;1&quot;},
  {modules, [ch_app, ch_sup, ch3]},
  {registered, [ch3]},
  {applications, [kernel, stdlib, sasl]},
  {mod, {ch_app,[]}}
 ]}.
</code></pre>

<p>The <em>.rel</em> file must also contain <em>kernel</em> , <em>stdlib</em> , and <em>sasl</em> , as these applications are required by <em>ch_app</em> . The file is called <em>ch_rel-1.rel</em> :</p>
<pre><code>
{release,
 {&quot;ch_rel&quot;, &quot;A&quot;},
 {erts, &quot;5.3&quot;},
 [{kernel, &quot;2.9&quot;},
  {stdlib, &quot;1.12&quot;},
  {sasl, &quot;1.10&quot;},
  {ch_app, &quot;1&quot;}]
}.
</code></pre>

<p><a name="boot">boot</a> </p>
<h3 id="generating-boot-scripts">Generating Boot Scripts</h3>
<p><em>systools</em> in the SASL application includes tools to build and check releases. The functions read the <em>rel</em> and <em>.app</em> files and performs syntax and dependency checks. The <em>systools:make_script/1,2</em> function is used to generate a boot script (see System Principles):</p>
<pre><code>
1&gt;  systools:make_script(&quot;ch_rel-1&quot;, [local]). 
ok
</code></pre>

<p>This creates a boot script, both the readable version, <em>ch_rel-1.script</em> , and the binary version, <em>ch_rel-1.boot</em> , used by the runtime system.</p>
<ul>
<li><em>"ch_rel-1"</em> is the name of the <em>.rel</em> file, minus the extension.</li>
<li><em>local</em> is an option that means that the directories where the applications are found are used in the boot script, instead of <em>$ROOT/lib</em> ( <em>$ROOT</em> is the root directory of the installed release).</li>
</ul>
<p>This is a useful way to test a generated boot script locally.</p>
<p>When starting Erlang/OTP using the boot script, all applications from the <em>.rel</em> file are automatically loaded and started:</p>
<pre><code>
%  erl -boot ch_rel-1

Erlang (BEAM) emulator version 5.3

Eshell V5.3  (abort with ^G)
1&gt; 
=PROGRESS REPORT==== 13-Jun-2003::12:01:15 ===
          supervisor: {local,sasl_safe_sup}
             started: [{pid,
&lt;0.33.0&gt;},
                       {name,alarm_handler},
                       {mfa,{alarm_handler,start_link,[]}},
                       {restart_type,permanent},
                       {shutdown,2000},
                       {child_type,worker}]

...

=PROGRESS REPORT==== 13-Jun-2003::12:01:15 ===
         application: sasl
          started_at: nonode@nohost

...
=PROGRESS REPORT==== 13-Jun-2003::12:01:15 ===
         application: ch_app
          started_at: nonode@nohost
</code></pre>

<p><a name="pack">pack</a> </p>
<h3 id="creating-a-release-package">Creating a Release Package</h3>
<p>The <em>systools:make_tar/1,2</em> function takes a <em>.rel</em> file as input and creates a zipped tar file with the code for the specified applications, a <strong>release package</strong> :</p>
<pre><code>
1&gt;  systools:make_script(&quot;ch_rel-1&quot;). 
ok
2&gt; 
systools:make_tar(&quot;ch_rel-1&quot;). 
ok
</code></pre>

<p>The release package by default contains:</p>
<ul>
<li>The <em>.app</em> files</li>
<li>The <em>.rel</em> file</li>
<li>The object code for all applications, structured according to the <a href="./applications#app_dir">application directory structure</a></li>
<li>The binary boot script renamed to <em>start.boot</em></li>
</ul>
<pre><code>
%  tar tf ch_rel-1.tar

lib/kernel-2.9/ebin/kernel.app
lib/kernel-2.9/ebin/application.beam
...
lib/stdlib-1.12/ebin/stdlib.app
lib/stdlib-1.12/ebin/beam_lib.beam
...
lib/sasl-1.10/ebin/sasl.app
lib/sasl-1.10/ebin/sasl.beam
...
lib/ch_app-1/ebin/ch_app.app
lib/ch_app-1/ebin/ch_app.beam
lib/ch_app-1/ebin/ch_sup.beam
lib/ch_app-1/ebin/ch3.beam
releases/A/start.boot
releases/A/ch_rel-1.rel
releases/ch_rel-1.rel
</code></pre>

<p>A new boot script was generated, without the <em>local</em> option set, before the release package was made. In the release package, all application directories are placed under <em>lib</em> . You do not know where the release package will be installed, so no hard-coded absolute paths are allowed.</p>
<p>The release resource file <em>mysystem.rel</em> is duplicated in the tar file. Originally, this file was only stored in the <em>releases</em> directory to make it possible for the <em>release_handler</em> to extract this file separately. After unpacking the tar file, <em>release_handler</em> would automatically copy the file to <em>releases/FIRST</em> . However, sometimes the tar file is unpacked without involving the <em>release_handler</em> (for example, when unpacking the first target system) and the file is therefore now instead duplicated in the tar file so no manual copying is necessary.</p>
<p>If a <em>relup</em> file and/or a system configuration file called <em>sys.config</em> , or a <em>sys.config.src</em> , is found, these files are also included in the release package. See <a href="./release_handling#req">Release Handling</a> .</p>
<p>Options can be set to make the release package include source code and the ERTS binary as well.</p>
<p>For information on how to install the first target system, using a release package, see System Principles. For information on how to install a new release package in an existing system, see <a href="release_handling">Release Handling</a> .
 <a name="reldir">reldir</a> </p>
<h3 id="directory-structure_1">Directory Structure</h3>
<p>The directory structure for the code installed by the release handler from a release package is as follows:</p>
<pre><code>
$ROOT/lib/App1-AVsn1/ebin
                    /priv
         /App2-AVsn2/ebin
                    /priv
         ...
         /AppN-AVsnN/ebin
                    /priv
     /erts-EVsn/bin
     /releases/Vsn
     /bin
</code></pre>

<ul>
<li><em>lib</em> - Application directories</li>
<li><em>erts-EVsn/bin</em> - Erlang runtime system executables</li>
<li><em>releases/Vsn</em> - <em>.rel</em> file and boot script <em>start.boot</em> ; if present in the release package, <em>relup</em> and/or <em>sys.config</em> or <em>sys.config.src</em></li>
<li><em>bin</em> - Top-level Erlang runtime system executables</li>
</ul>
<p>Applications are not required to be located under directory <em>$ROOT/lib</em> . Several installation directories, which contain different parts of a system, can thus exist. For example, the previous example can be extended as follows:</p>
<pre><code>
$SECOND_ROOT/.../SApp1-SAVsn1/ebin
                             /priv
                /SApp2-SAVsn2/ebin
                             /priv
                ...
                /SAppN-SAVsnN/ebin
                             /priv

$THIRD_ROOT/TApp1-TAVsn1/ebin
                        /priv
           /TApp2-TAVsn2/ebin
                        /priv
           ...
           /TAppN-TAVsnN/ebin
                        /priv
</code></pre>

<p><em>$SECOND_ROOT</em> and <em>$THIRD_ROOT</em> are introduced as <em>variables</em> in the call to the <em>systools:make_script/2</em> function.</p>
<h3 id="disk-less-andor-read-only-clients">Disk-Less and/or Read-Only Clients</h3>
<p>If a complete system consists of disk-less and/or read-only client nodes, a <em>clients</em> directory is to be added to the <em>$ROOT</em> directory. A read-only node is a node with a read-only file system.</p>
<p>The <em>clients</em> directory is to have one subdirectory per supported client node. The name of each client directory is to be the name of the corresponding client node. As a minimum, each client directory is to contain the <em>bin</em> and <em>releases</em> subdirectories. These directories are used to store information about installed releases and to appoint the current release to the client. The <em>$ROOT</em> directory thus contains the following:</p>
<pre><code>
$ROOT/...
    /clients/ClientName1/bin
                        /releases/Vsn
            /ClientName2/bin
                        /releases/Vsn
            ...
            /ClientNameN/bin
                        /releases/Vsn
</code></pre>

<p>This structure is to be used if all clients are running the same type of Erlang machine. If there are clients running different types of Erlang machines, or on different operating systems, the <em>clients</em> directory can be divided into one subdirectory per type of Erlang machine. Alternatively, one <em>$ROOT</em> can be set up per type of machine. For each type, some of the directories specified for the <em>$ROOT</em> directory are to be included:</p>
<pre><code>
$ROOT/...
    /clients/Type1/lib
                  /erts-EVsn
                  /bin
                  /ClientName1/bin
                              /releases/Vsn
                  /ClientName2/bin
                              /releases/Vsn
                  ...
                  /ClientNameN/bin
                              /releases/Vsn
            ...
            /TypeN/lib
                  /erts-EVsn
                  /bin
                  ...
</code></pre>

<p>With this structure, the root directory for clients of <em>Type1</em> is <em>$ROOT/clients/Type1</em> .
<a name="release handling">release handling</a> </p>
<h3 id="release-handling-principles">Release Handling Principles</h3>
<p>An important feature of the Erlang programming language is the ability to change module code in runtime, <strong>code replacement</strong> , as described in the Erlang Reference Manual.</p>
<p>Based on this feature, the OTP application SASL provides a framework for upgrading and downgrading between different versions of an entire release in runtime. This is called <strong>release handling</strong> .</p>
<p>The framework consists of:</p>
<ul>
<li>Offline support - <em>systools</em> for generating scripts and building release packages</li>
<li>Online support - <em>release_handler</em> for unpacking and installing release packages</li>
</ul>
<p>The minimal system based on Erlang/OTP, enabling release handling, thus consists of the Kernel, STDLIB, and SASL applications.</p>
<h3 id="release-handling-workflow">Release Handling Workflow</h3>
<p><strong>Step 1</strong> ) A release is created as described in <a href="release_structure">Releases</a> .</p>
<p><strong>Step 2</strong> ) The release is transferred to and installed at target environment. For information of how to install the first target system, see System Principles.</p>
<p><strong>Step 3</strong> ) Modifications, for example, error corrections, are made to the code in the development environment.</p>
<p><strong>Step 4</strong> ) At some point, it is time to make a new version of release. The relevant <em>.app</em> files are updated and a new <em>.rel</em> file is written.</p>
<p><strong>Step 5</strong> ) For each modified application, an <a href="#appup">application upgrade file</a> , <em>.appup</em> , is created. In this file, it is described how to upgrade and/or downgrade between the old and new version of the application.</p>
<p><strong>Step 6</strong> ) Based on the <em>.appup</em> files, a <a href="#relup">release upgrade file</a> called <em>relup</em> , is created. This file describes how to upgrade and/or downgrade between the old and new version of the entire release.</p>
<p><strong>Step 7</strong> ) A new release package is made and transferred to the target system.</p>
<p><strong>Step 8</strong> ) The new release package is unpacked using the release handler.</p>
<p><strong>Step 9</strong> ) The new version of the release is installed, also using the release handler. This is done by evaluating the instructions in <em>relup</em> . Modules can be added, deleted, or reloaded, applications can be started, stopped, or restarted, and so on. In some cases, it is even necessary to restart the entire emulator.</p>
<ul>
<li>If the installation fails, the system can be rebooted. The old release version is then automatically used.</li>
<li>If the installation succeeds, the new version is made the default version, which is to now be used if there is a system reboot.</li>
</ul>
<h3 id="release-handling-aspects">Release Handling Aspects</h3>
<p><a href="appup_cookbook">Appup Cookbook</a> , contains examples of <em>.appup</em> files for typical cases of upgrades/downgrades that are normally easy to handle in runtime. However, many aspects can make release handling complicated, for example:</p>
<ul>
<li>
<p>Complicated or circular dependencies can make it difficult or even impossible to decide in which order things must be done without risking runtime errors during an upgrade or downgrade. Dependencies can be:</p>
</li>
<li>
<p>Between nodes</p>
</li>
<li>Between processes</li>
<li>Between modules</li>
<li>During release handling, non-affected processes continue normal execution. This can lead to time-outs or other problems. For example, new processes created in the time window between suspending processes using a certain module, and loading a new version of this module, can execute old code.</li>
</ul>
<p>It is thus recommended that code is changed in as small steps as possible, and always kept backwards compatible.
 <a name="req">req</a> </p>
<h3 id="requirements">Requirements</h3>
<p>For release handling to work properly, the runtime system must have knowledge about which release it is running. It must also be able to change (in runtime) which boot script and system configuration file to use if the system is rebooted, for example, by <em>heart</em> after a failure. Thus, Erlang must be started as an embedded system; for information on how to do this, see Embedded System.</p>
<p>For system reboots to work properly, it is also required that the system is started with heartbeat monitoring, see the <em>erl(1)</em> manual page in ERTS and the <em>heart(3)</em> manual page in Kernel</p>
<p>Other requirements:</p>
<ul>
<li>The boot script included in a release package must be generated from the same <em>.rel</em> file as the release package itself.</li>
</ul>
<p>Information about applications is fetched from the script when an upgrade or downgrade is performed.
* 
The system must be configured using only one system configuration file, called <em>sys.config</em> .</p>
<p>If found, this file is automatically included when a release package is created.
* 
All versions of a release, except the first one, must contain a <em>relup</em> file.</p>
<p>If found, this file is automatically included when a release package is created.</p>
<h3 id="distributed-systems">Distributed Systems</h3>
<p>If the system consists of several Erlang nodes, each node can use its own version of the release. The release handler is a locally registered process and must be called at each node where an upgrade or downgrade is required. A release handling instruction, <em>sync_nodes</em> , can be used to synchronize the release handler processes at a number of nodes, see the <em>appup(4)</em> manual page in SASL.
 <a name="instr">instr</a> </p>
<h3 id="release-handling-instructions">Release Handling Instructions</h3>
<p>OTP supports a set of <strong>release handling instructions</strong> that are used when creating <em>.appup</em> files. The release handler understands a subset of these, the <strong>low-level</strong> instructions. To make it easier for the user, there are also a number of <strong>high-level</strong> instructions, which are translated to low-level instructions by <em>systools:make_relup</em> .</p>
<p>Some of the most frequently used instructions are described in this section. The complete list of instructions is included in the <em>appup(4)</em> manual page in SASL.</p>
<p>First, some definitions:</p>
<ul>
<li><strong>Residence module</strong> - The module where a process has its tail-recursive loop function(s). If these functions are implemented in several modules, all those modules are residence modules for the process.</li>
<li><strong>Functional module</strong> - A module that is not a residence module for any process.</li>
</ul>
<p>For a process implemented using an OTP behaviour, the behaviour module is the residence module for that process. The callback module is a functional module.</p>
<h3 id="load_module">load_module</h3>
<p>If a simple extension has been made to a functional module, it is sufficient to load the new version of the module into the system, and remove the old version. This is called <strong>simple code replacement</strong> and for this the following instruction is used:</p>
<pre><code>
{load_module, Module}
</code></pre>

<h3 id="update">update</h3>
<p>If a more complex change has been made, for example, a change to the format of the internal state of a <em>gen_server</em> , simple code replacement is not sufficient. Instead, it is necessary to:</p>
<ul>
<li>Suspend the processes using the module (to avoid that they try to handle any requests before the code replacement is completed).</li>
<li>Ask them to transform the internal state format and switch to the new version of the module.</li>
<li>Remove the old version.</li>
<li>Resume the processes.</li>
</ul>
<p>This is called <strong>synchronized code replacement</strong> and for this the following instructions are used:</p>
<pre><code>
{update, Module, {advanced, Extra}}
{update, Module, supervisor}
</code></pre>

<p><em>update</em> with argument <em>{advanced,Extra}</em> is used when changing the internal state of a behaviour as described above. It causes behaviour processes to call the callback function <em>code_change</em> , passing the term <em>Extra</em> and some other information as arguments. See the manual pages for the respective behaviours and <a href="./appup_cookbook#int_state">Appup Cookbook</a> .</p>
<p><em>update</em> with argument <em>supervisor</em> is used when changing the start specification of a supervisor. See <a href="./appup_cookbook#sup">Appup Cookbook</a> .</p>
<p>When a module is to be updated, the release handler finds which processes that are <strong>using</strong> the module by traversing the supervision tree of each running application and checking all the child specifications:</p>
<pre><code>
{Id, StartFunc, Restart, Shutdown, Type, Modules}
</code></pre>

<p>A process uses a module if the name is listed in <em>Modules</em> in the child specification for the process.</p>
<p>If <em>Modules=dynamic</em> , which is the case for event managers, the event manager process informs the release handler about the list of currently installed event handlers ( <em>gen_event</em> ), and it is checked if the module name is in this list instead.</p>
<p>The release handler suspends, asks for code change, and resumes processes by calling the functions <em>sys:suspend/1,2</em> , <em>sys:change_code/4,5</em> , and <em>sys:resume/1,2</em> , respectively.</p>
<h3 id="add_module-and-delete_module">add_module and delete_module</h3>
<p>If a new module is introduced, the following instruction is used:</p>
<pre><code>
{add_module, Module}
</code></pre>

<p>The instruction loads the module and is necessary when running Erlang in embedded mode. It is not strictly required when running Erlang in interactive (default) mode, since the code server then automatically searches for and loads unloaded modules.</p>
<p>The opposite of <em>add_module</em> is <em>delete_module</em> , which unloads a module:</p>
<pre><code>
{delete_module, Module}
</code></pre>

<p>Any process, in any application, with <em>Module</em> as residence module, is killed when the instruction is evaluated. The user must therefore ensure that all such processes are terminated before deleting the module, to avoid a situation with failing supervisor restarts.</p>
<h3 id="application-instructions">Application Instructions</h3>
<p>The following is the instruction for adding an application:</p>
<pre><code>
{add_application, Application}
</code></pre>

<p>Adding an application means that the modules defined by the <em>modules</em> key in the <em>.app</em> file are loaded using a number of <em>add_module</em> instructions, and then the application is started.</p>
<p>The following is the instruction for removing an application:</p>
<pre><code>
{remove_application, Application}
</code></pre>

<p>Removing an application means that the application is stopped, the modules are unloaded using a number of <em>delete_module</em> instructions, and then the application specification is unloaded from the application controller.</p>
<p>The following is the instruction for restarting an application:</p>
<pre><code>
{restart_application, Application}
</code></pre>

<p>Restarting an application means that the application is stopped and then started again similar to using the instructions <em>remove_application</em> and <em>add_application</em> in sequence.</p>
<h3 id="apply-low-level">apply (Low-Level)</h3>
<p>To call an arbitrary function from the release handler, the following instruction is used:</p>
<pre><code>
{apply, {M, F, A}}
</code></pre>

<p>The release handler evalutes <em>apply(M, F, A)</em> .
 <a name="restart_new_emulator_instr">restart_new_emulator_instr</a> </p>
<h3 id="restart_new_emulator-low-level">restart_new_emulator (Low-Level)</h3>
<p>This instruction is used when changing to a new emulator version, or when any of the core applications Kernel, STDLIB, or SASL is upgraded. If a system reboot is needed for another reason, the <em>restart_emulator</em> instruction is to be used instead.</p>
<p>This instruction requires that the system is started with heartbeat monitoring, see the <em>erl(1)</em> manual page in ERTS and the <em>heart(3)</em> manual page in Kernel.</p>
<p>The <em>restart_new_emulator</em> instruction must always be the first instruction in a relup. If the relup is generated by <em>systools:make_relup/3,4</em> , this is automatically ensured.</p>
<p>When the release handler encounters the instruction, it first generates a temporary boot file, which starts the new versions of the emulator and the core applications, and the old version of all other applications. Then it shuts down the current emulator by calling <em>init:reboot()</em> , see the <em>init(3)</em> manual page in Kernel. All processes are terminated gracefully and the system is rebooted by the <em>heart</em> program, using the temporary boot file. After the reboot, the rest of the relup instructions are executed. This is done as a part of the temporary boot script.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
</div>
<p>This mechanism causes the new versions of the emulator and core applications to run with the old version of other applications during startup. Thus, take extra care to avoid incompatibility. Incompatible changes in the core applications can in some situations be necessary. If possible, such changes are preceded by deprecation over two major releases before the actual change. To ensure the application is not crashed by an incompatible change, always remove any call to deprecated functions as soon as possible.</p>
<p>An info report is written when the upgrade is completed. To programmatically find out if the upgrade is complete, call <em>release_handler:which_releases(current)</em> and check if it returns the expected (that is, the new) release.</p>
<p>The new release version must be made permanent when the new emulator is operational. Otherwise, the old version will be used if there is a new system reboot.</p>
<p>On UNIX, the release handler tells the <em>heart</em> program which command to use to reboot the system. The environment variable <em>HEART_COMMAND</em> , normally used by the <em>heart</em> program, is ignored in this case. The command instead defaults to <em>$ROOT/bin/start</em> . Another command can be set by using the SASL configuration parameter <em>start_prg</em> , see the <em>sasl(6)</em> manual page.
 <a name="restart_emulator_instr">restart_emulator_instr</a> </p>
<h3 id="restart_emulator-low-level">restart_emulator (Low-Level)</h3>
<p>This instruction is not related to upgrades of ERTS or any of the core applications. It can be used by any application to force a restart of the emulator after all upgrade instructions are executed.</p>
<p>A relup script can only have one <em>restart_emulator</em> instruction and it must always be placed at the end. If the relup is generated by <em>systools:make_relup/3,4</em> , this is automatically ensured.</p>
<p>When the release handler encounters the instruction, it shuts down the emulator by calling <em>init:reboot()</em> , see the <em>init(3)</em> manual page in Kernel. All processes are terminated gracefully and the system can then be rebooted by the <em>heart</em> program using the new release version. No more upgrade instruction is executed after the restart.
 <a name="appup">appup</a> </p>
<h3 id="application-upgrade-file">Application Upgrade File</h3>
<p>To define how to upgrade/downgrade between the current version and previous versions of an application, an <strong>application upgrade file</strong> , or in short an <em>.appup</em> file is created. The file is to be called <em>Application.appup</em> , where <em>Application</em> is the application name:</p>
<pre><code>
{Vsn,
 [{UpFromVsn1, InstructionsU1},
  ...,
  {UpFromVsnK, InstructionsUK}],
 [{DownToVsn1, InstructionsD1},
  ...,
  {DownToVsnK, InstructionsDK}]}.
</code></pre>

<ul>
<li><em>Vsn</em> , a string, is the current version of the application, as defined in the <em>.app</em> file.</li>
<li>Each <em>UpFromVsn</em> is a previous version of the application to upgrade from.</li>
<li>Each <em>DownToVsn</em> is a previous version of the application to downgrade to.</li>
<li>Each <em>Instructions</em> is a list of release handling instructions.</li>
</ul>
<p>For information about the syntax and contents of the <em>.appup</em> file, see the <em>appup(4)</em> manual page in SASL.</p>
<p><a href="appup_cookbook">Appup Cookbook</a> includes examples of <em>.appup</em> files for typical upgrade/downgrade cases.</p>
<p><strong>Example:</strong> Consider the release <em>ch_rel-1</em> from <a href="./release_structure#ch_rel">Releases</a> . Assume you want to add a function <em>available/0</em> to server <em>ch3</em> , which returns the number of available channels (when trying out the example, change in a copy of the original directory, so that the first versions are still available):</p>
<pre><code>
-module(ch3).
-behaviour(gen_server).

-export([start_link/0]).
-export([alloc/0, free/1]).
-export([available/0]).
-export([init/1, handle_call/3, handle_cast/2]).

start_link() -&gt;
    gen_server:start_link({local, ch3}, ch3, [], []).

alloc() -&gt;
    gen_server:call(ch3, alloc).

free(Ch) -&gt;
    gen_server:cast(ch3, {free, Ch}).

available() -&gt;
    gen_server:call(ch3, available).

init(_Args) -&gt;
    {ok, channels()}.

handle_call(alloc, _From, Chs) -&gt;
    {Ch, Chs2} = alloc(Chs),
    {reply, Ch, Chs2};
handle_call(available, _From, Chs) -&gt;
    N = available(Chs),
    {reply, N, Chs}.

handle_cast({free, Ch}, Chs) -&gt;
    Chs2 = free(Ch, Chs),
    {noreply, Chs2}.
</code></pre>

<p>A new version of the <em>ch_app.app</em> file must now be created, where the version is updated:</p>
<pre><code>
{application, ch_app,
 [{description, &quot;Channel allocator&quot;},
  {vsn, &quot;2&quot;},
  {modules, [ch_app, ch_sup, ch3]},
  {registered, [ch3]},
  {applications, [kernel, stdlib, sasl]},
  {mod, {ch_app,[]}}
 ]}.
</code></pre>

<p>To upgrade <em>ch_app</em> from <em>"1"</em> to <em>"2"</em> (and to downgrade from <em>"2"</em> to <em>"1"</em> ), you only need to load the new (old) version of the <em>ch3</em> callback module. Create the application upgrade file <em>ch_app.appup</em> in the <em>ebin</em> directory:</p>
<pre><code>
{&quot;2&quot;,
 [{&quot;1&quot;, [{load_module, ch3}]}],
 [{&quot;1&quot;, [{load_module, ch3}]}]
}.
</code></pre>

<p><a name="relup">relup</a> </p>
<h3 id="release-upgrade-file">Release Upgrade File</h3>
<p>To define how to upgrade/downgrade between the new version and previous versions of a release, a <strong>release upgrade file</strong> , or in short <em>relup</em> file, is to be created.</p>
<p>This file does not need to be created manually, it can be generated by <em>systools:make_relup/3,4</em> . The relevant versions of the <em>.rel</em> file, <em>.app</em> files, and <em>.appup</em> files are used as input. It is deducted which applications are to be added and deleted, and which applications that must be upgraded and/or downgraded. The instructions for this are fetched from the <em>.appup</em> files and transformed into a single list of low-level instructions in the right order.</p>
<p>If the <em>relup</em> file is relatively simple, it can be created manually. It it only to contain low-level instructions.</p>
<p>For details about the syntax and contents of the release upgrade file, see the <em>relup(4)</em> manual page in SASL.</p>
<p><strong>Example, continued from the previous section:</strong> You have a new version "2" of <em>ch_app</em> and an <em>.appup</em> file. A new version of the <em>.rel</em> file is also needed. This time the file is called <em>ch_rel-2.rel</em> and the release version string is changed from "A" to "B":</p>
<pre><code>
{release,
 {&quot;ch_rel&quot;, &quot;B&quot;},
 {erts, &quot;5.3&quot;},
 [{kernel, &quot;2.9&quot;},
  {stdlib, &quot;1.12&quot;},
  {sasl, &quot;1.10&quot;},
  {ch_app, &quot;2&quot;}]
}.
</code></pre>

<p>Now the <em>relup</em> file can be generated:</p>
<pre><code>
1&gt;  systools:make_relup(&quot;ch_rel-2&quot;, [&quot;ch_rel-1&quot;], [&quot;ch_rel-1&quot;]).

ok
</code></pre>

<p>This generates a <em>relup</em> file with instructions for how to upgrade from version "A" ("ch_rel-1") to version "B" ("ch_rel-2") and how to downgrade from version "B" to version "A".</p>
<p>Both the old and new versions of the <em>.app</em> and <em>.rel</em> files must be in the code path, as well as the <em>.appup</em> and (new) <em>.beam</em> files. The code path can be extended by using the option <em>path</em> :</p>
<pre><code>
1&gt;  systools:make_relup(&quot;ch_rel-2&quot;, [&quot;ch_rel-1&quot;], [&quot;ch_rel-1&quot;],

 [{path,[&quot;../ch_rel-1&quot;, 
 &quot;../ch_rel-1/lib/ch_app-1/ebin&quot;]}]).

ok
</code></pre>

<p><a name="rel_handler">rel_handler</a> </p>
<h3 id="installing-a-release">Installing a Release</h3>
<p>When you have made a new version of a release, a release package can be created with this new version and transferred to the target environment.</p>
<p>To install the new version of the release in runtime, the <strong>release handler</strong> is used. This is a process belonging to the SASL application, which handles unpacking, installation, and removal of release packages. It is communicated through the <em>release_handler</em> module. For details, see the <em>release_handler(3)</em> manual page in SASL.</p>
<p>Assuming there is an operational target system with installation root directory <em>$ROOT</em> , the release package with the new version of the release is to be copied to <em>$ROOT/releases</em> .</p>
<p>First, <strong>unpack</strong> the release package. The files are then extracted from the package:</p>
<pre><code>
release_handler:unpack_release(ReleaseName) =&gt; {ok, Vsn}
</code></pre>

<ul>
<li><em>ReleaseName</em> is the name of the release package except the <em>.tar.gz</em> extension.</li>
<li><em>Vsn</em> is the version of the unpacked release, as defined in its <em>.rel</em> file.</li>
</ul>
<p>A directory <em>$ROOT/lib/releases/Vsn</em> is created, where the <em>.rel</em> file, the boot script <em>start.boot</em> , the system configuration file <em>sys.config</em> , and <em>relup</em> are placed. For applications with new version numbers, the application directories are placed under <em>$ROOT/lib</em> . Unchanged applications are not affected.</p>
<p>An unpacked release can be <strong>installed</strong> . The release handler then evaluates the instructions in <em>relup</em> , step by step:</p>
<pre><code>
release_handler:install_release(Vsn) =&gt; {ok, FromVsn, []}
</code></pre>

<p>If an error occurs during the installation, the system is rebooted using the old version of the release. If installation succeeds, the system is afterwards using the new version of the release, but if anything happens and the system is rebooted, it starts using the previous version again.</p>
<p>To be made the default version, the newly installed release must be made <strong>permanent</strong> , which means the previous version becomes <strong>old</strong> :</p>
<pre><code>
release_handler:make_permanent(Vsn) =&gt; ok
</code></pre>

<p>The system keeps information about which versions are old and permanent in the files <em>$ROOT/releases/RELEASES</em> and <em>$ROOT/releases/start_erl.data</em> .</p>
<p>To downgrade from <em>Vsn</em> to <em>FromVsn</em> , <em>install_release</em> must be called again:</p>
<pre><code>
release_handler:install_release(FromVsn) =&gt; {ok, Vsn, []}
</code></pre>

<p>An installed, but not permanent, release can be <strong>removed</strong> . Information about the release is then deleted from <em>$ROOT/releases/RELEASES</em> and the release-specific code, that is, the new application directories and the <em>$ROOT/releases/Vsn</em> directory, are removed.</p>
<pre><code>
release_handler:remove_release(Vsn) =&gt; ok
</code></pre>

<h3 id="example-continued-from-the-previous-sections">Example (continued from the previous sections)</h3>
<p><strong>Step 1)</strong> Create a target system as described in System Principles of the first version <em>"A"</em> of <em>ch_rel</em> from <a href="./release_structure#ch_rel">Releases</a> . This time <em>sys.config</em> must be included in the release package. If no configuration is needed, the file is to contain the empty list:</p>
<pre><code>
[].
</code></pre>

<p><strong>Step 2)</strong> Start the system as a simple target system. In reality, it is to be started as an embedded system. However, using <em>erl</em> with the correct boot script and config file is enough for illustration purposes:</p>
<pre><code>
%  cd $ROOT 
% 
bin/erl -boot $ROOT/releases/A/start -config $ROOT/releases/A/sys

...
</code></pre>

<p><em>$ROOT</em> is the installation directory of the target system.</p>
<p><strong>Step 3)</strong> In another Erlang shell, generate start scripts and create a release package for the new version <em>"B"</em> . Remember to include (a possible updated) <em>sys.config</em> and the <em>relup</em> file, see <a href="#relup">Release Upgrade File</a> .</p>
<pre><code>
1&gt;  systools:make_script(&quot;ch_rel-2&quot;). 
ok
2&gt; 
systools:make_tar(&quot;ch_rel-2&quot;). 
ok
</code></pre>

<p>The new release package now also contains version "2" of <em>ch_app</em> and the <em>relup</em> file:</p>
<pre><code>
% tar tf ch_rel-2.tar 
lib/kernel-2.9/ebin/kernel.app
lib/kernel-2.9/ebin/application.beam
...
lib/stdlib-1.12/ebin/stdlib.app
lib/stdlib-1.12/ebin/beam_lib.beam
...      
lib/sasl-1.10/ebin/sasl.app
lib/sasl-1.10/ebin/sasl.beam
...
lib/ch_app-2/ebin/ch_app.app
lib/ch_app-2/ebin/ch_app.beam
lib/ch_app-2/ebin/ch_sup.beam
lib/ch_app-2/ebin/ch3.beam
releases/B/start.boot
releases/B/relup
releases/B/sys.config
releases/B/ch_rel-2.rel
releases/ch_rel-2.rel
</code></pre>

<p><strong>Step 4)</strong> Copy the release package <em>ch_rel-2.tar.gz</em> to the <em>$ROOT/releases</em> directory.</p>
<p><strong>Step 5)</strong> In the running target system, unpack the release package:</p>
<pre><code>
1&gt;  release_handler:unpack_release(&quot;ch_rel-2&quot;). 
{ok,&quot;B&quot;}
</code></pre>

<p>The new application version <em>ch_app-2</em> is installed under <em>$ROOT/lib</em> next to <em>ch_app-1</em> . The <em>kernel</em> , <em>stdlib</em> , and <em>sasl</em> directories are not affected, as they have not changed.</p>
<p>Under <em>$ROOT/releases</em> , a new directory <em>B</em> is created, containing <em>ch_rel-2.rel</em> , <em>start.boot</em> , <em>sys.config</em> , and <em>relup</em> .</p>
<p><strong>Step 6)</strong> Check if the function <em>ch3:available/0</em> is available:</p>
<pre><code>
2&gt;  ch3:available().

** exception error: undefined function ch3:available/0
</code></pre>

<p><strong>Step 7)</strong> Install the new release. The instructions in <em>$ROOT/releases/B/relup</em> are executed one by one, resulting in the new version of <em>ch3</em> being loaded. The function <em>ch3:available/0</em> is now available:</p>
<pre><code>
3&gt;  release_handler:install_release(&quot;B&quot;). 
{ok,&quot;A&quot;,[]}
4&gt; 
ch3:available(). 
3
5&gt;  code:which(ch3).

&quot;.../lib/ch_app-2/ebin/ch3.beam&quot;
6&gt;  code:which(ch_sup).

&quot;.../lib/ch_app-1/ebin/ch_sup.beam&quot;
</code></pre>

<p>Processes in <em>ch_app</em> for which code have not been updated, for example, the supervisor, are still evaluating code from <em>ch_app-1</em> .</p>
<p><strong>Step 8)</strong> If the target system is now rebooted, it uses version "A" again. The "B" version must be made permanent, to be used when the system is rebooted.</p>
<pre><code>
7&gt;  release_handler:make_permanent(&quot;B&quot;). 
ok
</code></pre>

<p><a name="sys">sys</a> </p>
<h3 id="updating-application-specifications">Updating Application Specifications</h3>
<p>When a new version of a release is installed, the application specifications are automatically updated for all loaded applications.</p>
<div class="admonition info">
<p class="admonition-title">Note</p>
</div>
<p>The information about the new application specifications is fetched from the boot script included in the release package. Thus, it is important that the boot script is generated from the same <em>.rel</em> file as is used to build the release package itself.</p>
<p>Specifically, the application configuration parameters are automatically updated according to (in increasing priority order):</p>
<ul>
<li>The data in the boot script, fetched from the new application resource file <em>App.app</em></li>
<li>The new <em>sys.config</em></li>
<li>Command-line arguments <em>-App Par Val</em></li>
</ul>
<p>This means that parameter values set in the other system configuration files and values set using <em>application:set_env/3</em> are disregarded.</p>
<p>When an installed release is made permanent, the system process <em>init</em> is set to point out the new <em>sys.config</em> .</p>
<p>After the installation, the application controller compares the old and new configuration parameters for all running applications and call the callback function:</p>
<pre><code>
Module:config_change(Changed, New, Removed)
</code></pre>

<ul>
<li><em>Module</em> is the application callback module as defined by the <em>mod</em> key in the <em>.app</em> file.</li>
<li><em>Changed</em> and <em>New</em> are lists of <em>{Par,Val}</em> for all changed and added configuration parameters, respectively.</li>
<li><em>Removed</em> is a list of all parameters <em>Par</em> that have been removed.</li>
</ul>
<p>The function is optional and can be omitted when implementing an application callback module.
<a name="appup cookbook">appup cookbook</a> 
This section includes examples of <em>.appup</em> files for typical cases of upgrades/downgrades done in runtime.</p>
<h3 id="changing-a-functional-module">Changing a Functional Module</h3>
<p>When a functional module has been changed, for example, if a new function has been added or a bug has been corrected, simple code replacement is sufficient, for example:</p>
<pre><code>
{&quot;2&quot;,
 [{&quot;1&quot;, [{load_module, m}]}],
 [{&quot;1&quot;, [{load_module, m}]}]
}.
</code></pre>

<h3 id="changing-a-residence-module">Changing a Residence Module</h3>
<p>In a system implemented according to the OTP design principles, all processes, except system processes and special processes, reside in one of the behaviours <em>supervisor</em> , <em>gen_server</em> , <em>gen_fsm</em> , <em>gen_statem</em> or <em>gen_event</em> . These belong to the STDLIB application and upgrading/downgrading normally requires an emulator restart.</p>
<p>OTP thus provides no support for changing residence modules except in the case of <a href="#spec">special processes</a> .</p>
<h3 id="changing-a-callback-module">Changing a Callback Module</h3>
<p>A callback module is a functional module, and for code extensions simple code replacement is sufficient.</p>
<p><strong>Example:</strong> When adding a function to <em>ch3</em> , as described in the example in <a href="./release_handling#appup">Release Handling</a> , <em>ch_app.appup</em> looks as follows:</p>
<pre><code>
{&quot;2&quot;,
 [{&quot;1&quot;, [{load_module, ch3}]}],
 [{&quot;1&quot;, [{load_module, ch3}]}]
}.
</code></pre>

<p>OTP also supports changing the internal state of behaviour processes, see <a href="#int_state">Changing Internal State</a> .
 <a name="int_state">int_state</a> </p>
<h3 id="changing-internal-state">Changing Internal State</h3>
<p>In this case, simple code replacement is not sufficient. The process must explicitly transform its state using the callback function <em>code_change</em> before switching to the new version of the callback module. Thus, synchronized code replacement is used.</p>
<p><strong>Example:</strong> Consider <em>gen_server</em> <em>ch3</em> from <a href="./gen_server_concepts#ex">gen_server Behaviour</a> . The internal state is a term <em>Chs</em> representing the available channels. Assume you want to add a counter <em>N</em> , which keeps track of the number of <em>alloc</em> requests so far. This means that the format must be changed to <em>{Chs,N}</em> .</p>
<p>The <em>.appup</em> file can look as follows:</p>
<pre><code>
{&quot;2&quot;,
 [{&quot;1&quot;, [{update, ch3, {advanced, []}}]}],
 [{&quot;1&quot;, [{update, ch3, {advanced, []}}]}]
}.
</code></pre>

<p>The third element of the <em>update</em> instruction is a tuple <em>{advanced,Extra}</em> , which says that the affected processes are to do a state transformation before loading the new version of the module. This is done by the processes calling the callback function <em>code_change</em> (see the <em>gen_server(3)</em> manual page in STDLIB). The term <em>Extra</em> , in this case <em>[]</em> , is passed as is to the function:
 <a name="code_change">code_change</a> </p>
<pre><code>
-module(ch3).
...
-export([code_change/3]).
...
code_change({down, _Vsn}, {Chs, N}, _Extra) -&gt;
    {ok, Chs};
code_change(_Vsn, Chs, _Extra) -&gt;
    {ok, {Chs, 0}}.
</code></pre>

<p>The first argument is <em>{down,Vsn}</em> if there is a downgrade, or <em>Vsn</em> if there is a upgrade. The term <em>Vsn</em> is fetched from the 'original' version of the module, that is, the version you are upgrading from, or downgrading to.</p>
<p>The version is defined by the module attribute <em>vsn</em> , if any. There is no such attribute in <em>ch3</em> , so in this case the version is the checksum (a huge integer) of the beam file, an uninteresting value, which is ignored.</p>
<p>The other callback functions of <em>ch3</em> must also be modified and perhaps a new interface function must be added, but this is not shown here.</p>
<h3 id="module-dependencies">Module Dependencies</h3>
<p>Assume that a module is extended by adding an interface function, as in the example in <a href="./release_handling#appup">Release Handling</a> , where a function <em>available/0</em> is added to <em>ch3</em> .</p>
<p>If a call is added to this function, say in module <em>m1</em> , a runtime error could can occur during release upgrade if the new version of <em>m1</em> is loaded first and calls <em>ch3:available/0</em> before the new version of <em>ch3</em> is loaded.</p>
<p>Thus, <em>ch3</em> must be loaded before <em>m1</em> , in the upgrade case, and conversely in the downgrade case. <em>m1</em> is said to be <strong>dependent on</strong> <em>ch3</em> . In a release handling instruction, this is expressed by the <em>DepMods</em> element:</p>
<pre><code>
{load_module, Module, DepMods}
{update, Module, {advanced, Extra}, DepMods}
</code></pre>

<p><em>DepMods</em> is a list of modules, on which <em>Module</em> is dependent.</p>
<p><strong>Example:</strong> The module <em>m1</em> in application <em>myapp</em> is dependent on <em>ch3</em> when upgrading from "1" to "2", or downgrading from "2" to "1":</p>
<pre><code>
myapp.appup:

{&quot;2&quot;,
 [{&quot;1&quot;, [{load_module, m1, [ch3]}]}],
 [{&quot;1&quot;, [{load_module, m1, [ch3]}]}]
}.

ch_app.appup:

{&quot;2&quot;,
 [{&quot;1&quot;, [{load_module, ch3}]}],
 [{&quot;1&quot;, [{load_module, ch3}]}]
}.
</code></pre>

<p>If instead <em>m1</em> and <em>ch3</em> belong to the same application, the <em>.appup</em> file can look as follows:</p>
<pre><code>
{&quot;2&quot;,
 [{&quot;1&quot;,
   [{load_module, ch3},
    {load_module, m1, [ch3]}]}],
 [{&quot;1&quot;,
   [{load_module, ch3},
    {load_module, m1, [ch3]}]}]
}.
</code></pre>

<p><em>m1</em> is dependent on <em>ch3</em> also when downgrading. <em>systools</em> knows the difference between up- and downgrading and generates a correct <em>relup</em> , where <em>ch3</em> is loaded before <em>m1</em> when upgrading, but <em>m1</em> is loaded before <em>ch3</em> when downgrading.
 <a name="spec">spec</a> </p>
<h3 id="changing-code-for-a-special-process">Changing Code for a Special Process</h3>
<p>In this case, simple code replacement is not sufficient. When a new version of a residence module for a special process is loaded, the process must make a fully qualified call to its loop function to switch to the new code. Thus, synchronized code replacement must be used.</p>
<div class="admonition info">
<p class="admonition-title">Note</p>
</div>
<p>The name(s) of the user-defined residence module(s) must be listed in the <em>Modules</em> part of the child specification for the special process. Otherwise the release handler cannot find the process.</p>
<p><strong>Example:</strong> Consider the example <em>ch4</em> in <a href="./spec_proc#ex">sys and proc_lib</a> . When started by a supervisor, the child specification can look as follows:</p>
<pre><code>
{ch4, {ch4, start_link, []},
 permanent, brutal_kill, worker, [ch4]}
</code></pre>

<p>If <em>ch4</em> is part of the application <em>sp_app</em> and a new version of the module is to be loaded when upgrading from version "1" to "2" of this application, <em>sp_app.appup</em> can look as follows:</p>
<pre><code>
{&quot;2&quot;,
 [{&quot;1&quot;, [{update, ch4, {advanced, []}}]}],
 [{&quot;1&quot;, [{update, ch4, {advanced, []}}]}]
}.
</code></pre>

<p>The <em>update</em> instruction must contain the tuple <em>{advanced,Extra}</em> . The instruction makes the special process call the callback function <em>system_code_change/4</em> , a function the user must implement. The term <em>Extra</em> , in this case <em>[]</em> , is passed as is to <em>system_code_change/4</em> :</p>
<pre><code>
-module(ch4).
...
-export([system_code_change/4]).
...

system_code_change(Chs, _Module, _OldVsn, _Extra) -&gt;
    {ok, Chs}.
</code></pre>

<ul>
<li>The first argument is the internal state <em>State</em> , passed from function <em>sys:handle_system_msg(Request, From, Parent, Module, Deb, State)</em> , and called by the special process when a system message is received. In <em>ch4</em> , the internal state is the set of available channels <em>Chs</em> .</li>
<li>The second argument is the name of the module ( <em>ch4</em> ).</li>
<li>The third argument is <em>Vsn</em> or <em>{down,Vsn}</em> , as described for <em>gen_server:code_change/3</em> in <a href="#code_change">Changing Internal State</a> .</li>
</ul>
<p>In this case, all arguments but the first are ignored and the function simply returns the internal state again. This is enough if the code only has been extended. If instead the internal state is changed (similar to the example in <a href="#int_state">Changing Internal State</a> ), this is done in this function and <em>{ok,Chs2}</em> returned.
 <a name="sup">sup</a> </p>
<h3 id="changing-a-supervisor">Changing a Supervisor</h3>
<p>The supervisor behaviour supports changing the internal state, that is, changing the restart strategy and maximum restart frequency properties, as well as changing the existing child specifications.</p>
<p>Child processes can be added or deleted, but this is not handled automatically. Instructions must be given by in the <em>.appup</em> file.</p>
<h3 id="changing-properties">Changing Properties</h3>
<p>Since the supervisor is to change its internal state, synchronized code replacement is required. However, a special <em>update</em> instruction must be used.</p>
<p>First, the new version of the callback module must be loaded, both in the case of upgrade and downgrade. Then the new return value of <em>init/1</em> can be checked and the internal state be changed accordingly.</p>
<p>The following <em>upgrade</em> instruction is used for supervisors:</p>
<pre><code>
{update, Module, supervisor}
</code></pre>

<p><strong>Example:</strong> To change the restart strategy of <em>ch_sup</em> (from <a href="./sup_princ#ex">Supervisor Behaviour</a> ) from <em>one_for_one</em> to <em>one_for_all</em> , change the callback function <em>init/1</em> in <em>ch_sup.erl</em> :</p>
<pre><code>
-module(ch_sup).
...

init(_Args) -&gt;
    {ok, {#{strategy =&gt; one_for_all, ...}, ...}}.
</code></pre>

<p>The file <em>ch_app.appup</em> :</p>
<pre><code>
{&quot;2&quot;,
 [{&quot;1&quot;, [{update, ch_sup, supervisor}]}],
 [{&quot;1&quot;, [{update, ch_sup, supervisor}]}]
}.
</code></pre>

<h3 id="changing-child-specifications">Changing Child Specifications</h3>
<p>The instruction, and thus the <em>.appup</em> file, when changing an existing child specification, is the same as when changing properties as described earlier:</p>
<pre><code>
{&quot;2&quot;,
 [{&quot;1&quot;, [{update, ch_sup, supervisor}]}],
 [{&quot;1&quot;, [{update, ch_sup, supervisor}]}]
}.
</code></pre>

<p>The changes do not affect existing child processes. For example, changing the start function only specifies how the child process is to be restarted, if needed later on.</p>
<p>The id of the child specification cannot be changed.</p>
<p>Changing the <em>Modules</em> field of the child specification can affect the release handling process itself, as this field is used to identify which processes are affected when doing a synchronized code replacement.
 <a name="sup_add">sup_add</a> </p>
<h3 id="adding-and-deleting-child-processes">Adding and Deleting Child Processes</h3>
<p>As stated earlier, changing child specifications does not affect existing child processes. New child specifications are automatically added, but not deleted. Child processes are not automatically started or terminated, this must be done using <em>apply</em> instructions.</p>
<p><strong>Example:</strong> Assume a new child process <em>m1</em> is to be added to <em>ch_sup</em> when upgrading <em>ch_app</em> from "1" to "2". This means <em>m1</em> is to be deleted when downgrading from "2" to "1":</p>
<pre><code>
{&quot;2&quot;,
 [{&quot;1&quot;,
   [{update, ch_sup, supervisor},
    {apply, {supervisor, restart_child, [ch_sup, m1]}}
   ]}],
 [{&quot;1&quot;,
   [{apply, {supervisor, terminate_child, [ch_sup, m1]}},
    {apply, {supervisor, delete_child, [ch_sup, m1]}},
    {update, ch_sup, supervisor}
   ]}]
}.
</code></pre>

<p>The order of the instructions is important.</p>
<p>The supervisor must be registered as <em>ch_sup</em> for the script to work. If the supervisor is not registered, it cannot be accessed directly from the script. Instead a help function that finds the pid of the supervisor and calls <em>supervisor:restart_child</em> , and so on, must be written. This function is then to be called from the script using the <em>apply</em> instruction.</p>
<p>If the module <em>m1</em> is introduced in version "2" of <em>ch_app</em> , it must also be loaded when upgrading and deleted when downgrading:</p>
<pre><code>
{&quot;2&quot;,
 [{&quot;1&quot;,
   [{add_module, m1},
    {update, ch_sup, supervisor},
    {apply, {supervisor, restart_child, [ch_sup, m1]}}
   ]}],
 [{&quot;1&quot;,
   [{apply, {supervisor, terminate_child, [ch_sup, m1]}},
    {apply, {supervisor, delete_child, [ch_sup, m1]}},
    {update, ch_sup, supervisor},
    {delete_module, m1}
   ]}]
}.
</code></pre>

<p>As stated earlier, the order of the instructions is important. When upgrading, <em>m1</em> must be loaded, and the supervisor child specification changed, before the new child process can be started. When downgrading, the child process must be terminated before the child specification is changed and the module is deleted.</p>
<h3 id="adding-or-deleting-a-module">Adding or Deleting a Module</h3>
<p><strong>Example:</strong> A new functional module <em>m</em> is added to <em>ch_app</em> :</p>
<pre><code>
{&quot;2&quot;,
 [{&quot;1&quot;, [{add_module, m}]}],
 [{&quot;1&quot;, [{delete_module, m}]}]
</code></pre>

<h3 id="starting-or-terminating-a-process">Starting or Terminating a Process</h3>
<p>In a system structured according to the OTP design principles, any process would be a child process belonging to a supervisor, see <a href="#sup_add">Adding and Deleting Child Processes</a> in Changing a Supervisor.</p>
<h3 id="adding-or-removing-an-application">Adding or Removing an Application</h3>
<p>When adding or removing an application, no <em>.appup</em> file is needed. When generating <em>relup</em> , the <em>.rel</em> files are compared and the <em>add_application</em> and <em>remove_application</em> instructions are added automatically.</p>
<h3 id="restarting-an-application">Restarting an Application</h3>
<p>Restarting an application is useful when a change is too complicated to be made without restarting the processes, for example, if the supervisor hierarchy has been restructured.</p>
<p><strong>Example:</strong> When adding a child <em>m1</em> to <em>ch_sup</em> , as in <a href="#sup_add">Adding and Deleting Child Processes</a> in Changing a Supervisor, an alternative to updating the supervisor is to restart the entire application:</p>
<pre><code>
{&quot;2&quot;,
 [{&quot;1&quot;, [{restart_application, ch_app}]}],
 [{&quot;1&quot;, [{restart_application, ch_app}]}]
}.
</code></pre>

<p><a name="app_spec">app_spec</a> </p>
<h3 id="changing-an-application-specification">Changing an Application Specification</h3>
<p>When installing a release, the application specifications are automatically updated before evaluating the <em>relup</em> script. Thus, no instructions are needed in the <em>.appup</em> file:</p>
<pre><code>
{&quot;2&quot;,
 [{&quot;1&quot;, []}],
 [{&quot;1&quot;, []}]
}.
</code></pre>

<h3 id="changing-application-configuration">Changing Application Configuration</h3>
<p>Changing an application configuration by updating the <em>env</em> key in the <em>.app</em> file is an instance of changing an application specification, see the previous section.</p>
<p>Alternatively, application configuration parameters can be added or updated in <em>sys.config</em> .</p>
<h3 id="changing-included-applications">Changing Included Applications</h3>
<p>The release handling instructions for adding, removing, and restarting applications apply to primary applications only. There are no corresponding instructions for included applications. However, since an included application is really a supervision tree with a topmost supervisor, started as a child process to a supervisor in the including application, a <em>relup</em> file can be manually created.</p>
<p><strong>Example:</strong> Assume there is a release containing an application <em>prim_app</em> , which have a supervisor <em>prim_sup</em> in its supervision tree.</p>
<p>In a new version of the release, the application <em>ch_app</em> is to be included in <em>prim_app</em> . That is, its topmost supervisor <em>ch_sup</em> is to be started as a child process to <em>prim_sup</em> .</p>
<p>The workflow is as follows:</p>
<p><strong>Step 1)</strong> Edit the code for <em>prim_sup</em> :</p>
<pre><code>
init(...) -&gt;
    {ok, {...supervisor flags...,
          [...,
           {ch_sup, {ch_sup,start_link,[]},
            permanent,infinity,supervisor,[ch_sup]},
           ...]}}.
</code></pre>

<p><strong>Step 2)</strong> Edit the <em>.app</em> file for <em>prim_app</em> :</p>
<pre><code>
{application, prim_app,
 [...,
  {vsn, &quot;2&quot;},
  ...,
  {included_applications, [ch_app]},
  ...
 ]}.
</code></pre>

<p><strong>Step 3)</strong> Create a new <em>.rel</em> file, including <em>ch_app</em> :</p>
<pre><code>
{release,
 ...,
 [...,
  {prim_app, &quot;2&quot;},
  {ch_app, &quot;1&quot;}]}.
</code></pre>

<p>The included application can be started in two ways. This is described in the next two sections.</p>
<h3 id="application-restart">Application Restart</h3>
<p><strong>Step 4a)</strong> One way to start the included application is to restart the entire <em>prim_app</em> application. Normally, the <em>restart_application</em> instruction in the <em>.appup</em> file for <em>prim_app</em> would be used.</p>
<p>However, if this is done and a <em>relup</em> file is generated, not only would it contain instructions for restarting (that is, removing and adding) <em>prim_app</em> , it would also contain instructions for starting <em>ch_app</em> (and stopping it, in the case of downgrade). This is because <em>ch_app</em> is included in the new <em>.rel</em> file, but not in the old one.</p>
<p>Instead, a correct <em>relup</em> file can be created manually, either from scratch or by editing the generated version. The instructions for starting/stopping <em>ch_app</em> are replaced by instructions for loading/unloading the application:</p>
<pre><code>
{&quot;B&quot;,
 [{&quot;A&quot;,
   [],
   [{load_object_code,{ch_app,&quot;1&quot;,[ch_sup,ch3]}},
    {load_object_code,{prim_app,&quot;2&quot;,[prim_app,prim_sup]}},
    point_of_no_return,
    {apply,{application,stop,[prim_app]}},
    {remove,{prim_app,brutal_purge,brutal_purge}},
    {remove,{prim_sup,brutal_purge,brutal_purge}},
    {purge,[prim_app,prim_sup]},
    {load,{prim_app,brutal_purge,brutal_purge}},
    {load,{prim_sup,brutal_purge,brutal_purge}},
    {load,{ch_sup,brutal_purge,brutal_purge}},
    {load,{ch3,brutal_purge,brutal_purge}},
    {apply,{application,load,[ch_app]}},
    {apply,{application,start,[prim_app,permanent]}}]}],
 [{&quot;A&quot;,
   [],
   [{load_object_code,{prim_app,&quot;1&quot;,[prim_app,prim_sup]}},
    point_of_no_return,
    {apply,{application,stop,[prim_app]}},
    {apply,{application,unload,[ch_app]}},
    {remove,{ch_sup,brutal_purge,brutal_purge}},
    {remove,{ch3,brutal_purge,brutal_purge}},
    {purge,[ch_sup,ch3]},
    {remove,{prim_app,brutal_purge,brutal_purge}},
    {remove,{prim_sup,brutal_purge,brutal_purge}},
    {purge,[prim_app,prim_sup]},
    {load,{prim_app,brutal_purge,brutal_purge}},
    {load,{prim_sup,brutal_purge,brutal_purge}},
    {apply,{application,start,[prim_app,permanent]}}]}]
}.
</code></pre>

<h3 id="supervisor-change">Supervisor Change</h3>
<p><strong>Step 4b)</strong> Another way to start the included application (or stop it in the case of downgrade) is by combining instructions for adding and removing child processes to/from <em>prim_sup</em> with instructions for loading/unloading all <em>ch_app</em> code and its application specification.</p>
<p>Again, the <em>relup</em> file is created manually. Either from scratch or by editing a generated version. Load all code for <em>ch_app</em> first, and also load the application specification, before <em>prim_sup</em> is updated. When downgrading, <em>prim_sup</em> is to updated first, before the code for <em>ch_app</em> and its application specification are unloaded.</p>
<pre><code>
{&quot;B&quot;,
 [{&quot;A&quot;,
   [],
   [{load_object_code,{ch_app,&quot;1&quot;,[ch_sup,ch3]}},
    {load_object_code,{prim_app,&quot;2&quot;,[prim_sup]}},
    point_of_no_return,
    {load,{ch_sup,brutal_purge,brutal_purge}},
    {load,{ch3,brutal_purge,brutal_purge}},
    {apply,{application,load,[ch_app]}},
    {suspend,[prim_sup]},
    {load,{prim_sup,brutal_purge,brutal_purge}},
    {code_change,up,[{prim_sup,[]}]},
    {resume,[prim_sup]},
    {apply,{supervisor,restart_child,[prim_sup,ch_sup]}}]}],
 [{&quot;A&quot;,
   [],
   [{load_object_code,{prim_app,&quot;1&quot;,[prim_sup]}},
    point_of_no_return,
    {apply,{supervisor,terminate_child,[prim_sup,ch_sup]}},
    {apply,{supervisor,delete_child,[prim_sup,ch_sup]}},
    {suspend,[prim_sup]},
    {load,{prim_sup,brutal_purge,brutal_purge}},
    {code_change,down,[{prim_sup,[]}]},
    {resume,[prim_sup]},
    {remove,{ch_sup,brutal_purge,brutal_purge}},
    {remove,{ch3,brutal_purge,brutal_purge}},
    {purge,[ch_sup,ch3]},
    {apply,{application,unload,[ch_app]}}]}]
}.
</code></pre>

<h3 id="changing-non-erlang-code">Changing Non-Erlang Code</h3>
<p>Changing code for a program written in another programming language than Erlang, for example, a port program, is application-dependent and OTP provides no special support for it.</p>
<p><strong>Example:</strong> When changing code for a port program, assume that the Erlang process controlling the port is a <em>gen_server</em> <em>portc</em> and that the port is opened in the callback function <em>init/1</em> :</p>
<pre><code>
init(...) -&gt;
    ...,
    PortPrg = filename:join(code:priv_dir(App), &quot;portc&quot;),
    Port = open_port({spawn,PortPrg}, [...]),
    ...,
    {ok, #state{port=Port, ...}}.
</code></pre>

<p>If the port program is to be updated, the code for the <em>gen_server</em> can be extended with a <em>code_change</em> function, which closes the old port and opens a new port. (If necessary, the <em>gen_server</em> can first request data that must be saved from the port program and pass this data to the new port):</p>
<pre><code>
code_change(_OldVsn, State, port) -&gt;
    State#state.port ! close,
    receive
        {Port,close} -&gt;
            true
    end,
    PortPrg = filename:join(code:priv_dir(App), &quot;portc&quot;),
    Port = open_port({spawn,PortPrg}, [...]),
    {ok, #state{port=Port, ...}}.
</code></pre>

<p>Update the application version number in the <em>.app</em> file and write an <em>.appup</em> file:</p>
<pre><code>
[&quot;2&quot;,
 [{&quot;1&quot;, [{update, portc, {advanced,port}}]}],
 [{&quot;1&quot;, [{update, portc, {advanced,port}}]}]
].
</code></pre>

<p>Ensure that the <em>priv</em> directory, where the C program is located, is included in the new release package:</p>
<pre><code>
1&gt;  systools:make_tar(&quot;my_release&quot;, [{dirs,[priv]}]). 
...
</code></pre>

<h3 id="emulator-restart-and-upgrade">Emulator Restart and Upgrade</h3>
<p>Two upgrade instructions restart the emulator:</p>
<ul>
<li><em>restart_new_emulator</em></li>
</ul>
<p>Intended when ERTS, Kernel, STDLIB, or SASL is upgraded. It is automatically added when the <em>relup</em> file is generated by <em>systools:make_relup/3,4</em> . It is executed before all other upgrade instructions. For more information about this instruction, see restart_new_emulator (Low-Level) in <a href="./release_handling#restart_new_emulator_instr">Release Handling Instructions</a> .
* 
<em>restart_emulator</em></p>
<p>Used when a restart of the emulator is required after all other upgrade instructions are executed. For more information about this instruction, see restart_emulator (Low-Level) in <a href="./release_handling#restart_emulator_instr">Release Handling Instructions</a> .</p>
<p>If an emulator restart is necessary and no upgrade instructions are needed, that is, if the restart itself is enough for the upgraded applications to start running the new versions, a simple <em>relup</em> file can be created manually:</p>
<pre><code>
{&quot;B&quot;,
 [{&quot;A&quot;,
   [],
   [restart_emulator]}],
 [{&quot;A&quot;,
   [],
   [restart_emulator]}]
}.
</code></pre>

<p>In this case, the release handler framework with automatic packing and unpacking of release packages, automatic path updates, and so on, can be used without having to specify <em>.appup</em> files.</p>
<h3 id="emulator-upgrade-from-pre-otp-r15">Emulator Upgrade From Pre OTP R15</h3>
<p>From OTP R15, an emulator upgrade is performed by restarting the emulator with new versions of the core applications (Kernel, STDLIB, and SASL) before loading code and running upgrade instruction for other applications. For this to work, the release to upgrade from must include OTP R15 or later.</p>
<p>For the case where the release to upgrade from includes an earlier emulator version, <em>systools:make_relup</em> creates a backwards compatible relup file. This means that all upgrade instructions are executed before the emulator is restarted. The new application code is therefore loaded into the old emulator. If the new code is compiled with the new emulator, there can be cases where the beam format has changed and beam files cannot be loaded. To overcome this problem, compile the new code with the old emulator.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../release_handling/" class="btn btn-neutral float-right" title="Release Handling">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../included_applications/" class="btn btn-neutral" title="Included Applications"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../included_applications/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../release_handling/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../../..';</script>
    <script src="../../../js/theme.js" defer></script>
      <script src="../../../search/main.js" defer></script>

</body>
</html>
